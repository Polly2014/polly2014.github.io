<!doctype html><html><head><title>ğŸ¦ ä»åŸç”Ÿè®¤è¯åˆ°å›å½’ CopilotXï¼šä¸€åœºå’Œ Anthropic SDK çš„æ‹‰é”¯æˆ˜</title><meta content="Azure VM åœæœåï¼Œæˆ‘å°è¯•ç”¨ OpenClaw å†…ç½®çš„åŸç”Ÿ GitHub Copilot è®¤è¯æ›¿ä»£ CopilotXã€‚ç™»å½•ä¸€åˆ‡é¡ºåˆ©ï¼Œcurl æµ‹è¯•ä¹Ÿå…¨éƒ¨é€šè¿‡â€”â€”ä½† pi-ai çš„ Anthropic SDK å§‹ç»ˆè¿”å› 400ã€‚ç»è¿‡åŠå¤©çš„ç³»ç»Ÿæ€§æ’æŸ¥ï¼Œæœ€ç»ˆå‘ç°é—®é¢˜è—åœ¨ SDK å†…éƒ¨çš„è¯·æ±‚æ„é€ é‡Œã€‚ç»“å±€ï¼Ÿæœ¬åœ°å¯åŠ¨ CopilotXï¼Œä¸€åˆ‡å¦‚åˆã€‚æœ‰æ—¶å€™ï¼Œæœ€é è°±çš„æ–¹æ¡ˆå°±æ˜¯ä½ è‡ªå·±å†™çš„é‚£ä¸ªã€‚" name=description><meta content="Polly, Blog, AI Blog, AI Assistant, Tutorials, Technology Blog, Baoli Wang" name=keywords><meta content="width=device-width,initial-scale=1" name=viewport><meta content="text/html; charset=utf-8" http-equiv=content-type><meta content=#333 name=theme-color><meta content=article property=og:type><meta content=https://polly.wang/openclaw-github-copilot-native-auth/ property=og:url><meta content="ğŸ¦ ä»åŸç”Ÿè®¤è¯åˆ°å›å½’ CopilotXï¼šä¸€åœºå’Œ Anthropic SDK çš„æ‹‰é”¯æˆ˜" property=og:title><meta content="Azure VM åœæœåï¼Œæˆ‘å°è¯•ç”¨ OpenClaw å†…ç½®çš„åŸç”Ÿ GitHub Copilot è®¤è¯æ›¿ä»£ CopilotXã€‚ç™»å½•ä¸€åˆ‡é¡ºåˆ©ï¼Œcurl æµ‹è¯•ä¹Ÿå…¨éƒ¨é€šè¿‡â€”â€”ä½† pi-ai çš„ Anthropic SDK å§‹ç»ˆè¿”å› 400ã€‚ç»è¿‡åŠå¤©çš„ç³»ç»Ÿæ€§æ’æŸ¥ï¼Œæœ€ç»ˆå‘ç°é—®é¢˜è—åœ¨ SDK å†…éƒ¨çš„è¯·æ±‚æ„é€ é‡Œã€‚ç»“å±€ï¼Ÿæœ¬åœ°å¯åŠ¨ CopilotXï¼Œä¸€åˆ‡å¦‚åˆã€‚æœ‰æ—¶å€™ï¼Œæœ€é è°±çš„æ–¹æ¡ˆå°±æ˜¯ä½ è‡ªå·±å†™çš„é‚£ä¸ªã€‚" property=og:description><meta content=https://polly.wang/images/polly.png property=og:image><meta content="Polly Blog" property=og:site_name><meta content=zh_CN property=og:locale><meta content=summary_large_image name=twitter:card><meta content=https://polly.wang/openclaw-github-copilot-native-auth/ name=twitter:url><meta content="ğŸ¦ ä»åŸç”Ÿè®¤è¯åˆ°å›å½’ CopilotXï¼šä¸€åœºå’Œ Anthropic SDK çš„æ‹‰é”¯æˆ˜" name=twitter:title><meta content="Azure VM åœæœåï¼Œæˆ‘å°è¯•ç”¨ OpenClaw å†…ç½®çš„åŸç”Ÿ GitHub Copilot è®¤è¯æ›¿ä»£ CopilotXã€‚ç™»å½•ä¸€åˆ‡é¡ºåˆ©ï¼Œcurl æµ‹è¯•ä¹Ÿå…¨éƒ¨é€šè¿‡â€”â€”ä½† pi-ai çš„ Anthropic SDK å§‹ç»ˆè¿”å› 400ã€‚ç»è¿‡åŠå¤©çš„ç³»ç»Ÿæ€§æ’æŸ¥ï¼Œæœ€ç»ˆå‘ç°é—®é¢˜è—åœ¨ SDK å†…éƒ¨çš„è¯·æ±‚æ„é€ é‡Œã€‚ç»“å±€ï¼Ÿæœ¬åœ°å¯åŠ¨ CopilotXï¼Œä¸€åˆ‡å¦‚åˆã€‚æœ‰æ—¶å€™ï¼Œæœ€é è°±çš„æ–¹æ¡ˆå°±æ˜¯ä½ è‡ªå·±å†™çš„é‚£ä¸ªã€‚" name=twitter:description><meta content=https://polly.wang/images/polly.png name=twitter:image><meta content=2026-02-26T00:00:00 property=article:published_time><meta content=Polly property=article:author><meta content=OpenClaw property=article:tag><meta content=CopilotX property=article:tag><meta content="GitHub Copilot" property=article:tag><meta content=OAuth property=article:tag><meta content=AIå·¥ç¨‹ property=article:tag><meta content=Debug property=article:tag><meta content="Anthropic SDK" property=article:tag><link rel="shortcut icon" href=https://polly.wang/images/polly.ico type=image/x-icon><link href=https://polly.wang/images/polly.ico rel=icon type=image/x-icon><link href=https://polly.wang/images/polly.ico rel=apple-touch-icon><link href=https://polly.wang/vendor/purecss/pure-min.css rel=stylesheet><link href=https://polly.wang/vendor/purecss/grids-responsive-min.css rel=stylesheet><link href=https://polly.wang/vendor/font-awesome/css/all.min.css rel=stylesheet><link href=https://polly.wang/css/style_new.css rel=stylesheet><script src="https://www.googletagmanager.com/gtag/js?id=G-1N289C8N8W" async></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date());gtag('config','G-1N289C8N8W')</script><body><div class=menu-toggle><img alt=Menu src=https://polly.wang/images/polly.png></div><div class=overlay></div><div class="pure-g container"><div class="sidebar pure-u-1 pure-u-md-1-5"><div class=title><a class=pure-menu-heading href=https://polly.wang> <img class="avatar pure-img-responsive" src=https://polly.wang/images/polly.png> </a><div class=introduction><p>Polly's Blog</div><div class=nav><ul class=nav-links><li><a href=https://polly.wang><i class="fas fa-home"></i>Home</a><li><a href=https://polly.wang/archive><i class="fas fa-archive"></i>Archive</a><li><a href=https://polly.wang/category><i class="fas fa-folder"></i>Category</a><li><a href=https://polly.wang/blog><i class="fas fa-file-alt"></i>Posts</a><li><a href=https://polly.wang/cfp><i class="fas fa-calendar-alt"></i>CFP</a><li><a href=https://polly.wang/publication><i class="fas fa-file-pdf"></i>Research</a><li><a href=https://polly.wang/changelog><i class="fas fa-history"></i>Change Log</a><li><a href=https://polly.wang/about><i class="fas fa-info-circle"></i>About Me</a></ul></div><div class=social><ul class=social-links><li><a onclick="gtag('event','social_click',{platform:'email'});" href=mailto:26716201@qq.com><i class="fas fa-envelope"></i></a><li><a onclick="gtag('event','social_click',{platform:'twitter'});" href=https://twitter.com/Polly__007><i class="fab fa-twitter"></i></a><li><a onclick="gtag('event','social_click',{platform:'linkedin'});" href=https://www.linkedin.com/in/baoliwang><i class="fab fa-linkedin-in"></i></a><li><a onclick="gtag('event','social_click',{platform:'github'});" href=https://github.com/Polly2014><i class="fab fa-github"></i></a></ul></div></div></div><div class="content pure-u-1 pure-u-md-4-5"><div class=blog-post><h1>ğŸ¦ ä»åŸç”Ÿè®¤è¯åˆ°å›å½’ CopilotXï¼šä¸€åœºå’Œ Anthropic SDK çš„æ‹‰é”¯æˆ˜</h1><div class=content><p>ä¸‹åˆæ‰“ç®—è®©å°é¾™è™¾å¸®å¿™å¹²æ´»ï¼Œå‘ç°å®ƒä¸è¯´è¯äº†ã€‚<p>æ£€æŸ¥äº†ä¸€ä¸‹ï¼ŒCopilotX çš„ Azure VM æ²¡å“åº”â€”â€”æˆ‘è¿™ä¸ªæœˆå¾®è½¯å‘˜å·¥ 150 ç¾åˆ€çš„ Azure è®¢é˜…é¢åº¦ç”¨è¶…äº†ï¼Œè™šæœºç›´æ¥åœäº†ã€‚<p>å¥½æ¶ˆæ¯æ˜¯ï¼š<strong>OpenClaw è‡ªå·±å°±èƒ½ç™»å½• GitHub Copilot</strong>ã€‚åæ¶ˆæ¯æ˜¯ï¼šç™»å½•æˆåŠŸä¸ç­‰äºèƒ½ç”¨ã€‚</p><span id=continue-reading></span><h2 id=bei-jing-copilotx-yu-openclaw-de-guan-xi>èƒŒæ™¯ï¼šCopilotX ä¸ OpenClaw çš„å…³ç³»</h2><p>å¦‚æœä½ æ˜¯ç¬¬ä¸€æ¬¡æ¥ï¼Œå…ˆç®€å•ä»‹ç»ä¸€ä¸‹è¿™å‡ ä¸ªè§’è‰²ã€‚ä¸ç†Ÿæ‚‰çš„è¯»è€…å¯ä»¥çœ‹çœ‹å‰ä¸¤ç¯‡ï¼š<a href=/making-openclaw-run-with-copilotx>è®©å°é¾™è™¾è·‘èµ·æ¥</a>å’Œ <a href=/copilotx-v232-error-passthrough>CopilotX v2.3.2</a>ã€‚<ul><li><strong><a href=https://github.com/nicepkg/openclaw>OpenClaw</a>ï¼ˆå°é¾™è™¾ï¼‰</strong>ï¼šå¼€æºä¸ªäºº AI åŠ©æ‰‹ï¼Œèƒ½åŒæ—¶æ¥å…¥ Telegramã€Discordã€WhatsApp ç­‰æ¶ˆæ¯æ¸ é“<li><strong>CopilotX</strong>ï¼šæˆ‘å†™çš„ API ä»£ç†ï¼Œéƒ¨ç½²åœ¨ Azure VMï¼ˆ<code>api.polly.wang</code>ï¼‰ï¼ŒæŠŠ GitHub Copilot è®¢é˜…è½¬æˆæ ‡å‡† Anthropic Messages API<li><strong>å…³ç³»</strong>ï¼šOpenClaw è°ƒç”¨ CopilotX è·å– Claude çš„èƒ½åŠ›</ul><p>è¿™å¥—æ¶æ„è·‘äº†åŠä¸ªå¤šæœˆï¼Œå¾ˆçˆ½â€”â€”ç›´åˆ°ä»Šå¤© Azure VM åœäº†ã€‚<h2 id=copilotx-vs-github-copilot-liang-chong-chi-copilot-de-fang-shi>CopilotX vs github-copilotï¼šä¸¤ç§åƒ Copilot çš„æ–¹å¼</h2><p>è®© OpenClaw ç”¨ä¸Š GitHub Copilot çš„æ¨¡å‹ï¼Œå…¶å®æœ‰ä¸¤æ¡è·¯ï¼š<table><thead><tr><th><th>CopilotXï¼ˆè‡ªå»ºä»£ç†ï¼‰<th>github-copilotï¼ˆåŸç”Ÿè®¤è¯ï¼‰<tbody><tr><td><strong>åŸç†</strong><td>Azure VM ä¸Šè·‘ FastAPIï¼Œè½¬å‘è¯·æ±‚åˆ° Copilot å†…éƒ¨ API<td>OpenClaw å†…ç½® Device Flow OAuthï¼Œç›´æ¥è°ƒ GitHub API<tr><td><strong>éƒ¨ç½²</strong><td>éœ€è¦ä¸€å°æœåŠ¡å™¨ï¼ˆ<code>api.polly.wang</code>ï¼‰<td>ä¸éœ€è¦ï¼Œçº¯æœ¬åœ°<tr><td><strong>è®¤è¯</strong><td>CopilotX è‡ªå·±ç™»å½• GitHubï¼Œå®¢æˆ·ç«¯ç”¨ API Key<td>åœ¨æµè§ˆå™¨é‡Œæˆæƒä¸€æ¬¡ï¼Œtoken è‡ªåŠ¨ç®¡ç†<tr><td><strong>API æ ¼å¼</strong><td>Anthropic Messagesï¼ˆ<code>/v1/messages</code>ï¼‰<td>OpenAI Completionsï¼ˆCopilot åŸç”Ÿæ ¼å¼ï¼‰<tr><td><strong>ä¾èµ–</strong><td>Azure VM å¿…é¡»åœ¨çº¿<td>åªè¦ GitHub ä¸æŒ‚å°±è¡Œ<tr><td><strong>é€‚åˆåœºæ™¯</strong><td>å¤šå®¢æˆ·ç«¯å…±äº«ã€è‡ªå®šä¹‰è·¯ç”±<td>å•æœºä½¿ç”¨ã€å¿«é€Ÿåˆ‡æ¢</table><p>ä¹‹å‰é€‰ CopilotX æ˜¯å› ä¸º OpenClaw åˆå§‹ç‰ˆæœ¬ä¸æ”¯æŒ Copilotï¼Œæˆ‘åªèƒ½é€šè¿‡ä»£ç†æ¡¥æ¥ã€‚ä½†ç°åœ¨ OpenClaw å·²ç»å†…ç½®äº†åŸç”Ÿçš„ <code>github-copilot</code> providerâ€”â€”ä¸éœ€è¦ä¸­é—´äººäº†ã€‚<h2 id=shi-cao-san-bu-wan-cheng-qie-huan>å®æ“ï¼šä¸‰æ­¥å®Œæˆåˆ‡æ¢</h2><h3 id=step-1-geng-xin-openclaw>Step 1ï¼šæ›´æ–° OpenClaw</h3><p>æˆ‘çš„æœ¬åœ°ç‰ˆæœ¬æ˜¯ <code>v2026.2.14</code>ï¼Œä½†é…ç½®æ ¼å¼è¦æ±‚ <code>v2026.2.17</code>ï¼Œç›´æ¥æŠ¥ç‰ˆæœ¬ä¸åŒ¹é…ï¼š<pre style=background:#2b303b;color:#c0c5ce><code><span>Error: Configuration version mismatch. Config: 2026.2.17, Installed: 2026.2.14
</span></code></pre><p>æ›´æ–°ä¸€ä¸‹ï¼š<pre class=language-bash data-lang=bash style=background:#2b303b;color:#c0c5ce><code class=language-bash data-lang=bash><span style=color:#96b5b4>cd</span><span> X-Workspace/openclaw
</span><span style=color:#bf616a>git</span><span> stash && </span><span style=color:#bf616a>git</span><span> pull && </span><span style=color:#bf616a>pnpm</span><span> install && </span><span style=color:#bf616a>pnpm</span><span> build
</span></code></pre><p>è·³åˆ°äº† <code>v2026.2.26</code>ï¼Œé—®é¢˜è§£å†³ã€‚<h3 id=step-2-deng-lu-github-copilot>Step 2ï¼šç™»å½• GitHub Copilot</h3><p>è¿™ä¸€æ­¥æˆ‘è¸©äº†ä¸ªå‘ã€‚ç›´è§‰å‘Šè¯‰æˆ‘åº”è¯¥ç”¨ï¼š<pre class=language-bash data-lang=bash style=background:#2b303b;color:#c0c5ce><code class=language-bash data-lang=bash><span style=color:#65737e># âŒ è¿™æ˜¯é”™çš„
</span><span style=color:#bf616a>openclaw</span><span> models auth login</span><span style=color:#bf616a> --provider</span><span> github-copilot
</span></code></pre><p>æŠ¥é”™ <code>Unknown provider: github-copilot</code>ã€‚è¯•äº†åŠå¤© <code>copilot-proxy</code> æ’ä»¶ä¹Ÿæ˜¯æ¡æ­»è·¯ï¼ˆé‚£æ˜¯æœ¬åœ° VS Code ä»£ç†ï¼Œéœ€è¦ VS Code æ‰©å±•è¿è¡Œåœ¨ <code>localhost:3000</code>ï¼Œå®Œå…¨ä¸æ˜¯æˆ‘è¦çš„ä¸œè¥¿ï¼‰ã€‚<p>æ­£ç¡®çš„å‘½ä»¤æ˜¯ä¸€ä¸ª<strong>ç‹¬ç«‹å­å‘½ä»¤</strong>ï¼Œä¸èµ° <code>--provider</code> å‚æ•°ï¼š<pre class=language-bash data-lang=bash style=background:#2b303b;color:#c0c5ce><code class=language-bash data-lang=bash><span style=color:#65737e># âœ… è¿™æ‰å¯¹
</span><span style=color:#bf616a>pnpm</span><span> openclaw models auth login-github-copilot
</span></code></pre><p>è·‘èµ·æ¥åï¼Œç†Ÿæ‚‰çš„ GitHub Device Flowï¼š<pre style=background:#2b303b;color:#c0c5ce><code><span>ğŸ”‘ GitHub Copilot Authentication
</span><span>Please visit: https://github.com/login/device
</span><span>Enter code: 223C-2FDC
</span><span>Waiting for authorization...
</span></code></pre><p>æµè§ˆå™¨é‡Œè¾“å…¥è®¾å¤‡ç ï¼Œç‚¹æˆæƒï¼Œç»ˆç«¯é‡Œè‡ªåŠ¨å®Œæˆï¼š<pre style=background:#2b303b;color:#c0c5ce><code><span>âœ… GitHub Copilot authentication successful!
</span><span>Auth profile saved: github-copilot:github (github-copilot/token)
</span></code></pre><h3 id=step-3-qie-huan-mo-ren-mo-xing>Step 3ï¼šåˆ‡æ¢é»˜è®¤æ¨¡å‹</h3><p>ç™»å½•æˆåŠŸåï¼ŒOpenClaw çš„é…ç½®ä¸­å·²ç»æœ‰äº† <code>github-copilot</code> è¿™ä¸ª providerã€‚ä½†é»˜è®¤æ¨¡å‹è¿˜æŒ‡å‘ä¸å¯ç”¨çš„ <code>copilotx/claude-opus-4-6</code>ã€‚<p>ç¼–è¾‘ <code>~/.openclaw/openclaw.json</code>ï¼ŒæŠŠé»˜è®¤æ¨¡å‹æ”¹æˆï¼š<pre class=language-json data-lang=json style=background:#2b303b;color:#c0c5ce><code class=language-json data-lang=json><span>{
</span><span>  "</span><span style=color:#a3be8c>agents</span><span>": {
</span><span>    "</span><span style=color:#a3be8c>defaults</span><span>": {
</span><span>      "</span><span style=color:#a3be8c>model</span><span>": {
</span><span>        "</span><span style=color:#a3be8c>primary</span><span>": "</span><span style=color:#a3be8c>github-copilot/claude-opus-4-6</span><span>"
</span><span>      }
</span><span>    }
</span><span>  }
</span><span>}
</span></code></pre><p>çœ‹èµ·æ¥ä¸‡äº‹ä¿±å¤‡ã€‚é‡å¯ gatewayï¼Œå‡†å¤‡è·Ÿå°é¾™è™¾èŠå¤©â€”â€”<h2 id=ji-zhu-yuan-li-wei-shi-yao-yi-tiao-ming-ling-jiu-gou-liao>æŠ€æœ¯åŸç†ï¼šä¸ºä»€ä¹ˆä¸€æ¡å‘½ä»¤å°±å¤Ÿäº†</h2><p>å¥½å¥‡å¿ƒé©±ä½¿æˆ‘ç¿»äº†ä¸€ä¸‹ OpenClaw çš„æºç ï¼Œçœ‹çœ‹ <code>login-github-copilot</code> èƒŒååˆ°åº•åšäº†ä»€ä¹ˆã€‚<h3 id=device-flow-oauth>Device Flow OAuth</h3><p>è¿™æ˜¯ GitHub ä¸ºæ— æµè§ˆå™¨è®¾å¤‡è®¾è®¡çš„ OAuth æµç¨‹ï¼Œæ•´ä¸ªè¿‡ç¨‹ä¸éœ€è¦å›è°ƒ URLï¼š<pre style=background:#2b303b;color:#c0c5ce><code><span>OpenClaw                        GitHub                     æµè§ˆå™¨
</span><span>  â”‚                               â”‚                           â”‚
</span><span>  â”‚â”€â”€â”€ POST /login/device/code â”€â”€â–ºâ”‚                           â”‚
</span><span>  â”‚â—„â”€â”€ device_code + user_code â”€â”€â”€â”‚                           â”‚
</span><span>  â”‚                               â”‚                           â”‚
</span><span>  â”‚  æ˜¾ç¤º "è¯·è®¿é—® github.com/login/device è¾“å…¥ 223C-2FDC"     â”‚
</span><span>  â”‚                               â”‚         ç”¨æˆ·è¾“å…¥è®¾å¤‡ç  â”€â”€â–ºâ”‚
</span><span>  â”‚â”€â”€â”€ POST /login/oauth/access_tokenï¼ˆè½®è¯¢ï¼‰â”€â”€â–ºâ”‚             â”‚
</span><span>  â”‚â—„â”€â”€ authorization_pending â”€â”€â”€â”€â”€â”‚                           â”‚
</span><span>  â”‚â”€â”€â”€ POSTï¼ˆå†æ¬¡è½®è¯¢ï¼‰â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                           â”‚
</span><span>  â”‚â—„â”€â”€ access_token â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                           â”‚
</span></code></pre><p>OpenClaw ç”¨çš„ Client ID æ˜¯ <code>Iv1.b507a08c87ecfe98</code>ï¼Œscope æ˜¯ <code>read:user</code>â€”â€”è¿™å’Œ VS Code é‡Œ GitHub Copilot æ‰©å±•ç”¨çš„ ID éå¸¸æ¥è¿‘ã€‚<h3 id=token-jiao-huan-guan-jian-yi-bu>Token äº¤æ¢ï¼šå…³é”®ä¸€æ­¥</h3><p>æ‹¿åˆ° GitHub access_token åï¼Œè¿˜ä¸èƒ½ç›´æ¥è°ƒ Copilot APIã€‚éœ€è¦ä¸€æ­¥<strong>token äº¤æ¢</strong>ï¼š<pre style=background:#2b303b;color:#c0c5ce><code><span>POST https://api.github.com/copilot_internal/v2/token
</span><span>Authorization: token ghp_xxxxx
</span></code></pre><p>è¿”å›çš„æ˜¯ä¸€ä¸ªçŸ­æœŸ Copilot tokenï¼ˆé€šå¸¸å‡ ååˆ†é’Ÿæœ‰æ•ˆæœŸï¼‰ï¼ŒåŒ…å«åœ¨ä¸€ä¸²åˆ†å·åˆ†éš”çš„å­—ç¬¦ä¸²é‡Œã€‚OpenClaw ä¼šï¼š<ol><li>ç¼“å­˜åˆ° <code>~/.openclaw/credentials/github-copilot.token.json</code><li>ä» token ä¸­æå– <code>proxy-ep</code> å­—æ®µï¼Œè‡ªåŠ¨å‘ç° API ç«¯ç‚¹<li>è¿‡æœŸå‰ 5 åˆ†é’Ÿè‡ªåŠ¨åˆ·æ–°</ol><p>é»˜è®¤çš„ API ç«¯ç‚¹æ˜¯ <code>https://api.individual.githubcopilot.com</code>ï¼Œä½† token é‡Œçš„ <code>proxy-ep</code> å¯èƒ½æŒ‡å‘ä¸åŒçš„åŒºåŸŸä»£ç†ã€‚<p><strong>è¿™å°±æ˜¯ CopilotX åšçš„äº‹æƒ…çš„ç®€åŒ–ç‰ˆ</strong>â€”â€”CopilotX æœ¬è´¨ä¸Šä¹Ÿæ˜¯åšåŒæ ·çš„ token äº¤æ¢ï¼Œåªä¸è¿‡å®ƒéƒ¨ç½²åœ¨æœåŠ¡å™¨ä¸Šï¼Œç»™å¤šä¸ªå®¢æˆ·ç«¯å…±äº«ã€‚è€Œ OpenClaw çš„åŸç”Ÿå®ç°æŠŠè¿™ä¸€åˆ‡æ¬åˆ°äº†æœ¬åœ°ã€‚<h2 id=ju-qing-fan-zhuan-400-model-not-supported>å‰§æƒ…åè½¬ï¼š400 "model not supported"</h2><p>ä»¥ä¸ºä¸‡äº‹å¤§å‰ï¼Œå¯åŠ¨ OpenClaw gatewayâ€”â€”<pre style=background:#2b303b;color:#c0c5ce><code><span>Error: 400 - The requested model is not supported
</span></code></pre><p>Claude æ¨¡å‹å…¨éƒ¨ 400ã€‚ä½† GPT-4o èƒ½ç”¨ã€‚<h3 id=pai-cha-guo-cheng>æ’æŸ¥è¿‡ç¨‹</h3><p>è¿™æ˜¯ä¸€åœºé•¿è¾¾åŠå¤©çš„ç³»ç»Ÿæ€§æ’æŸ¥ã€‚æˆ‘æ€€ç–‘è¿‡æ‰€æœ‰çš„ç¯èŠ‚ï¼Œé€ä¸€æ’é™¤ï¼š<p><strong>1. ç«¯ç‚¹é—®é¢˜ï¼Ÿ</strong><p>Copilot token é‡Œçš„ <code>proxy-ep</code> æŒ‡å‘ <code>proxy.enterprise.githubcopilot.com</code>ï¼Œä¼šè¢« OpenClaw è½¬æˆ <code>api.enterprise.githubcopilot.com</code>ã€‚ä¼ä¸šç«¯ç‚¹å¯èƒ½æ²¡æœ‰ Claudeã€‚<p>äºæ˜¯æˆ‘åœ¨ <code>openclaw.json</code> é‡Œå¼ºåˆ¶è¦†ç›– <code>baseUrl</code>ï¼š<pre class=language-json data-lang=json style=background:#2b303b;color:#c0c5ce><code class=language-json data-lang=json><span>{
</span><span>  "</span><span style=color:#a3be8c>models</span><span>": {
</span><span>    "</span><span style=color:#a3be8c>providers</span><span>": {
</span><span>      "</span><span style=color:#a3be8c>github-copilot</span><span>": {
</span><span>        "</span><span style=color:#a3be8c>baseUrl</span><span>": "</span><span style=color:#a3be8c>https://api.githubcopilot.com</span><span>"
</span><span>      }
</span><span>    }
</span><span>  }
</span><span>}
</span></code></pre><p><strong>2. curl æµ‹è¯•ï¼Ÿ</strong><p>ç”¨åŒä¸€ä¸ª tokenï¼Œç›´æ¥ curl <code>api.githubcopilot.com/v1/messages</code>ï¼š<pre class=language-bash data-lang=bash style=background:#2b303b;color:#c0c5ce><code class=language-bash data-lang=bash><span style=color:#bf616a>curl -X</span><span> POST https://api.githubcopilot.com/v1/messages \
</span><span style=color:#bf616a>  -H </span><span>"</span><span style=color:#a3be8c>Authorization: Bearer </span><span>$</span><span style=color:#bf616a>TOKEN</span><span>" \
</span><span style=color:#bf616a>  -H </span><span>"</span><span style=color:#a3be8c>Content-Type: application/json</span><span>" \
</span><span style=color:#bf616a>  -d </span><span>'</span><span style=color:#a3be8c>{"model":"claude-sonnet-4.5","max_tokens":100,"stream":true,
</span><span style=color:#a3be8c>       "messages":[{"role":"user","content":"Hi"}]}</span><span>'
</span></code></pre><p><strong>200ã€‚</strong> å®Œç¾è¿”å›ã€‚<p>åŠ ä¸Š toolsã€system promptã€thinkingã€cache_controlã€anthropic-beta headerâ€”â€”<strong>å…¨éƒ¨ 200</strong>ã€‚<p><strong>3. pi-ai SDK å†…éƒ¨æµ‹è¯•ï¼Ÿ</strong><p>å†™äº†ä¸ªè„šæœ¬ç›´æ¥æµ‹ pi-ai çš„ <code>ModelRegistry</code>ï¼Œç¡®è®¤ <code>baseUrl</code> å’Œ <code>api</code> å­—æ®µéƒ½æ­£ç¡®è§£æäº†ã€‚æ²¡é—®é¢˜ã€‚<p><strong>4. æœ€ç»ˆå®šä½</strong><p>å†™äº†ä¸ªè„šæœ¬ç›´æ¥è°ƒ pi-ai çš„ <code>streamAnthropic()</code> å‡½æ•°â€”â€”<strong>400ï¼Œmodel not supported</strong>ã€‚<p>åŒæ ·çš„ URLã€åŒæ ·çš„ tokenã€åŒæ ·çš„ payloadï¼Œcurl è¿”å› 200ï¼Œpi-ai çš„ Anthropic SDK è¿”å› 400ã€‚<h3 id=wei-jie-zhi-mi>æœªè§£ä¹‹è°œ</h3><p>é—®é¢˜å‡ºåœ¨ <code>@anthropic-ai/sdk</code> è¿™ä¸ª JavaScript SDK å†…éƒ¨ã€‚å®ƒåœ¨æ„é€  HTTP è¯·æ±‚æ—¶ï¼Œåšäº†ä¸€äº› curl æ²¡åšçš„äº‹æƒ…â€”â€”å¯èƒ½æ˜¯é¢å¤–çš„ headerã€ä¸åŒçš„åºåˆ—åŒ–æ–¹å¼ã€æˆ–è€…æŸç§è¯·æ±‚ç­¾åã€‚è€Œ Copilot çš„åç«¯å¯¹è¿™äº›å·®å¼‚å¾ˆæ•æ„Ÿã€‚<p>æˆ‘èŠ±äº†åŠå¤©æ—¶é—´ï¼Œä½†æ— æ³•ç»§ç»­æ·±å…¥ SDK çš„å†…éƒ¨å®ç°ï¼ˆç¼–è¯‘åçš„ä»£ç ä¸å¥½è°ƒè¯•ï¼‰ã€‚æœ€ç»ˆå†³å®šï¼š<strong>æ”¾å¼ƒåŸç”Ÿæ–¹æ¡ˆï¼Œå›å½’ CopilotX</strong>ã€‚<h2 id=hui-gui-copilotx-ben-di-qi-dong>å›å½’ CopilotXï¼šæœ¬åœ°å¯åŠ¨</h2><p>æ—¢ç„¶ Azure VM æŒ‚äº†ï¼Œé‚£å°±åœ¨æœ¬åœ°è·‘ CopilotXï¼š<pre class=language-bash data-lang=bash style=background:#2b303b;color:#c0c5ce><code class=language-bash data-lang=bash><span style=color:#96b5b4>cd</span><span> X-Workspace/CopilotX
</span><span style=color:#bf616a>pip</span><span> install</span><span style=color:#bf616a> -e</span><span> .
</span><span style=color:#bf616a>copilotx</span><span> auth login    </span><span style=color:#65737e># é‡æ–°ç™»å½•
</span><span style=color:#bf616a>copilotx</span><span> serve         </span><span style=color:#65737e># å¯åŠ¨æœ¬åœ°ä»£ç†
</span></code></pre><p>CopilotX çš„è¾“å‡ºè®©äººå®‰å¿ƒï¼š<pre style=background:#2b303b;color:#c0c5ce><code><span>ğŸš€ CopilotX v2.3.2
</span><span>âœ… Copilot Token valid (29m remaining, auto-refresh)
</span><span>ğŸ”— Anthropic API: http://127.0.0.1:24680/v1/messages
</span><span>ğŸ“‹ Models: claude-opus-4.6, claude-sonnet-4.6, claude-sonnet-4, ...
</span></code></pre><p>ç„¶åæŠŠ <code>openclaw.json</code> é‡Œçš„ <code>baseUrl</code> æ”¹å› CopilotXï¼š<pre class=language-json data-lang=json style=background:#2b303b;color:#c0c5ce><code class=language-json data-lang=json><span>{
</span><span>  "</span><span style=color:#a3be8c>models</span><span>": {
</span><span>    "</span><span style=color:#a3be8c>providers</span><span>": {
</span><span>      "</span><span style=color:#a3be8c>copilotx</span><span>": {
</span><span>        "</span><span style=color:#a3be8c>baseUrl</span><span>": "</span><span style=color:#a3be8c>http://localhost:24680</span><span>",
</span><span>        "</span><span style=color:#a3be8c>api</span><span>": "</span><span style=color:#a3be8c>anthropic-messages</span><span>"
</span><span>      }
</span><span>    }
</span><span>  }
</span><span>}
</span></code></pre><p>é‡å¯ gatewayâ€”â€”<strong>å°é¾™è™¾ç«‹åˆ»æ´»è¹¦ä¹±è·³</strong>ã€‚<p>ä¸ºäº†ä»¥åæ–¹ä¾¿åˆ‡æ¢æœ¬åœ°/è¿œç¨‹ï¼Œæˆ‘è¿˜å†™äº†ä¸ªå°è„šæœ¬ï¼š<pre class=language-bash data-lang=bash style=background:#2b303b;color:#c0c5ce><code class=language-bash data-lang=bash><span style=color:#bf616a>python</span><span> scripts/switch_copilotx.py          </span><span style=color:#65737e># ä¸€é”® toggle
</span><span style=color:#bf616a>python</span><span> scripts/switch_copilotx.py local    </span><span style=color:#65737e># åˆ‡æœ¬åœ°
</span><span style=color:#bf616a>python</span><span> scripts/switch_copilotx.py remote   </span><span style=color:#65737e># åˆ‡è¿œç¨‹ (api.polly.wang)
</span><span style=color:#bf616a>python</span><span> scripts/switch_copilotx.py status   </span><span style=color:#65737e># çœ‹å½“å‰
</span></code></pre><h3 id=cha-qu-qie-liao-pei-zhi-dan-xiao-long-xia-huan-shi-lian-bu-shang>æ’æ›²ï¼šåˆ‡äº†é…ç½®ä½†å°é¾™è™¾è¿˜æ˜¯è¿ä¸ä¸Š</h3><p>Azure VM æ¢å¤åï¼Œæˆ‘ç”¨è„šæœ¬åˆ‡åˆ°è¿œç¨‹â€”â€”ç»“æœå°é¾™è™¾è¿˜æ˜¯æŠ¥ <code>Connection error</code>ã€‚<p>æŸ¥äº†åŠå¤©æ‰å‘ç°ï¼šOpenClaw åœ¨ agent ç›®å½•ä¸‹æœ‰ä¸€ä¸ª<strong>æ¨¡å‹ç¼“å­˜æ–‡ä»¶</strong> <code>~/.openclaw/agents/main/agent/models.json</code>ï¼Œé‡Œé¢ç¡¬ç¼–ç äº† <code>baseUrl</code>ã€‚æˆ‘çš„è„šæœ¬åªæ”¹äº† <code>openclaw.json</code>ï¼Œä½† gateway è¿è¡Œæ—¶è¯»çš„æ˜¯ç¼“å­˜â€”â€”è¿˜åœ¨è¿ <code>localhost:24680</code>ã€‚<pre class=language-bash data-lang=bash style=background:#2b303b;color:#c0c5ce><code class=language-bash data-lang=bash><span style=color:#65737e># ç½ªé­ç¥¸é¦–ï¼šç¼“å­˜äº†æ—§çš„ baseUrl
</span><span style=color:#bf616a>cat ~</span><span>/.openclaw/agents/main/agent/models.json | </span><span style=color:#bf616a>grep</span><span> baseUrl
</span><span style=color:#65737e># â†’ "baseUrl": "http://localhost:24680"  â† æ—©å°±è¯¥æ˜¯è¿œç¨‹äº†ï¼
</span></code></pre><p>ä¿®å¤å¾ˆç®€å•ï¼š<strong>åˆ‡æ¢æ—¶é¡ºæ‰‹åˆ æ‰ç¼“å­˜</strong>ã€‚æˆ‘æ›´æ–°äº† switch è„šæœ¬ï¼Œæ¯æ¬¡åˆ‡æ¢è‡ªåŠ¨æ¸…ç†è¿™ä¸ªæ–‡ä»¶ã€‚<p>æ•™è®­ï¼šé…ç½®ç³»ç»Ÿæœ‰ç¼“å­˜å±‚æ—¶ï¼Œæ”¹äº†æºå¤´ä¸ç­‰äºæ”¹äº†è¿è¡Œæ—¶ã€‚<h2 id=wei-shi-yao-copilotx-neng-xing-er-yuan-sheng-bu-xing>ä¸ºä»€ä¹ˆ CopilotX èƒ½è¡Œè€ŒåŸç”Ÿä¸è¡Œï¼Ÿ</h2><p>è¿™æ˜¯ä¸ªæœ‰è¶£çš„å¯¹æ¯”ï¼š<table><thead><tr><th><th>CopilotX<th>OpenClaw åŸç”Ÿ github-copilot<tbody><tr><td><strong>è¯·æ±‚æ ¼å¼</strong><td>OpenAI Chat Completionsï¼ˆ<code>/chat/completions</code>ï¼‰<td>Anthropic Messagesï¼ˆ<code>/v1/messages</code>ï¼‰via pi-ai SDK<tr><td><strong>HTTP åº“</strong><td>Python <code>httpx</code>ï¼ˆç›´æ¥æ„é€ è¯·æ±‚ï¼‰<td>JS <code>@anthropic-ai/sdk</code>ï¼ˆSDK æŠ½è±¡å±‚ï¼‰<tr><td><strong>ç»“æœ</strong><td>âœ… 200<td>âŒ 400</table><p>CopilotX ç”¨çš„æ˜¯ OpenAI æ ¼å¼ + Python httpxï¼Œè¯·æ±‚å®Œå…¨å¯æ§ï¼›è€Œ OpenClaw çš„åŸç”Ÿ provider èµ° pi-ai çš„ Anthropic SDKï¼ŒSDK å†…éƒ¨çš„è¯·æ±‚æ„é€ å¯¹ Copilot åç«¯æ¥è¯´æœ‰äº›"ä¸å¯¹åŠ²"ã€‚<p><strong>æœ¬è´¨åŒºåˆ«</strong>ï¼šCopilotX è¯´çš„æ˜¯ Copilot å¬å¾—æ‡‚çš„"æ–¹è¨€"ï¼ˆOpenAI Chat Completionsï¼‰ï¼Œè€Œ Anthropic SDK è¯´çš„æ˜¯ Copilot ä¸å®Œå…¨å…¼å®¹çš„"æ–¹è¨€"ï¼ˆAnthropic Messages + SDK å†…éƒ¨çš„é¢å¤– header å’Œæ ¼å¼ï¼‰ã€‚<h2 id=jing-yan-zong-jie>ç»éªŒæ€»ç»“</h2><ol><li><p><strong>è‡ªå·±å†™çš„ä»£ç æœ€å¯æ§</strong>ã€‚CopilotX ä¸è¿‡å‡ ç™¾è¡Œ Pythonï¼Œä½†å› ä¸ºæ¯ä¸€è¡Œæˆ‘éƒ½æ¸…æ¥šåœ¨åšä»€ä¹ˆï¼Œdebug å’Œä¿®æ”¹éƒ½æ˜¯åˆ†é’Ÿçº§ã€‚è€Œè¸©è¿›ç¬¬ä¸‰æ–¹ SDK çš„é»‘ç›’é‡Œï¼ŒåŠå¤©ä¹Ÿå‡ºä¸æ¥ã€‚</p><li><p><strong>curl é€šè¿‡ â‰  SDK é€šè¿‡</strong>ã€‚è¿™æ˜¯æˆ‘è¿™æ¬¡æœ€å¤§çš„æ•™è®­ã€‚curl æˆåŠŸåªèƒ½è¯æ˜ API ç«¯ç‚¹å’Œè®¤è¯æ²¡é—®é¢˜ï¼Œä½† SDK å°è£…å¯èƒ½å¼•å…¥ä½ çœ‹ä¸åˆ°çš„å·®å¼‚ã€‚</p><li><p><strong>å…ˆç»™è‡ªå·±ç•™åè·¯</strong>ã€‚CopilotX çš„æœ¬åœ°æ¨¡å¼æ˜¯ä¸ªæ„å¤–æƒŠå–œâ€”â€”ä¸éœ€è¦ Azure VMï¼Œæœ¬åœ° <code>copilotx serve</code> å°±èƒ½è·‘ã€‚è¿™è®©"Plan B"çš„åˆ‡æ¢æˆæœ¬å‡ ä¹ä¸ºé›¶ã€‚</p><li><p><strong>è°ƒè¯•åˆ°æé™ä¹Ÿè¦çŸ¥é“ä½•æ—¶æ”¶æ‰‹</strong>ã€‚åŠå¤©çš„æ’æŸ¥è®©æˆ‘ç²¾ç¡®å®šä½åˆ°äº†é—®é¢˜ï¼ˆAnthropic SDK å†…éƒ¨çš„è¯·æ±‚æ„é€ ï¼‰ï¼Œä½†ç»§ç»­æ·±å…¥çš„è¾¹é™…å›æŠ¥å¾ˆä½ã€‚æœ‰æ—¶å€™ç»•è¿‡é—®é¢˜æ¯”è§£å†³é—®é¢˜æ›´åŠ¡å®ã€‚</p><li><p><strong>æ”¹äº†é…ç½®ä¸ç­‰äºæ”¹äº†è¿è¡Œæ—¶</strong>ã€‚OpenClaw æœ‰ agent-level çš„ <code>models.json</code> ç¼“å­˜ï¼Œæ”¹äº† <code>openclaw.json</code> ä¸ä¼šè‡ªåŠ¨åŒæ­¥ã€‚ä»»ä½•æœ‰ç¼“å­˜å±‚çš„ç³»ç»Ÿï¼Œéƒ½è¦æƒ³æ¸…æ¥š"æˆ‘çš„æ”¹åŠ¨åˆ°åº•åœ¨å“ªä¸€å±‚ç”Ÿæ•ˆ"ã€‚</p></ol><h2 id=ban-ben-xian>ç‰ˆæœ¬çº¿</h2><table><thead><tr><th>æ—¥æœŸ<th>äº‹ä»¶<th>åšæ–‡<tbody><tr><td>2026-02-11<td>OpenClaw + CopilotX é¦–æ¬¡è”é€š<td><a href=/making-openclaw-run-with-copilotx>è®©å°é¾™è™¾è·‘èµ·æ¥</a><tr><td>2026-02-18<td>CopilotX v2.3.2 é”™è¯¯é€ä¼ ä¿®å¤<td><a href=/copilotx-v232-error-passthrough>å½“ 400 å˜æˆäº†ã€Œä½ çŒœæ€ä¹ˆäº†ã€</a><tr><td>2026-02-26<td>Azure VM åœæœ â†’ å°è¯•åŸç”Ÿè®¤è¯ â†’ å‘ç° Anthropic SDK å…¼å®¹é—®é¢˜ â†’ å›å½’æœ¬åœ° CopilotX<td>æœ¬æ–‡</table></div><div class=navigation></div></div><div id=giscus-container><h2>Comments</h2><div class=giscus></div></div><script data-category="Blog Comments" async crossorigin data-category-id=DIC_kwDOL45duM4CnjlZ data-emit-metadata=0 data-input-position=bottom data-lang=en data-mapping=pathname data-reactions-enabled=1 data-repo=Polly2014/polly2014.github.io data-repo-id=R_kgDOL45duA data-strict=0 data-theme=noborder_light src=https://giscus.app/client.js></script><script type=module>
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        
        mermaid.initialize({
            startOnLoad: false,
            theme: 'base',
            themeVariables: {
                // ç°ç™½é»‘è‰²è°ƒ + è“è‰²ç‚¹ç¼€
                primaryColor: '#e8e8e8',
                primaryTextColor: '#333',
                primaryBorderColor: '#999',
                lineColor: 'rgb(61, 146, 201)',
                secondaryColor: '#f5f5f5',
                tertiaryColor: '#fafafa',
                background: '#f2f2f2',
                mainBkg: '#f5f5f5',
                nodeBorder: '#999',
                clusterBkg: '#eee',
                clusterBorder: '#ccc',
                titleColor: '#333',
                edgeLabelBackground: '#f2f2f2',
                // æ–‡æœ¬é¢œè‰²
                textColor: '#333',
                nodeTextColor: '#333',
                // å…¶ä»–
                fontFamily: "'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace"
            },
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true,
                curve: 'basis'
            }
        });

        // æŸ¥æ‰¾æ‰€æœ‰ mermaid ä»£ç å—å¹¶æ¸²æŸ“
        document.querySelectorAll('pre code.language-mermaid').forEach((block, index) => {
            const container = document.createElement('div');
            container.className = 'mermaid';
            container.textContent = block.textContent;
            block.parentNode.replaceWith(container);
        });

        // æ¸²æŸ“æ‰€æœ‰ mermaid å›¾è¡¨
        await mermaid.run();
    </script><script>(function(){if(typeof gtag!=='function')return;var a=document.querySelector('.blog-post .content');if(a&&'IntersectionObserver' in window){var b=false;var c=new IntersectionObserver(function(h){if(h[0].isIntersecting&&!b){b=true;gtag('event','blog_read_complete',{article_title:document.title,article_path:location.pathname});c.disconnect()}},{threshold:0.1});var d=a.lastElementChild||a;c.observe(d)};var e=document.getElementById('giscus-container');if(e&&'IntersectionObserver' in window){var f=false;var g=new IntersectionObserver(function(h){if(h[0].isIntersecting&&!f){f=true;gtag('event','comment_view',{article_title:document.title,article_path:location.pathname});g.disconnect()}},{threshold:0.1});g.observe(e)}})()</script><style>.cover-image{text-align:center;margin:1.5em 0 2em 0}.cover-image img{width:60%;height:auto;border-radius:8px;box-shadow:0 4px 12px rgba(0,0,0,0.15)}.mermaid{background:#fafafa;border:1px solid #ddd;padding:20px;margin:20px 0;overflow-x:auto}.mermaid svg{max-width:100%;height:auto}@media (max-width:768px){.cover-image img{width:100%}}</style></div></div><script>document.addEventListener('DOMContentLoaded',function(){const c=document.querySelector('.menu-toggle');const d=document.querySelector('.sidebar');const e=document.querySelector('.overlay');function a(){d.classList.toggle('active');e.classList.toggle('active')}c.addEventListener('click',a);e.addEventListener('click',a);let f=0;let g=0;document.addEventListener('touchstart',h=>{f=h.changedTouches[0].screenX},false);document.addEventListener('touchend',h=>{g=h.changedTouches[0].screenX;b()},false);function b(){const h=g- f;if(h>50&&f<30){d.classList.add('active');e.classList.add('active')}else if(h<-50&&d.classList.contains('active')){d.classList.remove('active');e.classList.remove('active')}}})</script>