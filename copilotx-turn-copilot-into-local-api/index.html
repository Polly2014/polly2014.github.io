<!doctype html><html><head><title>ğŸš€ CopilotXï¼šä¸€ä¸ªæ™šä¸Šï¼ŒæŠŠ GitHub Copilot å˜æˆæœ¬åœ° API æœåŠ¡å™¨</title><meta content="æ·±å…¥åˆ†æäº† 3 ä¸ªå¼€æºé¡¹ç›®åï¼Œæˆ‘ç”¨ä¸€ä¸ªæ™šä¸Šä»é›¶å†™å‡ºäº† CopilotXâ€”â€”ä¸€ä¸ªå°† GitHub Copilot è®¢é˜…å˜æˆæœ¬åœ° OpenAI/Anthropic å…¼å®¹ API çš„ Python å·¥å…·ã€‚pip install copilotxï¼Œä¸‰è¡Œå‘½ä»¤å³å¯è®© Claude Codeã€Codex ç­‰ä»»æ„å·¥å…·è°ƒç”¨ Copilot èƒŒåçš„ 22 ä¸ªæ¨¡å‹ã€‚" name=description><meta content="Polly, Blog, AI Blog, AI Assistant, Tutorials, Technology Blog, Baoli Wang" name=keywords><meta content="width=device-width,initial-scale=1" name=viewport><meta content="text/html; charset=utf-8" http-equiv=content-type><meta content=#333 name=theme-color><meta content=article property=og:type><meta content=https://polly.wang/copilotx-turn-copilot-into-local-api/ property=og:url><meta content="ğŸš€ CopilotXï¼šä¸€ä¸ªæ™šä¸Šï¼ŒæŠŠ GitHub Copilot å˜æˆæœ¬åœ° API æœåŠ¡å™¨" property=og:title><meta content="æ·±å…¥åˆ†æäº† 3 ä¸ªå¼€æºé¡¹ç›®åï¼Œæˆ‘ç”¨ä¸€ä¸ªæ™šä¸Šä»é›¶å†™å‡ºäº† CopilotXâ€”â€”ä¸€ä¸ªå°† GitHub Copilot è®¢é˜…å˜æˆæœ¬åœ° OpenAI/Anthropic å…¼å®¹ API çš„ Python å·¥å…·ã€‚pip install copilotxï¼Œä¸‰è¡Œå‘½ä»¤å³å¯è®© Claude Codeã€Codex ç­‰ä»»æ„å·¥å…·è°ƒç”¨ Copilot èƒŒåçš„ 22 ä¸ªæ¨¡å‹ã€‚" property=og:description><meta content=https://polly.wang/copilotx-turn-copilot-into-local-api/cover.jpg property=og:image><meta content="Polly Blog" property=og:site_name><meta content=zh_CN property=og:locale><meta content=summary_large_image name=twitter:card><meta content=https://polly.wang/copilotx-turn-copilot-into-local-api/ name=twitter:url><meta content="ğŸš€ CopilotXï¼šä¸€ä¸ªæ™šä¸Šï¼ŒæŠŠ GitHub Copilot å˜æˆæœ¬åœ° API æœåŠ¡å™¨" name=twitter:title><meta content="æ·±å…¥åˆ†æäº† 3 ä¸ªå¼€æºé¡¹ç›®åï¼Œæˆ‘ç”¨ä¸€ä¸ªæ™šä¸Šä»é›¶å†™å‡ºäº† CopilotXâ€”â€”ä¸€ä¸ªå°† GitHub Copilot è®¢é˜…å˜æˆæœ¬åœ° OpenAI/Anthropic å…¼å®¹ API çš„ Python å·¥å…·ã€‚pip install copilotxï¼Œä¸‰è¡Œå‘½ä»¤å³å¯è®© Claude Codeã€Codex ç­‰ä»»æ„å·¥å…·è°ƒç”¨ Copilot èƒŒåçš„ 22 ä¸ªæ¨¡å‹ã€‚" name=twitter:description><meta content=https://polly.wang/copilotx-turn-copilot-into-local-api/cover.jpg name=twitter:image><meta content=2026-02-09T00:00:00 property=article:published_time><meta content=Polly property=article:author><meta content=CopilotX property=article:tag><meta content="GitHub Copilot" property=article:tag><meta content=Python property=article:tag><meta content=FastAPI property=article:tag><meta content=OpenAI property=article:tag><meta content=Claude property=article:tag><meta content=AIå·¥å…· property=article:tag><meta content=å¼€æº property=article:tag><link rel="shortcut icon" href=https://polly.wang/images/polly.ico type=image/x-icon><link href=https://polly.wang/images/polly.ico rel=icon type=image/x-icon><link href=https://polly.wang/images/polly.ico rel=apple-touch-icon><link href=https://polly.wang/vendor/purecss/pure-min.css rel=stylesheet><link href=https://polly.wang/vendor/purecss/grids-responsive-min.css rel=stylesheet><link href=https://polly.wang/vendor/font-awesome/css/all.min.css rel=stylesheet><link href=https://polly.wang/css/style_new.css rel=stylesheet><script src="https://www.googletagmanager.com/gtag/js?id=G-8JD13N7PHS" async></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date());gtag('config','G-8JD13N7PHS')</script><body><div class=menu-toggle><img alt=Menu src=https://polly.wang/images/polly.png></div><div class=overlay></div><div class="pure-g container"><div class="sidebar pure-u-1 pure-u-md-1-5"><div class=title><a class=pure-menu-heading href=https://polly.wang> <img class="avatar pure-img-responsive" src=https://polly.wang/images/polly.png> </a><div class=introduction><p>Polly's Blog</div><div class=nav><ul class=nav-links><li><a href=https://polly.wang><i class="fas fa-home"></i>Home</a><li><a href=https://polly.wang/archive><i class="fas fa-archive"></i>Archive</a><li><a href=https://polly.wang/category><i class="fas fa-folder"></i>Category</a><li><a href=https://polly.wang/blog><i class="fas fa-file-alt"></i>Posts</a><li><a href=https://polly.wang/cfp><i class="fas fa-calendar-alt"></i>CFP</a><li><a href=https://polly.wang/publication><i class="fas fa-file-pdf"></i>Research</a><li><a href=https://polly.wang/changelog><i class="fas fa-history"></i>Change Log</a><li><a href=https://polly.wang/about><i class="fas fa-info-circle"></i>About Me</a></ul></div><div class=social><ul class=social-links><li><a href=mailto:26716201@qq.com><i class="fas fa-envelope"></i></a><li><a href=https://twitter.com/Polly__007><i class="fab fa-twitter"></i></a><li><a href=https://www.linkedin.com/in/baoliwang><i class="fab fa-linkedin-in"></i></a><li><a href=https://github.com/Polly2014><i class="fab fa-github"></i></a></ul></div></div></div><div class="content pure-u-1 pure-u-md-4-5"><div class=blog-post><h1>ğŸš€ CopilotXï¼šä¸€ä¸ªæ™šä¸Šï¼ŒæŠŠ GitHub Copilot å˜æˆæœ¬åœ° API æœåŠ¡å™¨</h1><div class=cover-image><img alt="ğŸš€ CopilotXï¼šä¸€ä¸ªæ™šä¸Šï¼ŒæŠŠ GitHub Copilot å˜æˆæœ¬åœ° API æœåŠ¡å™¨" loading=lazy src=cover.jpg></div><div class=content><p>å‡Œæ™¨ä¸€ç‚¹ï¼Œå½“ç»ˆç«¯é‡Œçš„å¹¶å‘æµ‹è¯•è¾“å‡º <strong>16/16 requests passed</strong> æ—¶ï¼Œæˆ‘çŸ¥é“è¿™ä¸ªä¸œè¥¿å¯ä»¥å‘å¸ƒäº†ã€‚<p>ä»ä¸‹åˆå¼€å§‹ç ”ç©¶ä¸‰ä¸ªå¼€æºé¡¹ç›®ï¼Œåˆ°æ·±å¤œåœ¨ PyPI ä¸Šå‘å¸ƒ <a href=https://pypi.org/project/copilotx/>CopilotX</a>ï¼Œæ•´ä¸ªè¿‡ç¨‹ä¸åˆ°ä¸€å¤©ã€‚è¿™ç¯‡æ–‡ç« è®°å½•è¿™ä¸ªé¡¹ç›®ä»çµæ„Ÿåˆ°ä¸Šçº¿çš„å®Œæ•´æ—…ç¨‹ã€‚<hr><h2 id=qi-yin-san-ge-xiang-mu-de-qi-fa>èµ·å› ï¼šä¸‰ä¸ªé¡¹ç›®çš„å¯å‘</h2><p>äº‹æƒ…çš„èµ·ç‚¹æ˜¯ä¸€ä¸ªç®€å•çš„å¥½å¥‡å¿ƒâ€”â€”<strong>GitHub Copilot è®¢é˜…èƒ½ä¸èƒ½å½“æœ¬åœ° API ç”¨ï¼Ÿ</strong><p>æˆ‘åœ¨ GitHub ä¸Šå‘ç°äº†ä¸‰ä¸ªè¯•å›¾è§£å†³è¿™ä¸ªé—®é¢˜çš„é¡¹ç›®ï¼š<table><thead><tr><th>é¡¹ç›®<th>è¯­è¨€<th>æ ¸å¿ƒæ€è·¯<tbody><tr><td><strong>Router-Maestro</strong><td>Python<td>ç‹¬ç«‹ CLI å·¥å…·ï¼ŒOAuth ç™»å½•åèµ· FastAPI ä»£ç†<tr><td><strong>Agent-Maestro</strong><td>Python<td>å®Œæ•´ Agent æ¡†æ¶ï¼Œå†…ç½® MCP Server<tr><td><strong>GateX</strong>ï¼ˆæˆ‘ä¹‹å‰å†™çš„ï¼‰<td>TypeScript<td>VS Code æ‰©å±•ï¼Œå€Ÿ <code>vscode.lm</code> API é€ä¼ </table><p>èŠ±äº†ä¸€ä¸ªä¸‹åˆä»”ç»†ç ”ç©¶å®ƒä»¬çš„ä»£ç ï¼Œæˆ‘å¾—å‡ºå‡ ä¸ªå…³é”®å‘ç°ï¼š<p><strong>Router-Maestro</strong> çš„è®¾è®¡æœ€ä¼˜é›…â€”â€”å®ƒå‘ç°äº† GitHub Copilot çš„ä¸€ä¸ªé‡è¦äº‹å®ï¼š<strong>Copilot åç«¯ï¼ˆapi.githubcopilot.comï¼‰åŸç”Ÿå°±æ˜¯ OpenAI æ ¼å¼</strong>ã€‚è¿™æ„å‘³ç€ OpenAI SDK çš„è¯·æ±‚åªéœ€è¦æ¢ä¸ª Token å°±èƒ½ç›´æ¥è½¬å‘ï¼Œæ ¹æœ¬ä¸éœ€è¦å¤æ‚çš„æ ¼å¼è½¬æ¢ã€‚è€Œä¸”å®ƒç”¨ OAuth Device Flow åšè®¤è¯ï¼Œå®Œå…¨ä¸ä¾èµ– VS Codeã€‚<p><strong>Agent-Maestro</strong> èµ°äº†å¦ä¸€æ¡è·¯ï¼Œæƒ³åšæˆ"ä¸€ç«™å¼ Agent å¹³å°"ã€‚åŠŸèƒ½ä¸°å¯Œä½†è¿‡äºåºå¤§ï¼Œå…‰ MCP Server å°±å¸¦äº†åå‡ ä¸ªå·¥å…·ï¼Œå¯¹äº"æˆ‘åªæƒ³æœ‰ä¸ªæœ¬åœ° API"çš„éœ€æ±‚æ¥è¯´å¤ªé‡äº†ã€‚<p><strong>GateX</strong> æ˜¯æˆ‘ä¹‹å‰å†™çš„ VS Code æ‰©å±•ï¼Œé€šè¿‡ <code>vscode.lm</code> API è°ƒç”¨æ¨¡å‹å†è½¬æˆ HTTPã€‚ä¼˜ç‚¹æ˜¯é›¶é…ç½®ï¼ˆVS Code å·²ç»å¤„ç†äº†è®¤è¯ï¼‰ï¼Œç¼ºç‚¹æ˜¯<strong>å¿…é¡»åœ¨ VS Code é‡Œè¿è¡Œ</strong>ï¼Œæ²¡æ³•åœ¨çº¯ç»ˆç«¯ç¯å¢ƒç”¨ã€‚<p>ä¸‰ä¸ªé¡¹ç›®å„æœ‰ä¼˜ç¼ºï¼Œä½†æ²¡æœ‰ä¸€ä¸ªå®Œç¾å‡»ä¸­æˆ‘çš„éœ€æ±‚ï¼š<strong>è½»é‡ã€ç‹¬ç«‹ã€åŒæ ¼å¼ï¼ˆOpenAI + Anthropicï¼‰ã€å¼€ç®±å³ç”¨</strong>ã€‚<p>é‚£å°±è‡ªå·±å†™ä¸€ä¸ªã€‚<hr><h2 id=she-ji-jue-ce-less-is-more>è®¾è®¡å†³ç­–ï¼šLess is More</h2><p>åœ¨åŠ¨æ‰‹ä¹‹å‰ï¼Œæˆ‘èŠ±äº†ä¸€äº›æ—¶é—´åšè®¾è®¡å†³ç­–ã€‚è¿™äº›é€‰æ‹©åæ¥è¯æ˜æ¯ä¸€ä¸ªéƒ½æ˜¯å¯¹çš„ï¼š<h3 id=wei-shi-yao-shi-python-du-li-gong-ju>ä¸ºä»€ä¹ˆæ˜¯ Python ç‹¬ç«‹å·¥å…·ï¼Ÿ</h3><pre style=background:#2b303b;color:#c0c5ce><code><span>âŒ VS Code æ‰©å±• â†’ ä¾èµ–ç¼–è¾‘å™¨ï¼Œä¸å¤Ÿç‹¬ç«‹
</span><span>âŒ Node.js CLI  â†’ AI/ML ç”Ÿæ€å¤§å¤šåœ¨ Python
</span><span>âœ… Python CLI   â†’ pip install ä¸€è¡Œæå®šï¼Œç”Ÿæ€äº²å’Œ
</span></code></pre><h3 id=wei-shi-yao-tong-shi-zhi-chi-openai-he-anthropic-ge-shi>ä¸ºä»€ä¹ˆåŒæ—¶æ”¯æŒ OpenAI å’Œ Anthropic æ ¼å¼ï¼Ÿ</h3><p>å› ä¸ºæˆ‘çš„ä¸»è¦ä½¿ç”¨åœºæ™¯å°±æ˜¯ä¸¤ä¸ªï¼š<ul><li><strong>Claude Code</strong> â†’ è¯´ Anthropic åè®®ï¼ˆ<code>/v1/messages</code>ï¼‰<li><strong>Codex / å…¶ä»–å·¥å…·</strong> â†’ è¯´ OpenAI åè®®ï¼ˆ<code>/v1/chat/completions</code>ï¼‰</ul><p>Copilot åç«¯åŸç”Ÿæ˜¯ OpenAI æ ¼å¼ï¼Œæ‰€ä»¥ OpenAI è¯·æ±‚ç›´æ¥é€ä¼ ï¼›Anthropic è¯·æ±‚éœ€è¦å®æ—¶ç¿»è¯‘ã€‚<strong>ä¸€ä¸ªä»£ç†åŒæ—¶è¦†ç›–ä¸¤å¤§ç”Ÿæ€ï¼Œè¿™æ˜¯ CopilotX çš„æ ¸å¿ƒå·®å¼‚åŒ–</strong>ã€‚<h3 id=wei-shi-yao-yong-oauth-device-flow>ä¸ºä»€ä¹ˆç”¨ OAuth Device Flowï¼Ÿ</h3><p>GitHub çš„ Device Flow è®¤è¯éå¸¸ä¼˜é›…ï¼š<pre style=background:#2b303b;color:#c0c5ce><code><span>1. ç»ˆç«¯æ˜¾ç¤ºä¸€ä¸ª 8 ä½ç   â†’  AB12-CD34
</span><span>2. æµè§ˆå™¨æ‰“å¼€ github.com/login/device
</span><span>3. è¾“å…¥ç ï¼Œæˆæƒå®Œæˆ
</span><span>4. ç»ˆç«¯è‡ªåŠ¨è·å– Token
</span></code></pre><p>ä¸éœ€è¦åœ¨ç»ˆç«¯é‡Œç²˜è´´å¯†ç ï¼Œä¸éœ€è¦æ‰‹åŠ¨åˆ›å»º Personal Access Tokenã€‚è€Œä¸”æˆ‘ç”¨çš„ client_id è·Ÿ VS Code Copilot Chat æ‰©å±•å®Œå…¨ä¸€æ ·ï¼ˆ<code>Iv1.b507a08c87ecfe98</code>ï¼‰ï¼Œè¿™æ ·è·å¾—çš„ Token æƒé™ä¹Ÿå®Œå…¨ä¸€è‡´ã€‚<hr><h2 id=he-xin-jia-gou-liang-ceng-token-ge-shi-fan-yi>æ ¸å¿ƒæ¶æ„ï¼šä¸¤å±‚ Token + æ ¼å¼ç¿»è¯‘</h2><p>æ•´ä¸ªç³»ç»Ÿçš„æ¶æ„å¯ä»¥ç”»æˆè¿™æ ·ï¼š<pre style=background:#2b303b;color:#c0c5ce><code><span>ä½ çš„å·¥å…· (Claude Code / Codex / Python è„šæœ¬)
</span><span>    â”‚
</span><span>    â”‚  OpenAI æˆ– Anthropic æ ¼å¼
</span><span>    â–¼
</span><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span><span>â”‚  CopilotX (localhost:24680)            â”‚
</span><span>â”‚                                        â”‚
</span><span>â”‚  OpenAI è¯·æ±‚  â†’ ç›´æ¥è½¬å‘ï¼ˆåŠ  Tokenï¼‰    â”‚
</span><span>â”‚  Anthropic è¯·æ±‚ â†’ ç¿»è¯‘æˆ OpenAI â†’ è½¬å‘  â”‚
</span><span>â”‚                                        â”‚
</span><span>â”‚  Token ç®¡ç†ï¼šGitHub OAuth â†’ Copilot JWT â”‚
</span><span>â”‚  ï¼ˆJWT ~30åˆ†é’Ÿï¼Œåˆ°æœŸå‰60ç§’è‡ªåŠ¨åˆ·æ–°ï¼‰    â”‚
</span><span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</span><span>                   â”‚  OpenAI æ ¼å¼ + Copilot JWT
</span><span>                   â–¼
</span><span>    api.githubcopilot.com/chat/completions
</span><span>    â†’ GPT-4o, Claude, Gemini, o3-mini ...
</span></code></pre><h3 id=liang-ceng-token-ji-zhi>ä¸¤å±‚ Token æœºåˆ¶</h3><p>è¿™æ˜¯æˆ‘ä» Router-Maestro å­¦åˆ°çš„æœ€é‡è¦çš„ä¸€ç‚¹ï¼šGitHub Copilot ç”¨çš„æ˜¯<strong>ä¸¤å±‚ Token æ¶æ„</strong>ã€‚<ul><li><p><strong>ç¬¬ä¸€å±‚ï¼šGitHub OAuth Token</strong>ï¼ˆé•¿æœŸæœ‰æ•ˆï¼‰</p> <ul><li>é€šè¿‡ Device Flow è·å–<li>å­˜å‚¨åœ¨ <code>~/.copilotx/auth.json</code>ï¼ˆchmod 600ï¼‰<li>åªè¦ç”¨æˆ·ä¸æ’¤é”€æˆæƒå°±ä¸€ç›´æœ‰æ•ˆ</ul><li><p><strong>ç¬¬äºŒå±‚ï¼šCopilot JWT</strong>ï¼ˆçº¦ 30 åˆ†é’Ÿæœ‰æ•ˆï¼‰</p> <ul><li>ç”¨ GitHub Token å‘ <code>api.github.com/copilot_internal/v2/token</code> æ¢å–<li>å®é™…è¯·æ±‚ Copilot API ç”¨çš„æ˜¯è¿™ä¸ª JWT<li><strong>CopilotX åœ¨ JWT åˆ°æœŸå‰ 60 ç§’è‡ªåŠ¨åˆ·æ–°</strong>ï¼Œå¯¹ç”¨æˆ·å®Œå…¨é€æ˜</ul></ul><pre class=language-python data-lang=python style=background:#2b303b;color:#c0c5ce><code class=language-python data-lang=python><span style=color:#b48ead>async def </span><span style=color:#8fa1b3>ensure_copilot_token</span><span>(</span><span style=color:#bf616a>self</span><span>) -> str:
</span><span>    </span><span style=color:#65737e>"""ç¡®ä¿ Copilot JWT æœ‰æ•ˆï¼Œåˆ°æœŸå‰è‡ªåŠ¨åˆ·æ–°"""
</span><span>    </span><span style=color:#b48ead>if </span><span style=color:#bf616a>self</span><span>._copilot_token and time.</span><span style=color:#bf616a>time</span><span>() < </span><span style=color:#bf616a>self</span><span>._expires_at - </span><span style=color:#bf616a>TOKEN_REFRESH_BUFFER</span><span>:
</span><span>        </span><span style=color:#b48ead>return </span><span style=color:#bf616a>self</span><span>._copilot_token
</span><span>    </span><span style=color:#65737e># è‡ªåŠ¨ç”¨ GitHub Token æ¢å–æ–°çš„ Copilot JWT
</span><span>    </span><span style=color:#bf616a>self</span><span>._copilot_token = </span><span style=color:#b48ead>await </span><span style=color:#bf616a>self</span><span>.</span><span style=color:#bf616a>_fetch_copilot_token</span><span>()
</span><span>    </span><span style=color:#b48ead>return </span><span style=color:#bf616a>self</span><span>._copilot_token
</span></code></pre><h3 id=anthropic-openai-ge-shi-fan-yi>Anthropic â†’ OpenAI æ ¼å¼ç¿»è¯‘</h3><p>Copilot åç«¯åªè¯´ OpenAIï¼Œä½†æˆ‘éœ€è¦è®©å®ƒä¹Ÿèƒ½æ¥å— Anthropic æ ¼å¼ã€‚ç¿»è¯‘å¼•æ“éœ€è¦å¤„ç†çš„æ ¸å¿ƒå·®å¼‚ï¼š<table><thead><tr><th>å·®å¼‚ç‚¹<th>OpenAI<th>Anthropic<tbody><tr><td>System æ¶ˆæ¯<td><code>messages</code> æ•°ç»„é‡Œ <code>role: "system"</code><td>ç‹¬ç«‹çš„ <code>system</code> å­—æ®µ<tr><td>å†…å®¹æ ¼å¼<td><code>content: "string"</code><td><code>content: [{type: "text", text: "..."}]</code><tr><td>åœæ­¢åŸå› <td><code>finish_reason: "stop"</code><td><code>stop_reason: "end_turn"</code><tr><td>æµå¼äº‹ä»¶<td><code>data: {choices: [{delta}]}</code><td><code>event: content_block_delta</code> + <code>data: {delta}</code></table><p>å…¶ä¸­<strong>æµå¼ç¿»è¯‘æœ€å¤æ‚</strong>ã€‚Anthropic çš„ SSE æœ‰ 6 ç§äº‹ä»¶ç±»å‹éœ€è¦æ„é€ ï¼š<pre style=background:#2b303b;color:#c0c5ce><code><span>message_start â†’ content_block_start â†’ content_block_delta (Næ¬¡)
</span><span>â†’ content_block_stop â†’ message_delta â†’ message_stop
</span></code></pre><p>è€Œ OpenAI åªæœ‰ <code>data: {...}</code> å’Œ <code>data: [DONE]</code>ã€‚æˆ‘éœ€è¦æŠŠ OpenAI çš„ç®€å•æµæ‹†è§£æˆ Anthropic çš„å®Œæ•´äº‹ä»¶åºåˆ—ã€‚<hr><h2 id=shi-xian-liang-dian>å®ç°äº®ç‚¹</h2><h3 id=22-ge-mo-xing-kai-xiang-ji-yong>22 ä¸ªæ¨¡å‹ï¼Œå¼€ç®±å³ç”¨</h3><p><code>copilotx models</code> ä¸€ä¸‹å°±èƒ½çœ‹åˆ° Copilot åç«¯æä¾›çš„æ‰€æœ‰æ¨¡å‹ï¼š<pre style=background:#2b303b;color:#c0c5ce><code><span>ğŸ“‹ Available Models
</span><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span><span>â”‚ Model ID                         â”‚ Name                  â”‚ Vendor  â”‚
</span><span>â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
</span><span>â”‚ gpt-4o                           â”‚ GPT-4o                â”‚ Azure   â”‚
</span><span>â”‚ gpt-4o-mini                      â”‚ GPT-4o Mini           â”‚ Azure   â”‚
</span><span>â”‚ o3-mini                          â”‚ o3-mini               â”‚ Azure   â”‚
</span><span>â”‚ claude-sonnet-4                  â”‚ Claude Sonnet 4       â”‚ Azure   â”‚
</span><span>â”‚ gemini-2.0-flash                 â”‚ Gemini 2.0 Flash      â”‚ Azure   â”‚
</span><span>â”‚ ...                              â”‚ ...                   â”‚ ...     â”‚
</span><span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</span><span>
</span><span>Total: 22 models
</span></code></pre><p>GPT-4oã€Claude Sonnet 4ã€Gemini 2.0 Flashã€o3-miniâ€¦â€¦è¿™äº›æ¨¡å‹å…¨éƒ½å¯ä»¥é€šè¿‡ä¸€ä¸ªç»Ÿä¸€çš„æœ¬åœ° API è°ƒç”¨ã€‚<h3 id=zhi-neng-duan-kou-guan-li>æ™ºèƒ½ç«¯å£ç®¡ç†</h3><p>é»˜è®¤ç«¯å£é€‰äº† <code>24680</code>ï¼ˆå¶æ•°é€’å¢ï¼Œå¥½è®°åˆå†·é—¨ï¼‰ã€‚ä½†çœŸæ­£çš„äº®ç‚¹åœ¨äº<strong>ç«¯å£ç­–ç•¥çš„åŒæ¨¡å¼è®¾è®¡</strong>ï¼š<pre class=language-bash data-lang=bash style=background:#2b303b;color:#c0c5ce><code class=language-bash data-lang=bash><span style=color:#65737e># è‡ªåŠ¨æ¨¡å¼ï¼š24680 è¢«å å°±è‡ªåŠ¨è¯• 24681ã€24682â€¦
</span><span style=color:#bf616a>copilotx</span><span> serve
</span><span>
</span><span style=color:#65737e># ä¸¥æ ¼æ¨¡å¼ï¼šç«¯å£å†²çªç›´æ¥æŠ¥é”™ï¼Œå°Šé‡ç”¨æˆ·çš„é€‰æ‹©
</span><span style=color:#bf616a>copilotx</span><span> serve</span><span style=color:#bf616a> --port</span><span> 9999
</span></code></pre><p>åŒæ—¶ï¼Œå¯åŠ¨æ—¶ä¼šå†™å…¥ <code>~/.copilotx/server.json</code>ï¼š<pre class=language-json data-lang=json style=background:#2b303b;color:#c0c5ce><code class=language-json data-lang=json><span>{
</span><span>  "</span><span style=color:#a3be8c>host</span><span>": "</span><span style=color:#a3be8c>127.0.0.1</span><span>",
</span><span>  "</span><span style=color:#a3be8c>port</span><span>": </span><span style=color:#d08770>24680</span><span>,
</span><span>  "</span><span style=color:#a3be8c>pid</span><span>": </span><span style=color:#d08770>12345</span><span>,
</span><span>  "</span><span style=color:#a3be8c>base_url</span><span>": "</span><span style=color:#a3be8c>http://127.0.0.1:24680</span><span>"
</span><span>}
</span></code></pre><p>è¿™æ ·å…¶ä»–è„šæœ¬å¯ä»¥ç¨‹åºåŒ–åœ°å‘ç°ç«¯å£ï¼Œè€Œä¸éœ€è¦ç¡¬ç¼–ç ã€‚æœåŠ¡å™¨åœæ­¢æ—¶è‡ªåŠ¨æ¸…ç†è¿™ä¸ªæ–‡ä»¶ã€‚<h3 id=bing-fa-ce-shi-16-16>å¹¶å‘æµ‹è¯•ï¼š16/16</h3><p>è¿™æ˜¯æœ€è®©æˆ‘æ»¡æ„çš„ä¸€ä¸ªç¯èŠ‚ã€‚æˆ‘ç”¨ Python asyncio + httpx å†™äº†ä¸€ä¸ªå¹¶å‘æµ‹è¯•å¥—ä»¶ï¼Œä¸‰ç»„æµ‹è¯•å…¨éƒ¨é€šè¿‡ï¼š<pre style=background:#2b303b;color:#c0c5ce><code><span>============================================================
</span><span>  OpenAI /v1/chat/completions: 5 parallel requests
</span><span>============================================================
</span><span>  [OK]   #1 |    1000ms | Request 1 OK
</span><span>  [OK]   #2 |     975ms | Request 2 OK
</span><span>  [OK]   #3 |     958ms | Request 3 OK
</span><span>  [OK]   #4 |     962ms | Request 4 OK
</span><span>  [OK]   #5 |     966ms | Request 5 OK
</span><span>  --- 5/5 succeeded, wall time: 1001ms ---
</span><span>
</span><span>============================================================
</span><span>  Anthropic /v1/messages: 5 parallel requests
</span><span>============================================================
</span><span>  [OK]   #1 |    1062ms | Request 1 OK
</span><span>  [OK]   #2 |    1063ms | Request 2 OK
</span><span>  [OK]   #3 |     998ms | Request 3 OK
</span><span>  [OK]   #4 |    1189ms | Request 4 OK
</span><span>  [OK]   #5 |    1032ms | Request 5 OK
</span><span>  --- 5/5 succeeded, wall time: 1190ms ---
</span><span>
</span><span>============================================================
</span><span>  Mixed: 3 OpenAI + 3 Anthropic parallel
</span><span>============================================================
</span><span>  [OK]   #1 |     604ms | Hello! How can I assist you today?
</span><span>  [OK]   #4 |    2135ms | Hi there! I'm Claude
</span><span>  --- 6/6 succeeded, wall time: 2136ms ---
</span><span>
</span><span>  FINAL: 16/16 requests passed âœ…
</span></code></pre><p>æ³¨æ„çœ‹ wall timeâ€”â€”5 ä¸ªå¹¶å‘è¯·æ±‚çš„æ€»è€—æ—¶çº¦ç­‰äºå•ä¸ªè¯·æ±‚ï¼ˆ~1sï¼‰ï¼Œè¯æ˜ FastAPI async æ¶æ„çœŸæ­£å®ç°äº†å¹¶è¡Œå¤„ç†ã€‚<hr><h2 id=san-xing-ming-ling-ti-yan>ä¸‰è¡Œå‘½ä»¤ä½“éªŒ</h2><p>è¯´äº†è¿™ä¹ˆå¤šæŠ€æœ¯ç»†èŠ‚ï¼Œå®é™…ç”¨èµ·æ¥å°±ä¸‰è¡Œï¼š<pre class=language-bash data-lang=bash style=background:#2b303b;color:#c0c5ce><code class=language-bash data-lang=bash><span style=color:#bf616a>pip</span><span> install copilotx        </span><span style=color:#65737e># å®‰è£…
</span><span style=color:#bf616a>copilotx</span><span> auth login          </span><span style=color:#65737e># æµè§ˆå™¨æˆæƒ
</span><span style=color:#bf616a>copilotx</span><span> serve               </span><span style=color:#65737e># èµ·æœåŠ¡
</span></code></pre><p>ç„¶åä½ å°±æœ‰äº†ä¸€ä¸ªæœ¬åœ° API æœåŠ¡å™¨ã€‚æ­é… Claude Codeï¼š<pre class=language-bash data-lang=bash style=background:#2b303b;color:#c0c5ce><code class=language-bash data-lang=bash><span style=color:#b48ead>export </span><span style=color:#bf616a>ANTHROPIC_BASE_URL</span><span>=</span><span style=color:#a3be8c>http://localhost:24680
</span><span style=color:#b48ead>export </span><span style=color:#bf616a>ANTHROPIC_API_KEY</span><span>=</span><span style=color:#a3be8c>copilotx
</span><span style=color:#bf616a>claude
</span></code></pre><p>æ­é… Codexï¼š<pre class=language-bash data-lang=bash style=background:#2b303b;color:#c0c5ce><code class=language-bash data-lang=bash><span style=color:#b48ead>export </span><span style=color:#bf616a>OPENAI_BASE_URL</span><span>=</span><span style=color:#a3be8c>http://localhost:24680/v1
</span><span style=color:#b48ead>export </span><span style=color:#bf616a>OPENAI_API_KEY</span><span>=</span><span style=color:#a3be8c>copilotx
</span><span style=color:#bf616a>codex
</span></code></pre><p>æ­é…ä»»æ„ Python è„šæœ¬ï¼š<pre class=language-python data-lang=python style=background:#2b303b;color:#c0c5ce><code class=language-python data-lang=python><span style=color:#b48ead>from </span><span>openai </span><span style=color:#b48ead>import </span><span>OpenAI
</span><span>client = </span><span style=color:#bf616a>OpenAI</span><span>(</span><span style=color:#bf616a>base_url</span><span>="</span><span style=color:#a3be8c>http://localhost:24680/v1</span><span>", </span><span style=color:#bf616a>api_key</span><span>="</span><span style=color:#a3be8c>copilotx</span><span>")
</span><span>
</span><span>response = client.chat.completions.</span><span style=color:#bf616a>create</span><span>(
</span><span>    </span><span style=color:#bf616a>model</span><span>="</span><span style=color:#a3be8c>gpt-4o</span><span>",
</span><span>    </span><span style=color:#bf616a>messages</span><span>=[{"</span><span style=color:#a3be8c>role</span><span>": "</span><span style=color:#a3be8c>user</span><span>", "</span><span style=color:#a3be8c>content</span><span>": "</span><span style=color:#a3be8c>Hello!</span><span>"}],
</span><span>    </span><span style=color:#bf616a>stream</span><span>=</span><span style=color:#d08770>True</span><span>,
</span><span>)
</span><span style=color:#b48ead>for </span><span>chunk </span><span style=color:#b48ead>in </span><span>response:
</span><span>    </span><span style=color:#96b5b4>print</span><span>(chunk.choices[</span><span style=color:#d08770>0</span><span>].delta.content or "", </span><span style=color:#bf616a>end</span><span>="")
</span></code></pre><p><code>api_key</code> å¯ä»¥å¡«ä»»æ„å­—ç¬¦ä¸²â€”â€”CopilotX è‡ªå·±ç®¡ç†è®¤è¯ï¼Œä¸éœ€è¦ä½ æä¾› keyã€‚<hr><h2 id=ji-zhu-zhan-yi-lan>æŠ€æœ¯æ ˆä¸€è§ˆ</h2><table><thead><tr><th>ç»„ä»¶<th>é€‰æ‹©<th>ç†ç”±<tbody><tr><td>HTTP æ¡†æ¶<td>FastAPI + Uvicorn<td>åŸç”Ÿ asyncï¼ŒSSE streaming æ”¯æŒå¥½<tr><td>HTTP å®¢æˆ·ç«¯<td>httpx<td>async æ”¯æŒï¼Œstreaming å‹å¥½<tr><td>CLI æ¡†æ¶<td>Typer + Rich<td>æ¼‚äº®çš„ç»ˆç«¯è¾“å‡ºï¼Œç±»å‹å®‰å…¨<tr><td>æ•°æ®éªŒè¯<td>Pydantic v2<td>FastAPI åŸç”Ÿæ”¯æŒ<tr><td>æ„å»ºç³»ç»Ÿ<td>Hatchling<td>ç°ä»£ Python æ‰“åŒ…æ ‡å‡†</table><p>æ•´ä¸ªé¡¹ç›® <strong>21 ä¸ªæ–‡ä»¶ï¼Œ1479 è¡Œä»£ç </strong>ã€‚æ²¡æœ‰ä¸€è¡Œæ˜¯å¤šä½™çš„ã€‚<pre style=background:#2b303b;color:#c0c5ce><code><span>src/copilotx/
</span><span>â”œâ”€â”€ auth/          # OAuth + Token ç”Ÿå‘½å‘¨æœŸ
</span><span>â”‚   â”œâ”€â”€ oauth.py      # GitHub Device Flow
</span><span>â”‚   â”œâ”€â”€ token.py      # Copilot JWT ç®¡ç†
</span><span>â”‚   â””â”€â”€ storage.py    # å‡­è¯æŒä¹…åŒ–
</span><span>â”œâ”€â”€ proxy/         # ä»£ç†æ ¸å¿ƒ
</span><span>â”‚   â”œâ”€â”€ client.py     # Copilot API å®¢æˆ·ç«¯
</span><span>â”‚   â”œâ”€â”€ translator.py # Anthropic â†” OpenAI ç¿»è¯‘
</span><span>â”‚   â””â”€â”€ streaming.py  # SSE æµå¼å“åº”
</span><span>â”œâ”€â”€ server/        # FastAPI æœåŠ¡
</span><span>â”‚   â”œâ”€â”€ app.py        # åº”ç”¨å·¥å‚ + lifespan
</span><span>â”‚   â”œâ”€â”€ routes_openai.py
</span><span>â”‚   â”œâ”€â”€ routes_anthropic.py
</span><span>â”‚   â””â”€â”€ routes_models.py
</span><span>â”œâ”€â”€ cli.py         # Typer CLI
</span><span>â””â”€â”€ config.py      # å…¨å±€å¸¸é‡
</span></code></pre><hr><h2 id=shou-huo-yu-fan-si>æ”¶è·ä¸åæ€</h2><h3 id=cong-fen-xi-dao-chan-pin-su-du-ke-yi-hen-kuai>ä»åˆ†æåˆ°äº§å“ï¼Œé€Ÿåº¦å¯ä»¥å¾ˆå¿«</h3><p>è¿™ä¸ªé¡¹ç›®ä»"æˆ‘æ¥çœ‹çœ‹åˆ«äººæ€ä¹ˆåšçš„"åˆ°"PyPI å‘å¸ƒ + GitHub å¼€æº"ï¼Œç”¨äº†ä¸åˆ°ä¸€å¤©ã€‚å…³é”®ä¸æ˜¯å†™å¾—å¿«ï¼Œè€Œæ˜¯<strong>å…ˆèŠ±è¶³å¤Ÿæ—¶é—´ç ”ç©¶ï¼Œæƒ³æ¸…æ¥šå†åŠ¨æ‰‹</strong>ã€‚é‚£ä¸ªä¸‹åˆåˆ†æä¸‰ä¸ªé¡¹ç›®çš„æ—¶é—´ï¼Œä»·å€¼è¿œè¶…æ™šä¸Šçš„ç¼–ç æ—¶é—´ã€‚<h3 id=zhan-zai-ju-ren-de-jian-bang-shang>ç«™åœ¨å·¨äººçš„è‚©è†€ä¸Š</h3><p>Router-Maestro æ•™ä¼šäº†æˆ‘ OAuth Device Flow å’Œä¸¤å±‚ Token æœºåˆ¶ï¼ŒAgent-Maestro è®©æˆ‘çŸ¥é“äº† MCP é›†æˆçš„å¯èƒ½æ€§ï¼ŒGateX åˆ™æ˜¯æˆ‘è‡ªå·±ä¹‹å‰çš„å®è·µç§¯ç´¯ã€‚CopilotX ä¸æ˜¯å‡­ç©ºåˆ›é€ çš„ï¼Œæ˜¯ä¸‰ä¸ªé¡¹ç›®æœ€ä½³å®è·µçš„èåˆã€‚<h3 id=xia-yi-bu-ji-hua>ä¸‹ä¸€æ­¥è®¡åˆ’</h3><ul><li><strong>v0.2</strong>: æ”¯æŒ Google Gemini API æ ¼å¼ï¼ˆç¬¬ä¸‰å¤§ AI SDKï¼‰<li><strong>v0.3</strong>: å¢åŠ  <code>copilotx config</code> å‘½ä»¤ï¼Œæ”¯æŒè‡ªå®šä¹‰ Header å’Œæ¨¡å‹åˆ«å<li><strong>GateX v2</strong>: æŠŠ CopilotX çš„åŒæ ¼å¼ç¿»è¯‘å¼•æ“ç§»æ¤å› VS Code æ‰©å±•</ul><hr><h2 id=lian-jie>é“¾æ¥</h2><ul><li><strong>PyPI</strong>: <a href=https://pypi.org/project/copilotx/>pypi.org/project/copilotx</a><li><strong>GitHub</strong>: <a href=https://github.com/Polly2014/CopilotX>github.com/Polly2014/CopilotX</a></ul><p>å¦‚æœä½ ä¹Ÿæœ‰ GitHub Copilot è®¢é˜…ï¼Œä¸å¦¨è¯•è¯•ï¼š<pre class=language-bash data-lang=bash style=background:#2b303b;color:#c0c5ce><code class=language-bash data-lang=bash><span style=color:#bf616a>pip</span><span> install copilotx && </span><span style=color:#bf616a>copilotx</span><span> auth login && </span><span style=color:#bf616a>copilotx</span><span> serve
</span></code></pre><p>ä¸‰è¡Œå‘½ä»¤ï¼Œè§£é” 22 ä¸ªæ¨¡å‹ã€‚ğŸš€</div><div class=navigation></div></div><div id=giscus-container><h2>Comments</h2><div class=giscus></div></div><script data-category="Blog Comments" async crossorigin data-category-id=DIC_kwDOL45duM4CnjlZ data-emit-metadata=0 data-input-position=bottom data-lang=en data-mapping=pathname data-reactions-enabled=1 data-repo=Polly2014/polly2014.github.io data-repo-id=R_kgDOL45duA data-strict=0 data-theme=noborder_light src=https://giscus.app/client.js></script><script type=module>
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        
        mermaid.initialize({
            startOnLoad: false,
            theme: 'base',
            themeVariables: {
                // ç°ç™½é»‘è‰²è°ƒ + è“è‰²ç‚¹ç¼€
                primaryColor: '#e8e8e8',
                primaryTextColor: '#333',
                primaryBorderColor: '#999',
                lineColor: 'rgb(61, 146, 201)',
                secondaryColor: '#f5f5f5',
                tertiaryColor: '#fafafa',
                background: '#f2f2f2',
                mainBkg: '#f5f5f5',
                nodeBorder: '#999',
                clusterBkg: '#eee',
                clusterBorder: '#ccc',
                titleColor: '#333',
                edgeLabelBackground: '#f2f2f2',
                // æ–‡æœ¬é¢œè‰²
                textColor: '#333',
                nodeTextColor: '#333',
                // å…¶ä»–
                fontFamily: "'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace"
            },
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true,
                curve: 'basis'
            }
        });

        // æŸ¥æ‰¾æ‰€æœ‰ mermaid ä»£ç å—å¹¶æ¸²æŸ“
        document.querySelectorAll('pre code.language-mermaid').forEach((block, index) => {
            const container = document.createElement('div');
            container.className = 'mermaid';
            container.textContent = block.textContent;
            block.parentNode.replaceWith(container);
        });

        // æ¸²æŸ“æ‰€æœ‰ mermaid å›¾è¡¨
        await mermaid.run();
    </script><style>.cover-image{text-align:center;margin:1.5em 0 2em 0}.cover-image img{width:60%;height:auto;border-radius:8px;box-shadow:0 4px 12px rgba(0,0,0,0.15)}.mermaid{background:#fafafa;border:1px solid #ddd;padding:20px;margin:20px 0;overflow-x:auto}.mermaid svg{max-width:100%;height:auto}@media (max-width:768px){.cover-image img{width:100%}}</style></div></div><script>document.addEventListener('DOMContentLoaded',function(){const c=document.querySelector('.menu-toggle');const d=document.querySelector('.sidebar');const e=document.querySelector('.overlay');function a(){d.classList.toggle('active');e.classList.toggle('active')}c.addEventListener('click',a);e.addEventListener('click',a);let f=0;let g=0;document.addEventListener('touchstart',h=>{f=h.changedTouches[0].screenX},false);document.addEventListener('touchend',h=>{g=h.changedTouches[0].screenX;b()},false);function b(){const h=g- f;if(h>50&&f<30){d.classList.add('active');e.classList.add('active')}else if(h<-50&&d.classList.contains('active')){d.classList.remove('active');e.classList.remove('active')}}})</script>