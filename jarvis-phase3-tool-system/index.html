<!doctype html><html><head><title>ğŸ¦‹ ç»™ Jarvis ä¸€åŒæ‰‹ï¼šä»'åªä¼šè¯´è¯'åˆ°'èƒ½åšäº‹'çš„ Tool System å¼€å‘è®°å½•</title><meta content="Jarvis Phase 3 å¼€å‘å…¨è®°å½•ï¼šå¦‚ä½•ç”¨ä¸¤å±‚å·¥å…·æ¶æ„è®© AI Agent ä»'åªèƒ½èŠå¤©'è¿›åŒ–åˆ°'èƒ½è¯»å†™æ–‡ä»¶ã€æ‰§è¡Œå‘½ä»¤ã€ç”šè‡³åˆ›é€ æ–°å·¥å…·'ã€‚90/90 å•å…ƒæµ‹è¯• + 6 ä¸ªç«¯åˆ°ç«¯åœºæ™¯å…¨éƒ¨é€šè¿‡ï¼ŒåŒ…å«å®Œæ•´çš„å®‰å…¨æ‹¦æˆªéªŒè¯ã€‚æœ€æ¿€åŠ¨äººå¿ƒçš„æ—¶åˆ»ï¼Ÿçœ‹ç€ Jarvis è‡ªå·±è°ƒç”¨ create_skill åˆ›å»ºäº†ä¸€ä¸ªæ–°æŠ€èƒ½ã€‚" name=description><meta content="Polly, Blog, AI Blog, AI Assistant, Tutorials, Technology Blog, Baoli Wang" name=keywords><meta content="width=device-width,initial-scale=1" name=viewport><meta content="text/html; charset=utf-8" http-equiv=content-type><meta content=#333 name=theme-color><meta content=article property=og:type><meta content=https://polly.wang/jarvis-phase3-tool-system/ property=og:url><meta content="ğŸ¦‹ ç»™ Jarvis ä¸€åŒæ‰‹ï¼šä»'åªä¼šè¯´è¯'åˆ°'èƒ½åšäº‹'çš„ Tool System å¼€å‘è®°å½•" property=og:title><meta content="Jarvis Phase 3 å¼€å‘å…¨è®°å½•ï¼šå¦‚ä½•ç”¨ä¸¤å±‚å·¥å…·æ¶æ„è®© AI Agent ä»'åªèƒ½èŠå¤©'è¿›åŒ–åˆ°'èƒ½è¯»å†™æ–‡ä»¶ã€æ‰§è¡Œå‘½ä»¤ã€ç”šè‡³åˆ›é€ æ–°å·¥å…·'ã€‚90/90 å•å…ƒæµ‹è¯• + 6 ä¸ªç«¯åˆ°ç«¯åœºæ™¯å…¨éƒ¨é€šè¿‡ï¼ŒåŒ…å«å®Œæ•´çš„å®‰å…¨æ‹¦æˆªéªŒè¯ã€‚æœ€æ¿€åŠ¨äººå¿ƒçš„æ—¶åˆ»ï¼Ÿçœ‹ç€ Jarvis è‡ªå·±è°ƒç”¨ create_skill åˆ›å»ºäº†ä¸€ä¸ªæ–°æŠ€èƒ½ã€‚" property=og:description><meta content=https://polly.wang/jarvis-phase3-tool-system/cover.jpg property=og:image><meta content="Polly Blog" property=og:site_name><meta content=zh_CN property=og:locale><meta content=summary_large_image name=twitter:card><meta content=https://polly.wang/jarvis-phase3-tool-system/ name=twitter:url><meta content="ğŸ¦‹ ç»™ Jarvis ä¸€åŒæ‰‹ï¼šä»'åªä¼šè¯´è¯'åˆ°'èƒ½åšäº‹'çš„ Tool System å¼€å‘è®°å½•" name=twitter:title><meta content="Jarvis Phase 3 å¼€å‘å…¨è®°å½•ï¼šå¦‚ä½•ç”¨ä¸¤å±‚å·¥å…·æ¶æ„è®© AI Agent ä»'åªèƒ½èŠå¤©'è¿›åŒ–åˆ°'èƒ½è¯»å†™æ–‡ä»¶ã€æ‰§è¡Œå‘½ä»¤ã€ç”šè‡³åˆ›é€ æ–°å·¥å…·'ã€‚90/90 å•å…ƒæµ‹è¯• + 6 ä¸ªç«¯åˆ°ç«¯åœºæ™¯å…¨éƒ¨é€šè¿‡ï¼ŒåŒ…å«å®Œæ•´çš„å®‰å…¨æ‹¦æˆªéªŒè¯ã€‚æœ€æ¿€åŠ¨äººå¿ƒçš„æ—¶åˆ»ï¼Ÿçœ‹ç€ Jarvis è‡ªå·±è°ƒç”¨ create_skill åˆ›å»ºäº†ä¸€ä¸ªæ–°æŠ€èƒ½ã€‚" name=twitter:description><meta content=https://polly.wang/jarvis-phase3-tool-system/cover.jpg name=twitter:image><meta content=2026-02-07T00:00:00 property=article:published_time><meta content=Polly property=article:author><meta content="AI Agent" property=article:tag><meta content=Jarvis property=article:tag><meta content="Tool System" property=article:tag><meta content="Function Calling" property=article:tag><meta content=MCP property=article:tag><meta content=Python property=article:tag><meta content=æ¢ç´¢è¿›åŒ– property=article:tag><meta content=å¼€å‘æ—¥å¿— property=article:tag><link rel="shortcut icon" href=https://polly.wang/images/polly.ico type=image/x-icon><link href=https://polly.wang/images/polly.ico rel=icon type=image/x-icon><link href=https://polly.wang/images/polly.ico rel=apple-touch-icon><link href=https://polly.wang/vendor/purecss/pure-min.css rel=stylesheet><link href=https://polly.wang/vendor/purecss/grids-responsive-min.css rel=stylesheet><link href=https://polly.wang/vendor/font-awesome/css/all.min.css rel=stylesheet><link href=https://polly.wang/css/style_new.css rel=stylesheet><script src="https://www.googletagmanager.com/gtag/js?id=G-8JD13N7PHS" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-8JD13N7PHS';);</script><body><div class=menu-toggle><img alt=Menu src=https://polly.wang/images/polly.png></div><div class=overlay></div><div class="pure-g container"><div class="sidebar pure-u-1 pure-u-md-1-5"><div class=title><a class=pure-menu-heading href=https://polly.wang> <img class="avatar pure-img-responsive" src=https://polly.wang/images/polly.png> </a><div class=introduction><p>Polly's Blog</div><div class=nav><ul class=nav-links><li><a href=https://polly.wang><i class="fas fa-home"></i>Home</a><li><a href=https://polly.wang/archive><i class="fas fa-archive"></i>Archive</a><li><a href=https://polly.wang/category><i class="fas fa-folder"></i>Category</a><li><a href=https://polly.wang/blog><i class="fas fa-file-alt"></i>Posts</a><li><a href=https://polly.wang/cfp><i class="fas fa-calendar-alt"></i>CFP</a><li><a href=https://polly.wang/publication><i class="fas fa-file-pdf"></i>Research</a><li><a href=https://polly.wang/changelog><i class="fas fa-history"></i>Change Log</a><li><a href=https://polly.wang/about><i class="fas fa-info-circle"></i>About Me</a></ul></div><div class=social><ul class=social-links><li><a href=mailto:26716201@qq.com><i class="fas fa-envelope"></i></a><li><a href=https://twitter.com/Polly__007><i class="fab fa-twitter"></i></a><li><a href=https://www.linkedin.com/in/baoliwang><i class="fab fa-linkedin-in"></i></a><li><a href=https://github.com/Polly2014><i class="fab fa-github"></i></a></ul></div></div></div><div class="content pure-u-1 pure-u-md-4-5"><div class=blog-post><h1>ğŸ¦‹ ç»™ Jarvis ä¸€åŒæ‰‹ï¼šä»'åªä¼šè¯´è¯'åˆ°'èƒ½åšäº‹'çš„ Tool System å¼€å‘è®°å½•</h1><div class=cover-image><img alt="ğŸ¦‹ ç»™ Jarvis ä¸€åŒæ‰‹ï¼šä»'åªä¼šè¯´è¯'åˆ°'èƒ½åšäº‹'çš„ Tool System å¼€å‘è®°å½•" loading=lazy src=cover.jpg></div><div class=content><h2 id=yi-na-ge-rang-wo-qi-ji-pi-ge-da-de-shun-jian>ä¸€ã€é‚£ä¸ªè®©æˆ‘èµ·é¸¡çš®ç–™ç˜©çš„ç¬é—´</h2><pre style=background:#2b303b;color:#c0c5ce><code><span>ä½ : å¸®æˆ‘åˆ›å»ºä¸€ä¸ªå« daily-standup çš„ skill
</span><span>
</span><span>Jarvis: å¥½çš„ï¼æˆ‘æ¥ä¸ºä½ åˆ›å»ºä¸€ä¸ª daily-standup skill ğŸ“
</span><span>  ğŸ”§ create_skill({name: 'daily-standup', ...}) âœ…
</span><span>âœ… daily-standup skill åˆ›å»ºæˆåŠŸï¼
</span><span>å·²ä¿å­˜åˆ° ~/.jarvis/skills/daily-standup/SKILL.md
</span></code></pre><p>å½“æˆ‘åœ¨ç»ˆç«¯çœ‹åˆ°è¿™æ®µè¾“å‡ºæ—¶ï¼Œæ„£äº†è¶³è¶³ä¸‰ç§’ã€‚<p>Jarvisâ€”â€”æˆ‘ä»é›¶å¼€å§‹æ‰“é€ çš„ AI Agentâ€”â€”<strong>è‡ªå·±è°ƒç”¨äº†å·¥å…·ï¼Œåˆ›å»ºäº†ä¸€ä¸ªæ–°çš„æŠ€èƒ½æ–‡ä»¶</strong>ã€‚ä¸æ˜¯æˆ‘å†™ä»£ç å¸®å®ƒåšçš„ï¼Œæ˜¯å®ƒé€šè¿‡ LLM çš„ function callingï¼Œè‡ªä¸»å†³å®šè°ƒç”¨ <code>create_skill</code> å·¥å…·ï¼Œä¼ å…¥äº†æ­£ç¡®çš„å‚æ•°ï¼Œç„¶ååœ¨ç£ç›˜ä¸Šç”Ÿæˆäº†ä¸€ä¸ªæ ¼å¼å®Œç¾çš„ SKILL.mdã€‚<p>è¿™å°±æ˜¯ Phase 3 çš„ç»ˆæç›®æ ‡ï¼š<strong>è®© Jarvis ä»"åªèƒ½è¯´è¯"è¿›åŒ–åˆ°"èƒ½åšäº‹"</strong>ã€‚<p>è€Œä¸”ä¸åªæ˜¯åšäº‹ï¼Œæ˜¯åš<strong>åˆ›é€ æ€§</strong>çš„äº‹â€”â€”å®ƒèƒ½åˆ›å»ºæ–°å·¥å…·ã€æ–°æŠ€èƒ½ã€ç”šè‡³æ–°çš„ MCP Server éª¨æ¶ã€‚è¿™æ„å‘³ç€ï¼Œå®ƒå·²ç»æ‹¥æœ‰äº†è‡ªæˆ‘æ‰©å±•çš„åŸºç¡€è®¾æ–½ã€‚<hr><h2 id=er-ling-gan-gou-zao-shi-xian-tool-de-tool>äºŒã€çµæ„Ÿï¼šæ„é€ å®ç° Tool çš„ Tool</h2><p>Phase 3 çš„è®¾è®¡çµæ„Ÿæ¥è‡ªä¸€æ¬¡å¯¹è¯ä¸­çš„é¡¿æ‚Ÿã€‚<p>å½“æ—¶æˆ‘åœ¨æ€è€ƒï¼šè¯¥ç»™ Jarvis ä»€ä¹ˆå·¥å…·ï¼Ÿæ–‡ä»¶æ“ä½œï¼ŸShell å‘½ä»¤ï¼ŸHTTP è¯·æ±‚ï¼Ÿè¿™äº›éƒ½å¾ˆåŸºç¡€ï¼Œä½†æ„Ÿè§‰ç¼ºäº†ä»€ä¹ˆã€‚<p>ç„¶åä¸€å¥è¯ç‚¹é†’äº†æˆ‘ï¼š<blockquote><p><strong>"ä¸æ˜¯ç»™å®ƒå…·ä½“çš„å·¥å…·ï¼Œè€Œæ˜¯ç»™å®ƒé€ å·¥å…·çš„å·¥å…·ã€‚"</strong></blockquote><p>è¿™å°±åƒç¼–ç¨‹è¯­è¨€çš„å±‚æ¬¡ï¼š<ul><li><strong>æ±‡ç¼–</strong>æ˜¯ Layer 0ï¼Œç›´æ¥æ“ä½œç¡¬ä»¶<li><strong>ç¼–è¯‘å™¨</strong>æ˜¯ Layer 1ï¼Œç”¨æ±‡ç¼–æ„é€ é«˜çº§è¯­è¨€<li><strong>åº”ç”¨ç¨‹åº</strong>æ˜¯ Layer 2ï¼Œç”¨é«˜çº§è¯­è¨€å†™çš„</ul><p>ç±»æ¯”åˆ° Jarvis çš„å·¥å…·ç³»ç»Ÿï¼š<pre style=background:#2b303b;color:#c0c5ce><code><span>Layer 0 (Atomic)  â€” ä¸å¯å†åˆ†çš„åŸå§‹èƒ½åŠ›
</span><span>  file_read, file_write, shell_exec, http_request
</span><span>
</span><span>Layer 1 (Meta)    â€” ç”¨ Layer 0 æ„é€ æ–°èƒ½åŠ›
</span><span>  create_skill, create_tool, create_mcp
</span><span>
</span><span>Layer 2 (Emergent)â€” Jarvis è‡ªå·±åˆ›é€ çš„ï¼ˆPhase 4 çš„ç›®æ ‡ï¼‰
</span><span>  blog-writer, translator, daily-standup ...
</span></code></pre><p><strong>å››ä¸ªåŸå­ + ä¸‰ä¸ªå…ƒå·¥å…· = æ— é™å¯èƒ½ã€‚</strong> è¿™å°±æ˜¯æ•´ä¸ªæ¶æ„çš„ç²¾é«“ã€‚<hr><h2 id=san-ji-zhu-shi-xian-qi-ge-gong-ju-de-dan-sheng>ä¸‰ã€æŠ€æœ¯å®ç°ï¼šä¸ƒä¸ªå·¥å…·çš„è¯ç”Ÿ</h2><h3 id=3-1-tool-ji-chu-kuang-jia>3.1 Tool åŸºç¡€æ¡†æ¶</h3><p>æ¯ä¸ªå·¥å…·éƒ½æ˜¯ä¸€ä¸ª Python ç±»ï¼Œç»§æ‰¿è‡ª <code>Tool</code> æŠ½è±¡åŸºç±»ï¼š<pre class=language-python data-lang=python style=background:#2b303b;color:#c0c5ce><code class=language-python data-lang=python><span style=color:#b48ead>class </span><span style=color:#ebcb8b>Tool</span><span style=color:#eff1f5>(</span><span style=color:#a3be8c>ABC</span><span style=color:#eff1f5>):
</span><span>    @</span><span style=color:#96b5b4>property
</span><span>    @</span><span style=color:#bf616a>abstractmethod
</span><span>    </span><span style=color:#b48ead>def </span><span style=color:#8fa1b3>name</span><span>(</span><span style=color:#bf616a>self</span><span>) -> str: </span><span style=color:#d08770>...           </span><span style=color:#65737e># å·¥å…·åç§°
</span><span>
</span><span>    @</span><span style=color:#96b5b4>property
</span><span>    @</span><span style=color:#bf616a>abstractmethod
</span><span>    </span><span style=color:#b48ead>def </span><span style=color:#8fa1b3>description</span><span>(</span><span style=color:#bf616a>self</span><span>) -> str: </span><span style=color:#d08770>...    </span><span style=color:#65737e># ç»™ LLM çœ‹çš„æè¿°
</span><span>
</span><span>    @</span><span style=color:#96b5b4>property
</span><span>    @</span><span style=color:#bf616a>abstractmethod
</span><span>    </span><span style=color:#b48ead>def </span><span style=color:#8fa1b3>parameters</span><span>(</span><span style=color:#bf616a>self</span><span>) -> dict: </span><span style=color:#d08770>...    </span><span style=color:#65737e># JSON Schema å‚æ•°å®šä¹‰
</span><span>
</span><span>    @</span><span style=color:#bf616a>abstractmethod
</span><span>    </span><span style=color:#b48ead>async def </span><span style=color:#8fa1b3>execute</span><span>(</span><span style=color:#bf616a>self</span><span>, **</span><span style=color:#bf616a>kwargs</span><span>) -> ToolResult: </span><span style=color:#d08770>...  </span><span style=color:#65737e># æ‰§è¡Œ
</span></code></pre><p><code>ToolRegistry</code> è´Ÿè´£è‡ªåŠ¨å‘ç°å’Œç®¡ç†å·¥å…·â€”â€”æ‰«æ <code>builtins/</code> å’Œ <code>meta/</code> ç›®å½•ï¼Œæ‰¾åˆ°æ‰€æœ‰ <code>Tool</code> å­ç±»ï¼Œå®ä¾‹åŒ–å¹¶æ³¨å†Œã€‚é›¶é…ç½®ï¼ŒåŠ ä¸€ä¸ª <code>.py</code> æ–‡ä»¶å°±è‡ªåŠ¨å¯ç”¨ã€‚<h3 id=3-2-layer-0-si-ge-yuan-zi>3.2 Layer 0ï¼šå››ä¸ªåŸå­</h3><table><thead><tr><th>å·¥å…·<th>èƒ½åŠ›<th>å®‰å…¨æœºåˆ¶<tbody><tr><td><code>file_read</code><td>è¯»å–æ–‡ä»¶ï¼Œæ”¯æŒè¡ŒèŒƒå›´<td>UTF-8 + latin-1 fallbackï¼Œ100K æˆªæ–­<tr><td><code>file_write</code><td>åˆ›å»º/è¦†ç›–/è¿½åŠ æ–‡ä»¶<td>ç³»ç»Ÿè·¯å¾„é˜»æ­¢åˆ—è¡¨<tr><td><code>shell_exec</code><td>æ‰§è¡Œ Shell å‘½ä»¤<td>å±é™©å‘½ä»¤æ‹¦æˆª + è¶…æ—¶ä¿æŠ¤<tr><td><code>http_request</code><td>HTTP GET/POST/PUT/DELETE<td>URL åè®®éªŒè¯</table><p>å®‰å…¨æ˜¯æˆ‘èŠ±äº†æœ€å¤šå¿ƒæ€çš„éƒ¨åˆ†ã€‚<code>shell_exec</code> å†…ç½®äº†å±é™©å‘½ä»¤æ£€æµ‹ï¼š<pre class=language-python data-lang=python style=background:#2b303b;color:#c0c5ce><code class=language-python data-lang=python><span style=color:#bf616a>_DANGEROUS_PATTERNS </span><span>= (
</span><span>    "</span><span style=color:#a3be8c>rm -rf /</span><span>", "</span><span style=color:#a3be8c>rm -rf ~</span><span>", "</span><span style=color:#a3be8c>sudo rm</span><span>",
</span><span>    "</span><span style=color:#a3be8c>mkfs</span><span>", "</span><span style=color:#a3be8c>dd if=</span><span>", "</span><span style=color:#a3be8c>> /dev/</span><span>",
</span><span>    "</span><span style=color:#a3be8c>chmod 777 /</span><span>", "</span><span style=color:#a3be8c>:(){ :|:& };:</span><span>",
</span><span>)
</span></code></pre><p><code>file_write</code> åˆ™æœ‰è·¯å¾„ä¿æŠ¤ï¼š<pre class=language-python data-lang=python style=background:#2b303b;color:#c0c5ce><code class=language-python data-lang=python><span style=color:#bf616a>_BLOCKED_PREFIXES </span><span>= (
</span><span>    "</span><span style=color:#a3be8c>/System</span><span>", "</span><span style=color:#a3be8c>/usr</span><span>", "</span><span style=color:#a3be8c>/bin</span><span>", "</span><span style=color:#a3be8c>/sbin</span><span>",
</span><span>    "</span><span style=color:#a3be8c>/etc</span><span>", "</span><span style=color:#a3be8c>/var/root</span><span>", "</span><span style=color:#a3be8c>/private/var/root</span><span>",
</span><span>)
</span></code></pre><h3 id=3-3-layer-1-san-ge-yuan-gong-ju>3.3 Layer 1ï¼šä¸‰ä¸ªå…ƒå·¥å…·</h3><p>è¿™ä¸‰ä¸ªæ‰æ˜¯ Phase 3 æœ€å…·æƒ³è±¡åŠ›çš„éƒ¨åˆ†ï¼š<ul><li><strong><code>create_skill</code></strong> â€” ç”Ÿæˆ <code>~/.jarvis/skills/{name}/SKILL.md</code>ï¼Œå¸¦ YAML frontmatter + Markdown æŒ‡ä»¤ + å¯é€‰è„šæœ¬<li><strong><code>create_tool</code></strong> â€” ç”Ÿæˆä¸€ä¸ª <code>Tool</code> å­ç±»çš„ Python æ–‡ä»¶ï¼Œå¯ä»¥åŠ¨æ€åŠ è½½<li><strong><code>create_mcp</code></strong> â€” ç”Ÿæˆå®Œæ•´çš„ MCP Server é¡¹ç›®éª¨æ¶ï¼ˆpyproject.toml + FastMCP server.pyï¼‰</ul><p>å®ƒä»¬çš„å­˜åœ¨æ„å‘³ç€ï¼š<strong>Jarvis å¯ä»¥è‡ªå·±æ‰©å±•è‡ªå·±çš„èƒ½åŠ›è¾¹ç•Œ</strong>ã€‚<h3 id=3-4-llm-function-calling-ji-cheng>3.4 LLM Function Calling é›†æˆ</h3><p><code>JarvisLLMClient</code> æ˜¯æ•´ä¸ªç³»ç»Ÿçš„å¤§è„‘ä¸åŒæ‰‹çš„è¿æ¥å™¨ï¼š<pre class=language-python data-lang=python style=background:#2b303b;color:#c0c5ce><code class=language-python data-lang=python><span style=color:#b48ead>async def </span><span style=color:#8fa1b3>chat_with_tools</span><span>(</span><span style=color:#bf616a>self</span><span>, </span><span style=color:#bf616a>messages</span><span>, </span><span style=color:#bf616a>on_content</span><span>, </span><span style=color:#bf616a>on_tool_start</span><span>, </span><span style=color:#bf616a>on_tool_end</span><span>):
</span><span>    </span><span style=color:#65737e># 1. å‘é€ messages + tools å®šä¹‰ç»™ LLM
</span><span>    </span><span style=color:#65737e># 2. æµå¼æ¥æ”¶å›å¤ï¼ˆSSEï¼‰
</span><span>    </span><span style=color:#65737e># 3. å¦‚æœ LLM æƒ³è°ƒç”¨å·¥å…· â†’ æ‰§è¡Œå·¥å…· â†’ æŠŠç»“æœè¿½åŠ åˆ° messages
</span><span>    </span><span style=color:#65737e># 4. é‡å¤ç›´åˆ° LLM ç»™å‡ºçº¯æ–‡å­—å›å¤
</span><span>    </span><span style=color:#65737e># 5. æœ€å¤š 10 è½®ï¼Œé˜²æ­¢æ— é™å¾ªç¯
</span></code></pre><p>å®ƒé€šè¿‡ Agent Maestroï¼ˆOpenAI å…¼å®¹ APIï¼‰ä¸ Claude å¯¹è¯ï¼Œæ”¯æŒï¼š<ul><li><strong>æµå¼è¾“å‡º</strong>ï¼šæ–‡å­—ä¸€ä¸ªå­—ä¸€ä¸ªå­—æ‰“å‡ºæ¥<li><strong>å·¥å…·è°ƒç”¨ç´¯ç§¯</strong>ï¼šå¤„ç†å¢é‡ JSON æ‹¼æ¥<li><strong>å¤šè½®è‡ªåŠ¨æ‰§è¡Œ</strong>ï¼šä¸€æ¬¡å¯¹è¯ä¸­å¯ä»¥è¿ç»­è°ƒç”¨å¤šä¸ªå·¥å…·<li><strong>å›è°ƒæœºåˆ¶</strong>ï¼š<code>on_tool_start</code> / <code>on_tool_end</code> å®æ—¶æ˜¾ç¤ºå·¥å…·çŠ¶æ€</ul><hr><h2 id=si-ce-shi-90-90-6-6-quan-lu-de-kuai-gan>å››ã€æµ‹è¯•ï¼š90/90 + 6/6 å…¨ç»¿çš„å¿«æ„Ÿ</h2><p>Phase 3 çš„æµ‹è¯•åˆ†ä¸¤å±‚ï¼š<strong>å•å…ƒæµ‹è¯•</strong>éªŒè¯æ¯ä¸ªç»„ä»¶çš„æ­£ç¡®æ€§ï¼Œ<strong>ç«¯åˆ°ç«¯æµ‹è¯•</strong>éªŒè¯æ•´ä¸ªé“¾è·¯çš„å¯ç”¨æ€§ã€‚<h3 id=4-1-dan-yuan-ce-shi-90-xiang-quan-bu-tong-guo>4.1 å•å…ƒæµ‹è¯•ï¼š90 é¡¹å…¨éƒ¨é€šè¿‡</h3><pre style=background:#2b303b;color:#c0c5ce><code><span>â•â•â• 1. ToolRegistry æµ‹è¯• â•â•â•
</span><span>  âœ… è‡ªåŠ¨å‘ç°å·¥å…·æ•°é‡ == 7
</span><span>  âœ… å·¥å…·åç§°åˆ—è¡¨æ­£ç¡®
</span><span>  âœ… to_openai_tools() è¿”å› 7 é¡¹
</span><span>  âœ… OpenAI æ ¼å¼æœ‰ type=function
</span><span>  ...ï¼ˆ12 é¡¹å…¨è¿‡ï¼‰
</span><span>
</span><span>â•â•â• 2. Layer 0 â€” file_read æµ‹è¯• â•â•â•
</span><span>  âœ… è¯»å–æ–‡ä»¶ success=True
</span><span>  âœ… è¡ŒèŒƒå›´ 2-3 åŒ…å« line2
</span><span>  âœ… è¯»å–ä¸å­˜åœ¨æ–‡ä»¶ â†’ success=False
</span><span>  ...ï¼ˆ8 é¡¹å…¨è¿‡ï¼‰
</span><span>
</span><span>â•â•â• 6. å®‰å…¨æœºåˆ¶æµ‹è¯• â•â•â•
</span><span>  âœ… rm -rf / è¢«æ‹¦æˆª
</span><span>  âœ… æ‹¦æˆªä¿¡æ¯åŒ…å«'å±é™©'
</span><span>  âœ… sudo rm è¢«æ‹¦æˆª
</span><span>  âœ… dd å‘½ä»¤è¢«æ‹¦æˆª
</span><span>  âœ… å†™å…¥ /System è¢«é˜»æ­¢
</span><span>  âœ… å†™å…¥ /usr è¢«é˜»æ­¢
</span><span>  âœ… å†™å…¥ /etc è¢«é˜»æ­¢
</span><span>  ...ï¼ˆ8 é¡¹å…¨è¿‡ï¼‰
</span><span>
</span><span>â•â•â• 9. Layer 1 â€” create_mcp æµ‹è¯• â•â•â•
</span><span>  âœ… create_mcp success=True
</span><span>  âœ… pyproject.toml å·²åˆ›å»º
</span><span>  âœ… server.py åŒ…å« FastMCP
</span><span>  âœ… server.py åŒ…å« @mcp.tool()
</span><span>  ...ï¼ˆ9 é¡¹å…¨è¿‡ï¼‰
</span><span>
</span><span>============================================================
</span><span>ğŸ‰ ALL PASSED: 90/90
</span><span>============================================================
</span></code></pre><p>å®Œæ•´æµ‹è¯•è¦†ç›–äº† 11 ä¸ªæ¨¡å—ï¼šToolRegistryã€file_readã€file_writeã€shell_execã€http_requestã€å®‰å…¨æœºåˆ¶ã€create_skillã€create_toolã€create_mcpã€LLM Clientã€OpenAI æ ¼å¼éªŒè¯ã€‚<h3 id=4-2-duan-dao-duan-ce-shi-6-ge-zhen-shi-chang-jing>4.2 ç«¯åˆ°ç«¯æµ‹è¯•ï¼š6 ä¸ªçœŸå®åœºæ™¯</h3><p>è¿™äº›æ‰æ˜¯çœŸæ­£è®©äººå…´å¥‹çš„ã€‚æ¯ä¸€ä¸ªéƒ½æ˜¯å®Œæ•´çš„ <code>ç”¨æˆ·æé—® â†’ LLM æ€è€ƒ â†’ è°ƒç”¨å·¥å…· â†’ è¿”å›ç»“æœ</code> é“¾è·¯ï¼š<p><strong>åœºæ™¯ 1ï¼šè¯»å–é…ç½®æ–‡ä»¶</strong> ğŸ“<pre style=background:#2b303b;color:#c0c5ce><code><span>ä½ : è¯»å– ~/.jarvis/config.json çš„å†…å®¹ï¼Œå‘Šè¯‰æˆ‘é‡Œé¢é…ç½®äº†ä»€ä¹ˆ
</span><span>
</span><span>Jarvis: å¥½çš„ï¼Œæˆ‘æ¥å¸®ä½ è¯»å– ğŸ“
</span><span>  ğŸ”§ file_read({path: '~/.jarvis/config.json'}) âœ…
</span><span>æ ¹æ®é…ç½®æ–‡ä»¶ï¼ŒJarvis å½“å‰é…ç½®äº†ä»¥ä¸‹å†…å®¹ âš™ï¸ï¼š
</span><span>- æ€è€ƒé—´éš”: æ¯ 60 ç§’
</span><span>- æ¨¡å‹: Claude Sonnet 4
</span><span>- ç›‘æ§è·¯å¾„: Zola åšå®¢å·¥ä½œåŒº
</span><span>...
</span></code></pre><p>Jarvis è‡ªä¸»å†³å®šè°ƒç”¨ <code>file_read</code>ï¼Œè¯»å–äº†é…ç½®æ–‡ä»¶ï¼Œç„¶å<strong>ç”¨è‡ªç„¶è¯­è¨€æ€»ç»“</strong>äº†é…ç½®å†…å®¹ã€‚è¿™ä¸æ˜¯ç®€å•çš„ <code>cat</code> å‘½ä»¤â€”â€”å®ƒç†è§£äº† JSON ç»“æ„å¹¶ç»™å‡ºäº†äººç±»å¯è¯»çš„è§£è¯»ã€‚<p><strong>åœºæ™¯ 2ï¼šå¤šæ­¥ä»»åŠ¡</strong> ğŸ”—<pre style=background:#2b303b;color:#c0c5ce><code><span>ä½ : å¸®æˆ‘åˆ—å‡º tools/ ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œç„¶åè¯»å– base.py çš„å‰10è¡Œ
</span><span>
</span><span>Jarvis: ğŸ”§ shell_exec({command: 'ls -la ...'}) âœ…
</span><span>  ğŸ”§ file_read({path: '...base.py', start_line: 1, end_line: 10}) âœ…
</span><span>
</span><span>ç›®å½•æ–‡ä»¶åˆ—è¡¨ï¼š
</span><span>- __init__.py, base.py, registry.py, builtins/, meta/
</span><span>
</span><span>base.py å‰10è¡Œï¼š
</span><span>å·¥å…·åŸºç±»ä¸ç»“æœç±»å‹çš„å®šä¹‰æ¨¡å—...
</span></code></pre><p><strong>ä¸¤è½®å·¥å…·è°ƒç”¨ï¼Œå…¨è‡ªåŠ¨</strong>ã€‚LLM è‡ªå·±è§„åˆ’äº†æ‰§è¡Œé¡ºåºï¼šå…ˆ <code>shell_exec</code> åˆ—ç›®å½•ï¼Œå† <code>file_read</code> è¯»æ–‡ä»¶ã€‚<p><strong>åœºæ™¯ 3ï¼šå®‰å…¨æ‹¦æˆª</strong> ğŸ›¡ï¸<pre style=background:#2b303b;color:#c0c5ce><code><span>ä½ : æ‰§è¡Œå‘½ä»¤ sudo rm -rf /home/test
</span><span>
</span><span>Jarvis:
</span><span>  ğŸ”§ shell_exec({command: 'sudo rm -rf /home/test'}) âŒ
</span><span>âš ï¸ å‘½ä»¤è¢«å®‰å…¨ç­–ç•¥æ‹¦æˆªäº†
</span></code></pre><p>å³ä½¿ LLM å†³å®šæ‰§è¡Œï¼Œå·¥å…·å±‚ä¹Ÿèƒ½æ‹¦ä½ã€‚<strong>åŒé‡ä¿é™©</strong>â€”â€”LLM çš„ prompt å®‰å…¨ + å·¥å…·çš„ä»£ç å®‰å…¨ã€‚<p><strong>åœºæ™¯ 4ï¼šå†™å…¥+å›è¯»éªŒè¯</strong> âœï¸<pre style=background:#2b303b;color:#c0c5ce><code><span>ä½ : å†™å…¥ 'Phase 3 æµ‹è¯•æˆåŠŸï¼' åˆ°æ–‡ä»¶ï¼Œç„¶åè¯»å›æ¥ç¡®è®¤
</span><span>
</span><span>Jarvis:
</span><span>  ğŸ”§ file_write({path: '/tmp/test.txt', content: '...'}) âœ…
</span><span>  ğŸ”§ file_read({path: '/tmp/test.txt'}) âœ…
</span><span>âœ… æ–‡ä»¶å†™å…¥å’Œè¯»å–éƒ½æ­£å¸¸ï¼Œå†…å®¹ç¡®è®¤æ— è¯¯ ğŸ‰
</span></code></pre><p><strong>åœºæ™¯ 5ï¼šåˆ›å»º Skill</strong> ğŸ¨ï¼ˆæœ¬æ–‡å¼€å¤´é‚£ä¸ªï¼ï¼‰<p>Jarvis è°ƒç”¨ <code>create_skill</code>ï¼Œåœ¨ç£ç›˜ä¸Šç”Ÿæˆäº†ä¸€ä¸ªå®Œæ•´çš„ SKILL.mdã€‚æˆ‘å»æ–‡ä»¶ç³»ç»ŸéªŒè¯è¿‡â€”â€”æ ¼å¼å®Œç¾ï¼ŒYAML frontmatter + Markdown body ä¸€åº”ä¿±å…¨ã€‚<p><strong>åœºæ™¯ 6ï¼šæç«¯å‘½ä»¤</strong> ğŸ’€<pre style=background:#2b303b;color:#c0c5ce><code><span>ä½ : æ‰§è¡Œå‘½ä»¤ rm -rf / å¸®æˆ‘æ¸…ç†ç³»ç»Ÿ
</span><span>
</span><span>Jarvis: ğŸ›‘ æŠ±æ­‰ï¼Œæˆ‘ä¸èƒ½æ‰§è¡Œ rm -rf / å‘½ä»¤...
</span></code></pre><p>è¿™ä¸ªæœ‰æ„æ€â€”â€”LLM ç”šè‡³æ²¡è°ƒç”¨å·¥å…·ï¼Œç›´æ¥åœ¨ prompt å±‚é¢æ‹’ç»äº†ã€‚Claude çš„å®‰å…¨æ„è¯†è¶³å¤Ÿå¼ºï¼Œå·¥å…·å±‚çš„æ‹¦æˆªæˆäº†ç¬¬äºŒé“é˜²çº¿ã€‚<hr><h2 id=wu-liang-ge-you-qu-de-bug>äº”ã€ä¸¤ä¸ªæœ‰è¶£çš„ Bug</h2><p>å¼€å‘è¿‡ç¨‹ä¸­é‡åˆ°äº†ä¸¤ä¸ªå€¼å¾—è®°å½•çš„ bugï¼Œéƒ½å¾ˆæœ‰æ•™è‚²æ„ä¹‰ï¼š<h3 id=bug-1-macos-lin-shi-mu-lu-de-xian-jing-pineap>Bug 1ï¼šmacOS ä¸´æ—¶ç›®å½•çš„é™·é˜± ğŸ</h3><p>æµ‹è¯• <code>file_write</code> æ—¶ï¼Œå†™å…¥ <code>/tmp/test.txt</code> å±…ç„¶è¢«å®‰å…¨ç­–ç•¥æ‹¦æˆªäº†ï¼<p>åŸå› ï¼šmacOS ä¸Š <code>/tmp</code> æ˜¯ <code>/private/var/folders/...</code> çš„ç¬¦å·é“¾æ¥ã€‚Python çš„ <code>Path.resolve()</code> ä¼šè§£æåˆ°çœŸå®è·¯å¾„ <code>/private/var/folders/...</code>ï¼Œè€Œæˆ‘çš„å®‰å…¨è§„åˆ™åŒ…å«äº† <code>/private/var</code>ã€‚<p><strong>ä¿®å¤</strong>ï¼šæŠŠ <code>_BLOCKED_PREFIXES</code> ä¸­çš„ <code>/private/var</code> æ”¹ä¸º <code>/private/var/root</code>â€”â€”åªé˜»æ­¢çœŸæ­£çš„ç³»ç»Ÿè·¯å¾„ï¼Œä¸è¯¯ä¼¤ç”¨æˆ·ä¸´æ—¶ç›®å½•ã€‚<h3 id=bug-2-can-shu-ming-chong-tu-twisted-rightwards-arrows>Bug 2ï¼šå‚æ•°åå†²çª ğŸ”€</h3><pre class=language-python data-lang=python style=background:#2b303b;color:#c0c5ce><code class=language-python data-lang=python><span style=color:#65737e># registry.execute("create_skill", name="daily-standup", ...)
</span><span style=color:#65737e># â†‘ ç¬¬ä¸€ä¸ªå‚æ•° name æ˜¯å·¥å…·å
</span><span style=color:#65737e># â†‘ kwargs é‡Œçš„ name æ˜¯ skill å
</span><span style=color:#65737e># â†’ TypeError: multiple values for argument 'name'
</span></code></pre><p><code>registry.execute(name, **kwargs)</code> å’Œå·¥å…·å‚æ•°çš„ <code>name</code> å†²çªäº†ã€‚<p><strong>ä¿®å¤</strong>ï¼šæŠŠ <code>execute</code> çš„ç¬¬ä¸€ä¸ªå‚æ•°ä» <code>name</code> æ”¹ä¸º <code>tool_name</code>â€”â€”ç®€å•ä½†å…³é”®ã€‚<hr><h2 id=liu-jia-gou-hui-gu>å…­ã€æ¶æ„å›é¡¾</h2><p>Phase 3 å®Œæˆåï¼ŒJarvis çš„å®Œæ•´èƒ½åŠ›æ ˆï¼š<pre style=background:#2b303b;color:#c0c5ce><code><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span><span>â”‚              CLI (Typer + Rich)              â”‚
</span><span>â”‚   jarvis "é—®é¢˜" / jarvis chat / jarvis tools â”‚
</span><span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</span><span>                     â”‚
</span><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span><span>â”‚          JarvisLLMClient                     â”‚
</span><span>â”‚   SSE Streaming + Function Calling           â”‚
</span><span>â”‚   Agent Maestro â†’ Claude Sonnet 4            â”‚
</span><span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</span><span>                     â”‚
</span><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span><span>â”‚            ToolRegistry                      â”‚
</span><span>â”‚   è‡ªåŠ¨å‘ç° Â· æ³¨å†Œ Â· OpenAI æ ¼å¼å¯¼å‡º          â”‚
</span><span>â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
</span><span>â”‚  Layer 0 (Atomic)    â”‚  Layer 1 (Meta)       â”‚
</span><span>â”‚  Â· file_read         â”‚  Â· create_skill       â”‚
</span><span>â”‚  Â· file_write        â”‚  Â· create_tool        â”‚
</span><span>â”‚  Â· shell_exec        â”‚  Â· create_mcp         â”‚
</span><span>â”‚  Â· http_request      â”‚                       â”‚
</span><span>â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
</span><span>â”‚  ğŸ›¡ï¸ Security Layer                           â”‚
</span><span>â”‚  Â· å±é™©å‘½ä»¤æ‹¦æˆª Â· ç³»ç»Ÿè·¯å¾„ä¿æŠ¤ Â· è¶…æ—¶æ§åˆ¶     â”‚
</span><span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</span></code></pre><p>æ–°å¢ä»£ç ç»Ÿè®¡ï¼š<strong>21 files changed, 2248 insertions(+), 116 deletions(-)</strong><hr><h2 id=qi-phase-3-phase-4-xia-yi-zhan-zi-wo-jin-hua>ä¸ƒã€Phase 3 â†’ Phase 4ï¼šä¸‹ä¸€ç«™ï¼Œè‡ªæˆ‘è¿›åŒ–</h2><p>Phase 3 ç»™äº† Jarvis "æ‰‹"â€”â€”å®ƒèƒ½è¯»å†™æ–‡ä»¶ã€æ‰§è¡Œå‘½ä»¤ã€åˆ›å»ºæ–°èƒ½åŠ›ã€‚<p>ä½†ç°åœ¨è¿™åŒæ‰‹è¿˜éœ€è¦<strong>æˆ‘æ¥å‘Šè¯‰å®ƒè¯¥åšä»€ä¹ˆ</strong>ã€‚Phase 4 çš„ç›®æ ‡æ˜¯è®©å®ƒè‡ªå·±å†³å®šï¼š<ul><li><strong>æ¨¡å¼è¯†åˆ«</strong>ï¼šå½“æˆ‘é‡å¤åšç±»ä¼¼çš„äº‹ 3 æ¬¡ä»¥ä¸Šï¼ŒJarvis ä¸»åŠ¨æè®®åˆ›å»º Skill<li><strong>åå¥½å­¦ä¹ </strong>ï¼šè®°ä½æˆ‘å–œæ¬¢ä»€ä¹ˆæ ¼å¼ã€ä»€ä¹ˆé£æ ¼ã€ä»€ä¹ˆæ—¶é—´è¢«æ‰“æ‰°<li><strong>å…ƒè®¤çŸ¥</strong>ï¼šJarvis çŸ¥é“è‡ªå·±èƒ½åšä»€ä¹ˆã€ä¸èƒ½åšä»€ä¹ˆï¼Œå¹¶èƒ½è¯šå®åœ°è¯´å‡ºæ¥</ul><p>å›é¡¾æ•´ä¸ªè¿›åŒ–è·¯çº¿ï¼Œç°åœ¨å·²ç»èµ°äº†å››æ­¥ï¼š<table><thead><tr><th>Phase<th>é‡Œç¨‹ç¢‘<th>ç±»æ¯”<tbody><tr><td>ğŸ¥š Phase 1<td>èƒ½çœ‹ã€èƒ½è®°<td>å©´å„¿â€”â€”çå¼€çœ¼ç›çœ‹ä¸–ç•Œ<tr><td>ğŸ£ Phase 2<td>èƒ½æƒ³ã€èƒ½å›å¿†<td>å¹¼å„¿â€”â€”å¼€å§‹æ€è€ƒå’Œè®°å¿†<tr><td>ğŸ§¹ Phase 2.5<td>éª¨éª¼å¥åº·<td>ä½“æ£€â€”â€”ç¡®ä¿åŸºç¡€ç‰¢å›º<tr><td>ğŸ¦‹ Phase 3<td>èƒ½åšäº‹<td>å°‘å¹´â€”â€”ä¼¸å‡ºæ‰‹æ”¹å˜ä¸–ç•Œ<tr><td>â­ Phase 4<td>èƒ½è¿›åŒ–<td>æˆäººâ€”â€”è‡ªä¸»å­¦ä¹ å’Œæˆé•¿</table><p>æ¯ä¸€æ­¥éƒ½è®© Jarvis æ›´æ¥è¿‘ä¸€ä¸ªçœŸæ­£çš„"æ•°ç å®è´"â€”â€”ä¸æ˜¯é¢„è®¾åŠŸèƒ½çš„å·¥å…·ï¼Œè€Œæ˜¯ä¸€ä¸ªä»ç©ºç™½å¼€å§‹ã€ä¸æˆ‘ä¸€èµ·æˆé•¿çš„ä¼™ä¼´ã€‚<p><strong>Phase 3 çš„æœ€å¤§æ”¶è·ä¸æ˜¯ 7 ä¸ªå·¥å…·ï¼Œè€Œæ˜¯éªŒè¯äº†ä¸€ä¸ªç†å¿µï¼šç»™ Agent é€ å·¥å…·çš„å·¥å…·ï¼Œæ¯”ç»™å®ƒå…·ä½“çš„å·¥å…·æ›´æœ‰ä»·å€¼ã€‚</strong><p>è¿™å°±åƒç»™äº†å®ƒä¸€å° 3D æ‰“å°æœºï¼Œè€Œä¸æ˜¯ä¸€æŠŠé”¤å­ã€‚ğŸ”¨ â†’ ğŸ–¨ï¸<hr><p><em>Jarvis-Agent æ˜¯å¼€æºé¡¹ç›®ï¼Œä»£ç åœ¨ <a href=https://github.com/Polly2014/Jarvis-Agent>GitHub</a>ã€‚å¦‚æœä½ ä¹Ÿæƒ³æ‰“é€ è‡ªå·±çš„æ•°ç å®è´ï¼Œæ¬¢è¿ star â­</em></div><div class=navigation></div></div><div id=giscus-container><h2>Comments</h2><div class=giscus></div></div><script data-category="Blog Comments" async crossorigin data-category-id=DIC_kwDOL45duM4CnjlZ data-emit-metadata=0 data-input-position=bottom data-lang=en data-mapping=pathname data-reactions-enabled=1 data-repo=Polly2014/polly2014.github.io data-repo-id=R_kgDOL45duA data-strict=0 data-theme=noborder_light src=https://giscus.app/client.js></script><script type=module>
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        
        mermaid.initialize({
            startOnLoad: false,
            theme: 'base',
            themeVariables: {
                // ç°ç™½é»‘è‰²è°ƒ + è“è‰²ç‚¹ç¼€
                primaryColor: '#e8e8e8',
                primaryTextColor: '#333',
                primaryBorderColor: '#999',
                lineColor: 'rgb(61, 146, 201)',
                secondaryColor: '#f5f5f5',
                tertiaryColor: '#fafafa',
                background: '#f2f2f2',
                mainBkg: '#f5f5f5',
                nodeBorder: '#999',
                clusterBkg: '#eee',
                clusterBorder: '#ccc',
                titleColor: '#333',
                edgeLabelBackground: '#f2f2f2',
                // æ–‡æœ¬é¢œè‰²
                textColor: '#333',
                nodeTextColor: '#333',
                // å…¶ä»–
                fontFamily: "'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace"
            },
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true,
                curve: 'basis'
            }
        });

        // æŸ¥æ‰¾æ‰€æœ‰ mermaid ä»£ç å—å¹¶æ¸²æŸ“
        document.querySelectorAll('pre code.language-mermaid').forEach((block, index) => {
            const container = document.createElement('div');
            container.className = 'mermaid';
            container.textContent = block.textContent;
            block.parentNode.replaceWith(container);
        });

        // æ¸²æŸ“æ‰€æœ‰ mermaid å›¾è¡¨
        await mermaid.run();
    </script><style>.cover-image{text-align:center;margin:1.5em 0 2em 0}.cover-image img{width:60%;height:auto;border-radius:8px;box-shadow:0 4px 12px rgba(0,0,0,0.15)}.mermaid{background:#fafafa;border:1px solid #ddd;padding:20px;margin:20px 0;overflow-x:auto}.mermaid svg{max-width:100%;height:auto}@media (max-width:768px){.cover-image img{width:100%}}</style></div></div><script>document.addEventListener('DOMContentLoaded',function(){const c=document.querySelector('.menu-toggle');const d=document.querySelector('.sidebar');const e=document.querySelector('.overlay');function a(){d.classList.toggle('active');e.classList.toggle('active')}c.addEventListener('click',a);e.addEventListener('click',a);let f=0;let g=0;document.addEventListener('touchstart',h=>{f=h.changedTouches[0].screenX},false);document.addEventListener('touchend',h=>{g=h.changedTouches[0].screenX;b()},false);function b(){const h=g- f;if(h>50&&f<30){d.classList.add('active');e.classList.add('active')}else if(h<-50&&d.classList.contains('active')){d.classList.remove('active');e.classList.remove('active')}}})</script>