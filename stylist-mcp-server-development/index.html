<!doctype html><html><head><title>ä»é›¶æ„å»ºAIæ—¶å°šé¡¾é—®ï¼šStylist MCP Serverå¼€å‘å…¨è®°å½•</title><meta content="æœ¬æ–‡è¯¦ç»†è®°å½•äº†æˆ‘å¦‚ä½•æ„å»ºä¸€ä¸ªAIé©±åŠ¨çš„æ—¶å°šæ¨èMCP Serverï¼Œä»ChromaDBå‘é‡ç´¢å¼•ã€å¤šæ¨¡å‹LLMæ”¯æŒã€Streamable HTTPè¿œç¨‹è®¿é—®ï¼Œåˆ°é…å¥—Skillå¼€å‘ï¼Œå®Œæ•´å‘ˆç°ä¸€ä¸ªç”Ÿäº§çº§MCPæœåŠ¡çš„å¼€å‘å†ç¨‹ã€‚" name=description><meta content="Polly, Blog, AI Blog, AI Assistant, Tutorials, Technology Blog, Baoli Wang" name=keywords><meta content="width=device-width,initial-scale=1" name=viewport><meta content="text/html; charset=utf-8" http-equiv=content-type><meta content=#333 name=theme-color><meta content=article property=og:type><meta content=https://polly.wang/stylist-mcp-server-development/ property=og:url><meta content="ä»é›¶æ„å»ºAIæ—¶å°šé¡¾é—®ï¼šStylist MCP Serverå¼€å‘å…¨è®°å½•" property=og:title><meta content="æœ¬æ–‡è¯¦ç»†è®°å½•äº†æˆ‘å¦‚ä½•æ„å»ºä¸€ä¸ªAIé©±åŠ¨çš„æ—¶å°šæ¨èMCP Serverï¼Œä»ChromaDBå‘é‡ç´¢å¼•ã€å¤šæ¨¡å‹LLMæ”¯æŒã€Streamable HTTPè¿œç¨‹è®¿é—®ï¼Œåˆ°é…å¥—Skillå¼€å‘ï¼Œå®Œæ•´å‘ˆç°ä¸€ä¸ªç”Ÿäº§çº§MCPæœåŠ¡çš„å¼€å‘å†ç¨‹ã€‚" property=og:description><meta content=https://polly.wang/stylist-mcp-server-development/cover.jpg property=og:image><meta content="Polly Blog" property=og:site_name><meta content=zh_CN property=og:locale><meta content=summary_large_image name=twitter:card><meta content=https://polly.wang/stylist-mcp-server-development/ name=twitter:url><meta content="ä»é›¶æ„å»ºAIæ—¶å°šé¡¾é—®ï¼šStylist MCP Serverå¼€å‘å…¨è®°å½•" name=twitter:title><meta content="æœ¬æ–‡è¯¦ç»†è®°å½•äº†æˆ‘å¦‚ä½•æ„å»ºä¸€ä¸ªAIé©±åŠ¨çš„æ—¶å°šæ¨èMCP Serverï¼Œä»ChromaDBå‘é‡ç´¢å¼•ã€å¤šæ¨¡å‹LLMæ”¯æŒã€Streamable HTTPè¿œç¨‹è®¿é—®ï¼Œåˆ°é…å¥—Skillå¼€å‘ï¼Œå®Œæ•´å‘ˆç°ä¸€ä¸ªç”Ÿäº§çº§MCPæœåŠ¡çš„å¼€å‘å†ç¨‹ã€‚" name=twitter:description><meta content=https://polly.wang/stylist-mcp-server-development/cover.jpg name=twitter:image><meta content=2026-01-31T00:00:00 property=article:published_time><meta content=Polly property=article:author><meta content=MCP property=article:tag><meta content="Model Context Protocol" property=article:tag><meta content=ChromaDB property=article:tag><meta content=å‘é‡æ•°æ®åº“ property=article:tag><meta content=æ—¶å°šAI property=article:tag><meta content=Claude property=article:tag><meta content=GPT-4o-mini property=article:tag><meta content="Streamable HTTP" property=article:tag><meta content=SSE property=article:tag><meta content=Skill property=article:tag><meta content=Python property=article:tag><link rel="shortcut icon" href=https://polly.wang/images/polly.ico type=image/x-icon><link href=https://polly.wang/images/polly.ico rel=icon type=image/x-icon><link href=https://polly.wang/images/polly.ico rel=apple-touch-icon><link href=https://cdn.jsdelivr.net/npm/purecss@3.0.0/build/pure-min.css rel=stylesheet><link href=https://cdn.jsdelivr.net/npm/purecss@3.0.0/build/grids-responsive-min.css rel=stylesheet><link href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css rel=stylesheet><link href=https://polly.wang/css/style_new.css rel=stylesheet><script src="https://www.googletagmanager.com/gtag/js?id=G-8JD13N7PHS" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-8JD13N7PHS';);</script><body><div class=menu-toggle><img alt=Menu src=https://polly.wang/images/polly.png></div><div class=overlay></div><div class="pure-g container"><div class="sidebar pure-u-1 pure-u-md-1-5"><div class=title><a class=pure-menu-heading href=https://polly.wang> <img class="avatar pure-img-responsive" src=https://polly.wang/images/polly.png> </a><div class=introduction><p>Polly's Blog</div><div class=nav><ul class=nav-links><li><a href=https://polly.wang><i class="fas fa-home"></i>Home</a><li><a href=https://polly.wang/archive><i class="fas fa-archive"></i>Archive</a><li><a href=https://polly.wang/category><i class="fas fa-folder"></i>Category</a><li><a href=https://polly.wang/blog><i class="fas fa-file-alt"></i>Posts</a><li><a href=https://polly.wang/cfp><i class="fas fa-calendar-alt"></i>CFP</a><li><a href=https://polly.wang/publication><i class="fas fa-file-pdf"></i>Research</a><li><a href=https://polly.wang/changelog><i class="fas fa-history"></i>Change Log</a><li><a href=https://polly.wang/about><i class="fas fa-info-circle"></i>About Me</a></ul></div><div class=social><ul class=social-links><li><a href=mailto:26716201@qq.com><i class="fas fa-envelope"></i></a><li><a href=https://twitter.com/Polly__007><i class="fab fa-twitter"></i></a><li><a href=https://www.linkedin.com/in/baoliwang><i class="fab fa-linkedin-in"></i></a><li><a href=https://github.com/Polly2014><i class="fab fa-github"></i></a></ul></div></div></div><div class="content pure-u-1 pure-u-md-4-5"><div class=blog-post><h1>ä»é›¶æ„å»ºAIæ—¶å°šé¡¾é—®ï¼šStylist MCP Serverå¼€å‘å…¨è®°å½•</h1><div class=cover-image><img alt="ä»é›¶æ„å»ºAIæ—¶å°šé¡¾é—®ï¼šStylist MCP Serverå¼€å‘å…¨è®°å½•" loading=lazy src=cover.jpg></div><div class=content><h2 id=yin-yan-dang-aiyu-jian-shi-shang>å¼•è¨€ï¼šå½“AIé‡è§æ—¶å°š</h2><p>"æ¨è3å¥—é€‚åˆçº¦ä¼šçš„ä¼˜é›…ç©¿æ­"â€”â€”è¿™æ ·ä¸€å¥ç®€å•çš„è‡ªç„¶è¯­è¨€è¯·æ±‚ï¼ŒèƒŒåéœ€è¦æ€æ ·çš„æŠ€æœ¯æ ˆæ¥å®ç°ï¼Ÿ<p>æœ€è¿‘æˆ‘å®Œæˆäº†ä¸€ä¸ªæœ‰è¶£çš„é¡¹ç›®ï¼š<strong>Stylist MCP Server</strong>ï¼Œä¸€ä¸ªAIé©±åŠ¨çš„æ—¶å°šæ¨èæœåŠ¡ã€‚å®ƒèƒ½ç†è§£ç”¨æˆ·çš„ç©¿æ­éœ€æ±‚ï¼ˆæ”¯æŒä¸­è‹±æ–‡ï¼‰ï¼Œä»53,789ä»¶æœè£…æ•°æ®åº“ä¸­æ™ºèƒ½æ£€ç´¢ï¼Œå¹¶ç»™å‡ºä¸“ä¸šçš„æ­é…å»ºè®®ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œå®ƒéµå¾ªAnthropicçš„Model Context Protocol (MCP)æ ‡å‡†ï¼Œå¯ä»¥æ— ç¼é›†æˆåˆ°Claude Desktopã€Cursorç­‰AIå·¥å…·ä¸­ã€‚<p>ä»Šå¤©ï¼Œæˆ‘æƒ³åˆ†äº«æ•´ä¸ªå¼€å‘è¿‡ç¨‹ä¸­çš„è®¾è®¡æ€è·¯ã€æŠ€æœ¯é€‰å‹å’Œè¸©å‘ç»éªŒã€‚</p><span id=continue-reading></span><h2 id=xiang-mu-jia-gou-zong-lan>é¡¹ç›®æ¶æ„æ€»è§ˆ</h2><p>åœ¨æ·±å…¥ç»†èŠ‚ä¹‹å‰ï¼Œå…ˆçœ‹çœ‹æ•´ä½“æ¶æ„ï¼š<pre style=background:#2b303b;color:#c0c5ce><code><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span><span>â”‚  Claude Desktop â”‚                              â”‚                 â”‚
</span><span>â”‚  / Cursor       â”‚â”€â”€â”¬â”€â”€ stdio â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
</span><span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                           â”‚                 â”‚
</span><span>                     â”œâ”€â”€ SSE (legacy) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚  MCP Server     â”‚â”€â”€â–¶ ChromaDB
</span><span>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚                           â”‚  (Starlette)    â”‚    (53,789 items)
</span><span>â”‚  VS Code        â”‚â”€â”€â”´â”€â”€ Streamable HTTP â­ â”€â”€â”€â”€â”€â”‚                 â”‚
</span><span>â”‚  + Skill        â”‚      (æ¨è)                  â”‚                 â”‚
</span><span>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</span><span>                                                          â”‚
</span><span>                                                 â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
</span><span>                                                 â”‚  LLM Client      â”‚
</span><span>                                                 â”‚  â”œâ”€ Anthropic    â”‚
</span><span>                                                 â”‚  â”œâ”€ Azure OpenAI â”‚
</span><span>                                                 â”‚  â””â”€ OpenAI       â”‚
</span><span>                                                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</span></code></pre><p>æ ¸å¿ƒç»„ä»¶åŒ…æ‹¬ï¼š<ul><li><strong>MCP Server</strong>: åŸºäºStarletteçš„å¼‚æ­¥HTTPæœåŠ¡ï¼Œæ”¯æŒä¸‰ç§ä¼ è¾“æ¨¡å¼ï¼ˆstdio/SSE/Streamable HTTPï¼‰<li><strong>ChromaDB</strong>: å‘é‡æ•°æ®åº“ï¼Œå­˜å‚¨æœè£…çš„è¯­ä¹‰åµŒå…¥å’Œå…ƒæ•°æ®<li><strong>LLM Client</strong>: ç»Ÿä¸€çš„å¤§æ¨¡å‹æ¥å£å±‚ï¼Œæ”¯æŒå¤šprovideråˆ‡æ¢<li><strong>Skill Layer</strong>: é…å¥—çš„å±•ç¤ºå±‚ï¼Œå°†MCPè¿”å›ç»“æœè½¬åŒ–ä¸ºç²¾ç¾çš„å¯è§†åŒ–æŠ¥å‘Š<li><strong>Nginx + Let's Encrypt</strong>: ç”Ÿäº§ç¯å¢ƒçš„HTTPSåå‘ä»£ç†</ul><h2 id=di-yi-bu-gou-jian-fu-zhuang-xiang-liang-suo-yin>ç¬¬ä¸€æ­¥ï¼šæ„å»ºæœè£…å‘é‡ç´¢å¼•</h2><h3 id=shu-ju-yuan-dresscodeshu-ju-ji>æ•°æ®æºï¼šDressCodeæ•°æ®é›†</h3><p>æˆ‘ä½¿ç”¨çš„æ˜¯DressCodeæ•°æ®é›†ï¼ŒåŒ…å«çº¦54,000å¼ é«˜è´¨é‡æœè£…å›¾ç‰‡ï¼Œåˆ†ä¸ºä¸‰ä¸ªç±»åˆ«ï¼š<ul><li><code>upper_body</code>: ä¸Šè£…ï¼ˆTæ¤ã€è¡¬è¡«ã€å¤–å¥—ç­‰ï¼‰<li><code>lower_body</code>: ä¸‹è£…ï¼ˆè£¤å­ã€è£™å­ã€çŸ­è£¤ç­‰ï¼‰<li><code>dresses</code>: è¿è¡£è£™</ul><p>æ¯ä»¶æœè£…éƒ½æœ‰è¯¦ç»†çš„å±æ€§æ ‡æ³¨ï¼ŒåŒ…æ‹¬é¢œè‰²ã€é£æ ¼ã€é€‚ç”¨åœºåˆã€å­£èŠ‚ç­‰ã€‚<h3 id=chromadbsuo-yin-gou-jian>ChromaDBç´¢å¼•æ„å»º</h3><p>ChromaDBçš„ä¼˜åŠ¿åœ¨äºå¼€ç®±å³ç”¨çš„å‘é‡æœç´¢èƒ½åŠ›ï¼ŒåŒæ—¶æ”¯æŒå…ƒæ•°æ®è¿‡æ»¤ã€‚æˆ‘çš„ç´¢å¼•ç­–ç•¥æ˜¯ï¼š<pre class=language-python data-lang=python style=background:#2b303b;color:#c0c5ce><code class=language-python data-lang=python><span style=color:#65737e># å°†æœè£…å±æ€§è½¬æ¢ä¸ºè‡ªç„¶è¯­è¨€æè¿°
</span><span style=color:#b48ead>def </span><span style=color:#8fa1b3>build_description</span><span>(</span><span style=color:#bf616a>attrs</span><span>: dict) -> str:
</span><span>    parts = []
</span><span>    </span><span style=color:#b48ead>if </span><span>attrs.</span><span style=color:#bf616a>get</span><span>("</span><span style=color:#a3be8c>colors</span><span>"):
</span><span>        parts.</span><span style=color:#bf616a>append</span><span>(</span><span style=color:#b48ead>f</span><span>"</span><span style=color:#a3be8c>Colors: </span><span>{'</span><span style=color:#a3be8c>, </span><span>'.</span><span style=color:#bf616a>join</span><span>(attrs['</span><span style=color:#a3be8c>colors</span><span>'])}")
</span><span>    </span><span style=color:#b48ead>if </span><span>attrs.</span><span style=color:#bf616a>get</span><span>("</span><span style=color:#a3be8c>styles</span><span>"):
</span><span>        parts.</span><span style=color:#bf616a>append</span><span>(</span><span style=color:#b48ead>f</span><span>"</span><span style=color:#a3be8c>Styles: </span><span>{'</span><span style=color:#a3be8c>, </span><span>'.</span><span style=color:#bf616a>join</span><span>(attrs['</span><span style=color:#a3be8c>styles</span><span>'])}")
</span><span>    </span><span style=color:#b48ead>if </span><span>attrs.</span><span style=color:#bf616a>get</span><span>("</span><span style=color:#a3be8c>occasions</span><span>"):
</span><span>        parts.</span><span style=color:#bf616a>append</span><span>(</span><span style=color:#b48ead>f</span><span>"</span><span style=color:#a3be8c>Occasions: </span><span>{'</span><span style=color:#a3be8c>, </span><span>'.</span><span style=color:#bf616a>join</span><span>(attrs['</span><span style=color:#a3be8c>occasions</span><span>'])}")
</span><span>    </span><span style=color:#65737e># ... æ›´å¤šå±æ€§
</span><span>    </span><span style=color:#b48ead>return </span><span>"</span><span style=color:#a3be8c> | </span><span>".</span><span style=color:#bf616a>join</span><span>(parts)
</span><span>
</span><span style=color:#65737e># æ·»åŠ åˆ°ChromaDB
</span><span>collection.</span><span style=color:#bf616a>add</span><span>(
</span><span>    </span><span style=color:#bf616a>ids</span><span>=[garment_id],
</span><span>    </span><span style=color:#bf616a>documents</span><span>=[description],  </span><span style=color:#65737e># ç”¨äºè¯­ä¹‰æœç´¢
</span><span>    </span><span style=color:#bf616a>metadatas</span><span>=[{
</span><span>        "</span><span style=color:#a3be8c>category</span><span>": "</span><span style=color:#a3be8c>upper_body</span><span>",
</span><span>        "</span><span style=color:#a3be8c>garment_type</span><span>": "</span><span style=color:#a3be8c>t-shirt</span><span>",
</span><span>        "</span><span style=color:#a3be8c>colors</span><span>": json.</span><span style=color:#bf616a>dumps</span><span>(["</span><span style=color:#a3be8c>white</span><span>", "</span><span style=color:#a3be8c>blue</span><span>"]),
</span><span>        </span><span style=color:#65737e># ... ç»“æ„åŒ–å…ƒæ•°æ®ç”¨äºè¿‡æ»¤
</span><span>    }]
</span><span>)
</span></code></pre><p>å…³é”®è®¾è®¡å†³ç­–ï¼š<ol><li><strong>æè¿°æ–‡æœ¬ç”¨äºè¯­ä¹‰æœç´¢</strong>ï¼šå°†å±æ€§æ‹¼æ¥æˆè‡ªç„¶è¯­è¨€ï¼Œè®©åµŒå…¥æ¨¡å‹ç†è§£è¯­ä¹‰<li><strong>å…ƒæ•°æ®ç”¨äºç²¾ç¡®è¿‡æ»¤</strong>ï¼šcategoryã€garment_typeç­‰å­—æ®µæ”¯æŒç²¾ç¡®åŒ¹é…<li><strong>æ··åˆæ£€ç´¢ç­–ç•¥</strong>ï¼šå…ˆç”¨å…ƒæ•°æ®ç¼©å°èŒƒå›´ï¼Œå†ç”¨å‘é‡ç›¸ä¼¼åº¦æ’åº</ol><p>æ„å»ºå®Œæˆåï¼Œ53,789ä»¶æœè£…è¢«ç´¢å¼•åˆ°ChromaDBï¼Œæ”¯æŒæ¯«ç§’çº§æ£€ç´¢ã€‚<h2 id=di-er-bu-llmyi-tu-jie-xi>ç¬¬äºŒæ­¥ï¼šLLMæ„å›¾è§£æ</h2><p>ç”¨æˆ·çš„è‡ªç„¶è¯­è¨€è¯·æ±‚éœ€è¦è¢«è§£æä¸ºç»“æ„åŒ–çš„æœç´¢å‚æ•°ã€‚è¿™æ˜¯æ•´ä¸ªç³»ç»Ÿçš„"å¤§è„‘"ã€‚<h3 id=promptgong-cheng-kua-mo-xing-jian-rong-xing>Promptå·¥ç¨‹ï¼šè·¨æ¨¡å‹å…¼å®¹æ€§</h3><p>æœ€åˆæˆ‘çš„promptæ˜¯è¿™æ ·çš„ï¼š<pre style=background:#2b303b;color:#c0c5ce><code><span>Extract the following parameters:
</span><span>
</span><span>1. LANGUAGE & MODE DETECTION:
</span><span>   - language: "zh" | "en"
</span><span>   - recommendation_mode: "single_item" | "full_outfit"
</span><span>   ...
</span><span>
</span><span>2. GARMENT FILTERS:
</span><span>   - garment_type: ...
</span><span>   ...
</span></code></pre><p>è¿™ä¸ªpromptåœ¨Claude Haikuä¸Šå·¥ä½œå®Œç¾ï¼Œä½†åˆ‡æ¢åˆ°GPT-4o-miniæ—¶å‡ºé—®é¢˜äº†â€”â€”GPTè¿”å›äº†<strong>åµŒå¥—çš„JSONç»“æ„</strong>ï¼Œå®Œå…¨æŒ‰ç…§promptä¸­çš„åˆ†ç±»æ ‡é¢˜ç»„ç»‡ï¼š<pre class=language-json data-lang=json style=background:#2b303b;color:#c0c5ce><code class=language-json data-lang=json><span>{
</span><span>  "</span><span style=color:#a3be8c>LANGUAGE & MODE DETECTION</span><span>": {
</span><span>    "</span><span style=color:#a3be8c>language</span><span>": "</span><span style=color:#a3be8c>en</span><span>",
</span><span>    "</span><span style=color:#a3be8c>recommendation_mode</span><span>": "</span><span style=color:#a3be8c>single_item</span><span>"
</span><span>  },
</span><span>  "</span><span style=color:#a3be8c>GARMENT FILTERS</span><span>": { </span><span style=background:#bf616a;color:#2b303b>...</span><span> }
</span><span>}
</span></code></pre><p>è€Œæˆ‘çš„ä»£ç æœŸæœ›çš„æ˜¯æ‰å¹³ç»“æ„ï¼š<code>intent.get("recommendation_mode")</code>ç›´æ¥è¿”å›Noneï¼<p><strong>æ•™è®­</strong>ï¼šä¸åŒLLMå¯¹promptçš„ç†è§£æ–¹å¼ä¸åŒã€‚GPTæ›´"å¿ å®"åœ°éµå¾ªæ ¼å¼ï¼ŒClaudeæ›´"èªæ˜"åœ°æ¨æ–­æ„å›¾ã€‚<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šé‡å†™promptï¼Œæ˜ç¡®è¦æ±‚æ‰å¹³JSONï¼š<pre style=background:#2b303b;color:#c0c5ce><code><span>Extract these parameters and return a FLAT JSON object (no nested objects):
</span><span>
</span><span>- language: "zh" | "en"
</span><span>- recommendation_mode: "single_item" | "full_outfit"
</span><span>- garment_type: one of ["dress", "t-shirt", ...] or null
</span><span>...
</span><span>
</span><span>IMPORTANT: Return ONLY a flat JSON object with all fields at the top level.
</span><span>Do NOT use nested structures or category headers.
</span></code></pre><p>ä¿®æ”¹åï¼Œä¸¤ä¸ªæ¨¡å‹éƒ½èƒ½æ­£ç¡®è¿”å›æ‰å¹³JSONï¼Œæµ‹è¯•å…¨éƒ¨é€šè¿‡ï¼ˆ14/14ï¼‰ã€‚<h2 id=di-san-bu-duo-mo-xing-llmzhi-chi>ç¬¬ä¸‰æ­¥ï¼šå¤šæ¨¡å‹LLMæ”¯æŒ</h2><p>ä¸ºäº†åŒæ—¶æ”¯æŒå¼€å‘ç¯å¢ƒï¼ˆæœ¬åœ°Agent Maestroä»£ç†Claudeï¼‰å’Œç”Ÿäº§ç¯å¢ƒï¼ˆAzure OpenAI GPT-4o-miniï¼‰ï¼Œæˆ‘è®¾è®¡äº†ä¸€ä¸ªç»Ÿä¸€çš„LLMæŠ½è±¡å±‚ï¼š<pre class=language-python data-lang=python style=background:#2b303b;color:#c0c5ce><code class=language-python data-lang=python><span style=color:#65737e># src/llm_client.py
</span><span style=color:#b48ead>from </span><span>abc </span><span style=color:#b48ead>import </span><span style=color:#bf616a>ABC</span><span>, abstractmethod
</span><span>
</span><span style=color:#b48ead>class </span><span style=color:#ebcb8b>LLMClient</span><span style=color:#eff1f5>(</span><span style=color:#a3be8c>ABC</span><span style=color:#eff1f5>):
</span><span>    @</span><span style=color:#bf616a>abstractmethod
</span><span>    </span><span style=color:#b48ead>def </span><span style=color:#8fa1b3>chat</span><span>(</span><span style=color:#bf616a>self</span><span>, </span><span style=color:#bf616a>messages</span><span>: list, </span><span style=color:#bf616a>max_tokens</span><span>: int, </span><span style=color:#bf616a>timeout</span><span>: int) -> str:
</span><span>        </span><span style=color:#b48ead>pass
</span><span>
</span><span style=color:#b48ead>class </span><span style=color:#ebcb8b>AnthropicClient</span><span style=color:#eff1f5>(</span><span style=color:#a3be8c>LLMClient</span><span style=color:#eff1f5>):
</span><span>    </span><span style=color:#65737e>"""æ”¯æŒAgent Maestroä»£ç†æˆ–ç›´æ¥Anthropic API"""
</span><span>    </span><span style=color:#b48ead>def </span><span style=color:#8fa1b3>chat</span><span>(</span><span style=color:#bf616a>self</span><span>, </span><span style=color:#bf616a>messages</span><span>, </span><span style=color:#bf616a>max_tokens</span><span>=</span><span style=color:#d08770>1024</span><span>, </span><span style=color:#bf616a>timeout</span><span>=</span><span style=color:#d08770>60</span><span>):
</span><span>        response = httpx.</span><span style=color:#bf616a>post</span><span>(
</span><span>            </span><span style=color:#bf616a>self</span><span>.endpoint,
</span><span>            </span><span style=color:#bf616a>json</span><span>={"</span><span style=color:#a3be8c>model</span><span>": </span><span style=color:#bf616a>self</span><span>.model, "</span><span style=color:#a3be8c>messages</span><span>": messages, "</span><span style=color:#a3be8c>max_tokens</span><span>": max_tokens},
</span><span>            </span><span style=color:#bf616a>timeout</span><span>=timeout
</span><span>        )
</span><span>        </span><span style=color:#b48ead>return </span><span>response.</span><span style=color:#bf616a>json</span><span>()["</span><span style=color:#a3be8c>content</span><span>"][</span><span style=color:#d08770>0</span><span>]["</span><span style=color:#a3be8c>text</span><span>"]
</span><span>
</span><span style=color:#b48ead>class </span><span style=color:#ebcb8b>AzureOpenAIClient</span><span style=color:#eff1f5>(</span><span style=color:#a3be8c>LLMClient</span><span style=color:#eff1f5>):
</span><span>    </span><span style=color:#65737e>"""Azure OpenAIæœåŠ¡"""
</span><span>    </span><span style=color:#b48ead>def </span><span style=color:#8fa1b3>chat</span><span>(</span><span style=color:#bf616a>self</span><span>, </span><span style=color:#bf616a>messages</span><span>, </span><span style=color:#bf616a>max_tokens</span><span>=</span><span style=color:#d08770>1024</span><span>, </span><span style=color:#bf616a>timeout</span><span>=</span><span style=color:#d08770>60</span><span>):
</span><span>        </span><span style=color:#65737e># è½¬æ¢æ¶ˆæ¯æ ¼å¼ï¼ˆAnthropic -> OpenAIï¼‰
</span><span>        openai_messages = </span><span style=color:#bf616a>self</span><span>.</span><span style=color:#bf616a>_convert_messages</span><span>(messages)
</span><span>        response = </span><span style=color:#bf616a>self</span><span>.client.chat.completions.</span><span style=color:#bf616a>create</span><span>(
</span><span>            </span><span style=color:#bf616a>model</span><span>=</span><span style=color:#bf616a>self</span><span>.deployment,
</span><span>            </span><span style=color:#bf616a>messages</span><span>=openai_messages,
</span><span>            </span><span style=color:#bf616a>max_tokens</span><span>=max_tokens
</span><span>        )
</span><span>        </span><span style=color:#b48ead>return </span><span>response.choices[</span><span style=color:#d08770>0</span><span>].message.content
</span><span>
</span><span style=color:#b48ead>def </span><span style=color:#8fa1b3>get_llm_client</span><span>() -> LLMClient:
</span><span>    </span><span style=color:#65737e>"""å·¥å‚å‡½æ•°ï¼Œæ ¹æ®ç¯å¢ƒå˜é‡é€‰æ‹©provider"""
</span><span>    provider = os.</span><span style=color:#bf616a>getenv</span><span>("</span><span style=color:#a3be8c>LLM_PROVIDER</span><span>", "</span><span style=color:#a3be8c>anthropic</span><span>")
</span><span>    </span><span style=color:#b48ead>if </span><span>provider == "</span><span style=color:#a3be8c>azure_openai</span><span>":
</span><span>        </span><span style=color:#b48ead>return </span><span style=color:#bf616a>AzureOpenAIClient</span><span>()
</span><span>    </span><span style=color:#b48ead>elif </span><span>provider == "</span><span style=color:#a3be8c>openai</span><span>":
</span><span>        </span><span style=color:#b48ead>return </span><span style=color:#bf616a>OpenAIClient</span><span>()
</span><span>    </span><span style=color:#b48ead>else</span><span>:
</span><span>        </span><span style=color:#b48ead>return </span><span style=color:#bf616a>AnthropicClient</span><span>()
</span></code></pre><p>é…ç½®åˆ‡æ¢åªéœ€ä¿®æ”¹ç¯å¢ƒå˜é‡ï¼š<pre class=language-bash data-lang=bash style=background:#2b303b;color:#c0c5ce><code class=language-bash data-lang=bash><span style=color:#65737e># å¼€å‘æ¨¡å¼ï¼ˆAgent Maestroä»£ç†Claudeï¼‰
</span><span style=color:#bf616a>LLM_PROVIDER</span><span>=</span><span style=color:#a3be8c>anthropic
</span><span style=color:#bf616a>LLM_API_ENDPOINT</span><span>=</span><span style=color:#a3be8c>http://localhost:23333/api/anthropic/v1/messages
</span><span>
</span><span style=color:#65737e># ç”Ÿäº§æ¨¡å¼ï¼ˆAzure OpenAIï¼‰
</span><span style=color:#bf616a>LLM_PROVIDER</span><span>=</span><span style=color:#a3be8c>azure_openai
</span><span style=color:#bf616a>AZURE_OPENAI_ENDPOINT</span><span>=</span><span style=color:#a3be8c>https://xxx.openai.azure.com
</span><span style=color:#bf616a>AZURE_OPENAI_DEPLOYMENT</span><span>=</span><span style=color:#a3be8c>gpt-4o-mini
</span></code></pre><p>æ€§èƒ½å¯¹æ¯”ï¼š<table><thead><tr><th>æ¨¡å‹<th>å®Œæ•´ç©¿æ­æ¨èè€—æ—¶<th>æµ‹è¯•é€šè¿‡ç‡<tbody><tr><td>Claude Haiku<td>~22ç§’<td>14/14<tr><td>GPT-4o-mini<td>~9ç§’<td>14/14</table><p>GPT-4o-miniåœ¨å“åº”é€Ÿåº¦ä¸Šæ˜æ˜¾æ›´å¿«ï¼Œéå¸¸é€‚åˆç”Ÿäº§ç¯å¢ƒã€‚<h2 id=di-si-bu-duo-chuan-shu-mo-shi-yu-yuan-cheng-fang-wen>ç¬¬å››æ­¥ï¼šå¤šä¼ è¾“æ¨¡å¼ä¸è¿œç¨‹è®¿é—®</h2><p>MCPåè®®æ”¯æŒä¸‰ç§ä¼ è¾“æ¨¡å¼ï¼š<ul><li><strong>stdio</strong>: æœ¬åœ°è¿›ç¨‹é€šä¿¡ï¼Œé€‚åˆClaude Desktopç›´æ¥é›†æˆ<li><strong>SSE (Server-Sent Events)</strong>: HTTPé•¿è¿æ¥ï¼Œä¼ ç»Ÿè¿œç¨‹è®¿é—®æ–¹å¼<li><strong>Streamable HTTP</strong> â­: æœ€æ–°æ¨èçš„è¿œç¨‹è®¿é—®æ–¹å¼ï¼Œé…ç½®æ›´ç®€æ´</ul><p>å¯¹äºè·¨æœºå™¨è®¿é—®ï¼ˆæ¯”å¦‚ä»æˆ‘çš„MacBookè¿æ¥åˆ°Azure VMä¸Šçš„æœåŠ¡ï¼‰ï¼Œè¿œç¨‹ä¼ è¾“æ¨¡å¼æ˜¯å¿…é¡»çš„ã€‚<h3 id=streamable-http-geng-jian-ji-de-yuan-cheng-fang-wen-tui-jian>Streamable HTTPï¼šæ›´ç®€æ´çš„è¿œç¨‹è®¿é—®ï¼ˆæ¨èï¼‰</h3><p>Streamable HTTP æ˜¯ MCP åè®®çš„æœ€æ–°ä¼ è¾“æ–¹å¼ï¼Œç›¸æ¯” SSE æœ‰æ˜æ˜¾ä¼˜åŠ¿ï¼š<table><thead><tr><th>ç‰¹æ€§<th>SSE<th>Streamable HTTP<tbody><tr><td>é…ç½®å¤æ‚åº¦<td>éœ€è¦ mcp-remote ä¸­è½¬<td>ç›´æ¥ URL è¿æ¥<tr><td>å®¢æˆ·ç«¯æ”¯æŒ<td>éœ€è¦ npx å‘½ä»¤<td>åŸç”Ÿæ”¯æŒ<tr><td>é…ç½®è¡Œæ•°<td>6-8 è¡Œ<td>3-4 è¡Œ</table><p><strong>Streamable HTTP å®¢æˆ·ç«¯é…ç½®</strong>ï¼ˆä»¥ VS Code/Cursor ä¸ºä¾‹ï¼‰ï¼š<pre class=language-json data-lang=json style=background:#2b303b;color:#c0c5ce><code class=language-json data-lang=json><span>{
</span><span>  "</span><span style=color:#a3be8c>mcpServers</span><span>": {
</span><span>    "</span><span style=color:#a3be8c>stylist-recommender</span><span>": {
</span><span>      "</span><span style=color:#a3be8c>url</span><span>": "</span><span style=color:#a3be8c>https://stylist.polly.wang/mcp</span><span>",
</span><span>      "</span><span style=color:#a3be8c>headers</span><span>": {
</span><span>        "</span><span style=color:#a3be8c>X-API-Key</span><span>": "</span><span style=color:#a3be8c>YOUR_API_KEY</span><span>"
</span><span>      }
</span><span>    }
</span><span>  }
</span><span>}
</span></code></pre><p>å°±è¿™ä¹ˆç®€å•ï¼ä¸éœ€è¦ <code>npx</code>ï¼Œä¸éœ€è¦ <code>mcp-remote</code>ï¼Œç›´æ¥å¡« URL å’Œè®¤è¯ä¿¡æ¯å³å¯ã€‚<p><strong>å¯¹æ¯”ä¼ ç»Ÿ SSE é…ç½®</strong>ï¼š<pre class=language-json data-lang=json style=background:#2b303b;color:#c0c5ce><code class=language-json data-lang=json><span>{
</span><span>  "</span><span style=color:#a3be8c>mcpServers</span><span>": {
</span><span>    "</span><span style=color:#a3be8c>stylist-remote</span><span>": {
</span><span>      "</span><span style=color:#a3be8c>command</span><span>": "</span><span style=color:#a3be8c>npx</span><span>",
</span><span>      "</span><span style=color:#a3be8c>args</span><span>": [
</span><span>        "</span><span style=color:#a3be8c>-y</span><span>", "</span><span style=color:#a3be8c>mcp-remote</span><span>",
</span><span>        "</span><span style=color:#a3be8c>https://stylist.polly.wang/sse?apiKey=YOUR_API_KEY</span><span>",
</span><span>        "</span><span style=color:#a3be8c>--transport</span><span>", "</span><span style=color:#a3be8c>sse-only</span><span>"
</span><span>      ]
</span><span>    }
</span><span>  }
</span><span>}
</span></code></pre><p>æ˜¾ç„¶ Streamable HTTP æ›´åŠ ä¼˜é›…ã€‚<h3 id=sse-mo-shi-jian-rong-jiu-ke-hu-duan>SSE æ¨¡å¼ï¼ˆå…¼å®¹æ—§å®¢æˆ·ç«¯ï¼‰</h3><p>å¯¹äºè·¨æœºå™¨è®¿é—®ï¼ˆæ¯”å¦‚ä»æˆ‘çš„MacBookè¿æ¥åˆ°Azure VMä¸Šçš„æœåŠ¡ï¼‰ï¼ŒSSEæ˜¯å¿…é¡»çš„ã€‚<h3 id=starletteyi-bu-fu-wu-qi>Starletteå¼‚æ­¥æœåŠ¡å™¨</h3><pre class=language-python data-lang=python style=background:#2b303b;color:#c0c5ce><code class=language-python data-lang=python><span style=color:#b48ead>from </span><span>starlette.applications </span><span style=color:#b48ead>import </span><span>Starlette
</span><span style=color:#b48ead>from </span><span>starlette.routing </span><span style=color:#b48ead>import </span><span>Route, Mount
</span><span style=color:#b48ead>from </span><span>mcp.server.sse </span><span style=color:#b48ead>import </span><span>SseServerTransport
</span><span>
</span><span>app = </span><span style=color:#bf616a>Starlette</span><span>(
</span><span>    </span><span style=color:#bf616a>routes</span><span>=[
</span><span>        </span><span style=color:#bf616a>Route</span><span>("</span><span style=color:#a3be8c>/health</span><span>", health_check),
</span><span>        </span><span style=color:#bf616a>Route</span><span>("</span><span style=color:#a3be8c>/sse</span><span>", sse_handler),
</span><span>        </span><span style=color:#bf616a>Route</span><span>("</span><span style=color:#a3be8c>/messages/</span><span>", message_handler, </span><span style=color:#bf616a>methods</span><span>=["</span><span style=color:#a3be8c>POST</span><span>"]),
</span><span>        </span><span style=color:#bf616a>Mount</span><span>("</span><span style=color:#a3be8c>/images</span><span>", </span><span style=color:#bf616a>StaticFiles</span><span>(</span><span style=color:#bf616a>directory</span><span>=</span><span style=color:#bf616a>DRESSCODE_ROOT</span><span>)),
</span><span>    ],
</span><span>    </span><span style=color:#bf616a>middleware</span><span>=[</span><span style=color:#bf616a>Middleware</span><span>(APIKeyMiddleware)]
</span><span>)
</span></code></pre><h3 id=api-keyren-zheng>API Keyè®¤è¯</h3><p>ä¸ºäº†å®‰å…¨æ€§ï¼Œæˆ‘å®ç°äº†API Keyè®¤è¯ä¸­é—´ä»¶ï¼š<pre class=language-python data-lang=python style=background:#2b303b;color:#c0c5ce><code class=language-python data-lang=python><span style=color:#b48ead>class </span><span style=color:#ebcb8b>APIKeyMiddleware</span><span style=color:#eff1f5>:
</span><span>    </span><span style=color:#bf616a>PUBLIC_PATHS </span><span>= {"</span><span style=color:#a3be8c>/health</span><span>", "</span><span style=color:#a3be8c>/favicon.ico</span><span>"}
</span><span>    </span><span style=color:#bf616a>PUBLIC_PREFIXES </span><span>= ("</span><span style=color:#a3be8c>/images/</span><span>",)  </span><span style=color:#65737e># å›¾ç‰‡ä¸éœ€è¦è®¤è¯
</span><span>    
</span><span>    </span><span style=color:#b48ead>async def </span><span style=color:#96b5b4>__call__</span><span>(</span><span style=color:#bf616a>self</span><span>, </span><span style=color:#bf616a>scope</span><span>, </span><span style=color:#bf616a>receive</span><span>, </span><span style=color:#bf616a>send</span><span>):
</span><span>        </span><span style=color:#b48ead>if </span><span style=color:#bf616a>self</span><span>.</span><span style=color:#bf616a>_is_public_path</span><span>(scope["</span><span style=color:#a3be8c>path</span><span>"]):
</span><span>            </span><span style=color:#b48ead>return await </span><span style=color:#bf616a>self</span><span>.</span><span style=color:#bf616a>app</span><span>(scope, receive, send)
</span><span>        
</span><span>        api_key = </span><span style=color:#bf616a>self</span><span>.</span><span style=color:#bf616a>_extract_api_key</span><span>(scope)
</span><span>        </span><span style=color:#b48ead>if </span><span>api_key != </span><span style=color:#bf616a>self</span><span>.expected_key:
</span><span>            response = </span><span style=color:#bf616a>Response</span><span>("</span><span style=color:#a3be8c>Unauthorized</span><span>", </span><span style=color:#bf616a>status_code</span><span>=</span><span style=color:#d08770>401</span><span>)
</span><span>            </span><span style=color:#b48ead>return await </span><span style=color:#bf616a>response</span><span>(scope, receive, send)
</span><span>        
</span><span>        </span><span style=color:#b48ead>await </span><span style=color:#bf616a>self</span><span>.</span><span style=color:#bf616a>app</span><span>(scope, receive, send)
</span></code></pre><p>æ”¯æŒä¸‰ç§è®¤è¯æ–¹å¼ï¼š<ul><li>Queryå‚æ•°ï¼š<code>?apiKey=xxx</code><li>Headerï¼š<code>X-API-Key: xxx</code><li>Bearer Tokenï¼š<code>Authorization: Bearer xxx</code></ul><h3 id=nginx-let-s-encrypt>Nginx + Let's Encrypt</h3><p>ç”Ÿäº§ç¯å¢ƒä½¿ç”¨Nginxä½œä¸ºåå‘ä»£ç†ï¼ŒLet's Encryptæä¾›å…è´¹SSLè¯ä¹¦ï¼š<pre class=language-nginx data-lang=nginx style=background:#2b303b;color:#c0c5ce><code class=language-nginx data-lang=nginx><span>server {
</span><span>    listen 443 ssl;
</span><span>    server_name stylist.polly.wang;
</span><span>    
</span><span>    ssl_certificate /etc/letsencrypt/live/stylist.polly.wang/fullchain.pem;
</span><span>    ssl_certificate_key /etc/letsencrypt/live/stylist.polly.wang/privkey.pem;
</span><span>    
</span><span>    location / {
</span><span>        proxy_pass http://127.0.0.1:8888;
</span><span>        proxy_http_version 1.1;
</span><span>        proxy_set_header Upgrade $http_upgrade;
</span><span>        proxy_set_header Connection "upgrade";
</span><span>        proxy_buffering off;  # SSEå¿…é¡»ç¦ç”¨ç¼“å†²
</span><span>        proxy_read_timeout 86400;  # é•¿è¿æ¥è¶…æ—¶
</span><span>    }
</span><span>}
</span></code></pre><p>å…³é”®é…ç½®ï¼š<ul><li><code>proxy_buffering off</code>: SSEå¿…é¡»ç¦ç”¨å“åº”ç¼“å†²<li><code>proxy_read_timeout 86400</code>: ä¿æŒé•¿è¿æ¥24å°æ—¶</ul><h2 id=di-wu-bu-fu-zhuang-tu-pian-zhi-jie-fang-wen>ç¬¬äº”æ­¥ï¼šæœè£…å›¾ç‰‡ç›´æ¥è®¿é—®</h2><p>MCPåè®®çš„ä¸€ä¸ªé™åˆ¶æ˜¯ä¸æ”¯æŒç›´æ¥ä¼ è¾“äºŒè¿›åˆ¶æ•°æ®ã€‚æœ€åˆæˆ‘è®¾è®¡äº†ä¸€ä¸ª<code>get_garment_image</code>å·¥å…·è¿”å›base64ç¼–ç çš„å›¾ç‰‡ï¼Œä½†è¿™æ—¢ä½æ•ˆåˆä¸ä¼˜é›…ã€‚<p><strong>æ›´å¥½çš„æ–¹æ¡ˆ</strong>ï¼šç›´æ¥åœ¨æ¨èç»“æœä¸­è¿”å›å›¾ç‰‡URLã€‚<pre class=language-python data-lang=python style=background:#2b303b;color:#c0c5ce><code class=language-python data-lang=python><span style=color:#b48ead>def </span><span style=color:#8fa1b3>_format_garment</span><span>(</span><span style=color:#bf616a>self</span><span>, </span><span style=color:#bf616a>garment</span><span>, </span><span style=color:#bf616a>include_image_url</span><span>=</span><span style=color:#d08770>True</span><span>):
</span><span>    result = {
</span><span>        "</span><span style=color:#a3be8c>garment_id</span><span>": garment["</span><span style=color:#a3be8c>garment_id</span><span>"],
</span><span>        "</span><span style=color:#a3be8c>category</span><span>": garment["</span><span style=color:#a3be8c>category</span><span>"],
</span><span>        "</span><span style=color:#a3be8c>description</span><span>": garment["</span><span style=color:#a3be8c>description</span><span>"],
</span><span>        </span><span style=color:#65737e># ...
</span><span>    }
</span><span>    </span><span style=color:#b48ead>if </span><span>include_image_url:
</span><span>        </span><span style=color:#65737e># ç”ŸæˆHTTPSå›¾ç‰‡URL
</span><span>        result["</span><span style=color:#a3be8c>image_url</span><span>"] = </span><span style=color:#b48ead>f</span><span>"</span><span style=color:#a3be8c>https://</span><span>{</span><span style=color:#bf616a>MCP_EXTERNAL_HOST</span><span>}</span><span style=color:#a3be8c>/images/</span><span>{category}</span><span style=color:#a3be8c>/images/</span><span>{garment_id}</span><span style=color:#a3be8c>_1.jpg</span><span>"
</span><span>    </span><span style=color:#b48ead>return </span><span>result
</span></code></pre><p>è¿™æ ·å®¢æˆ·ç«¯å¯ä»¥ç›´æ¥åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€å›¾ç‰‡é“¾æ¥ï¼Œæ— éœ€é¢å¤–çš„APIè°ƒç”¨ã€‚<h2 id=ce-shi-tao-jian>æµ‹è¯•å¥—ä»¶</h2><p>ä¸ºäº†ç¡®ä¿ç³»ç»Ÿç¨³å®šæ€§ï¼Œæˆ‘ç¼–å†™äº†ä¸€ä¸ªç»¼åˆæµ‹è¯•è„šæœ¬ï¼ˆ14ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼‰ï¼š<pre class=language-bash data-lang=bash style=background:#2b303b;color:#c0c5ce><code class=language-bash data-lang=bash><span style=color:#bf616a>python</span><span> scripts/test_mcp.py
</span></code></pre><p>æµ‹è¯•è¦†ç›–ï¼š<ul><li>ğŸ“¦ <strong>æ•°æ®åº“æµ‹è¯•</strong>: åŸºæœ¬æœç´¢ã€è¿‡æ»¤å™¨ã€å¤šç±»åˆ«<li>ğŸ‘• <strong>å•å“æ¨¡å¼</strong>: Tæ¤ã€è¿è¡£è£™ã€ä¸­æ–‡æŸ¥è¯¢<li>ğŸ‘” <strong>å…¨å¥—ç©¿æ­</strong>: åŸºç¡€ã€æ­£å¼åœºåˆã€ä¸­æ–‡ã€ç”·è£…ï¼ˆæ— è¿è¡£è£™ï¼‰<li>ğŸ§  <strong>LLMæ¨ç†</strong>: è¯„åˆ†ã€ç†ç”±ã€æ­é…å»ºè®®<li>ğŸŒ <strong>è¿œç¨‹æœåŠ¡</strong>: Healthç«¯ç‚¹ã€Toolsç«¯ç‚¹ã€å›¾ç‰‡è®¿é—®</ul><p>è¾“å‡ºç¤ºä¾‹ï¼š<pre style=background:#2b303b;color:#c0c5ce><code><span>======================================================================
</span><span>  Test Summary
</span><span>======================================================================
</span><span>  âœ… GarmentDatabase Basic (53789 garments)
</span><span>  âœ… GarmentDatabase Filters (All filters work)
</span><span>  âœ… Single Item: T-shirt (5 results)
</span><span>  âœ… Single Item: Dress (5 results, category=dresses)
</span><span>  âœ… Full Outfit: Basic (3 outfits)
</span><span>  âœ… Full Outfit with Reasoning (3 outfits, 8.7s)
</span><span>  ...
</span><span>  ==============================
</span><span>  14/14 tests passed
</span><span>  ğŸ‰ All tests passed!
</span></code></pre><h2 id=di-liu-bu-skill-kai-fa-rang-zhan-shi-geng-you-ya>ç¬¬å…­æ­¥ï¼šSkill å¼€å‘â€”â€”è®©å±•ç¤ºæ›´ä¼˜é›…</h2><p>MCP Server è¿”å›çš„æ˜¯ç»“æ„åŒ– JSON æ•°æ®ï¼Œè™½ç„¶ä¿¡æ¯å®Œæ•´ï¼Œä½†ç›´æ¥å±•ç¤ºç»™ç”¨æˆ·å¹¶ä¸å‹å¥½ã€‚äºæ˜¯æˆ‘å¼€å‘äº†é…å¥—çš„ <strong>stylist-presenter</strong> Skillï¼Œå°†æ¨èç»“æœè½¬åŒ–ä¸ºç²¾ç¾çš„å¯è§†åŒ–æŠ¥å‘Šã€‚<h3 id=mcp-skill-xie-zuo-mo-shi>MCP + Skill åä½œæ¨¡å¼</h3><pre style=background:#2b303b;color:#c0c5ce><code><span>ç”¨æˆ·è¯·æ±‚ â†’ Skill è§¦å‘ â†’ è°ƒç”¨ MCP Tool â†’ è§£æç»“æœ â†’ ç”Ÿæˆ HTML æŠ¥å‘Š â†’ æµè§ˆå™¨é¢„è§ˆ
</span></code></pre><p>Skill çš„æ ¸å¿ƒä»·å€¼ï¼š<ol><li><strong>è‡ªåŠ¨è§¦å‘</strong>ï¼šè¯†åˆ«ã€Œç©¿æ­æ¨èã€ã€Œçº¦ä¼šç©¿ä»€ä¹ˆã€ç­‰å…³é”®è¯<li><strong>æ ¼å¼è½¬æ¢</strong>ï¼šå°† JSON è½¬ä¸ºç¾è§‚çš„ HTML é¡µé¢<li><strong>æ–‡ä»¶è¾“å‡º</strong>ï¼šç”Ÿæˆç‹¬ç«‹çš„æŠ¥å‘Šæ–‡ä»¶ï¼Œå¯ä¿å­˜åˆ†äº«</ol><h3 id=html-bao-gao-she-ji>HTML æŠ¥å‘Šè®¾è®¡</h3><p>æˆ‘è®¾è®¡äº†ä¸€å¥—é»‘é‡‘é…è‰²çš„è§†è§‰é£æ ¼ï¼š<pre class=language-css data-lang=css style=background:#2b303b;color:#c0c5ce><code class=language-css data-lang=css><span style=color:#65737e>/* æ ¸å¿ƒé…è‰² */
</span><span>--</span><span style=color:#bf616a>header-bg</span><span style=color:#b48ead>: #1a1a1a;      </span><span style=color:#65737e>/* é»‘è‰²èƒŒæ™¯ */
</span><span>--</span><span style=color:#bf616a>accent-color</span><span style=color:#b48ead>: </span><span style=color:#8fa1b3>#c9a86c</span><span style=color:#b48ead>;   </span><span style=color:#65737e>/* é‡‘è‰²å¼ºè°ƒ */
</span><span>--</span><span style=color:#bf616a>card-bg</span><span style=color:#b48ead>: </span><span style=color:#8fa1b3>#ffffff</span><span style=color:#b48ead>;        </span><span style=color:#65737e>/* ç™½è‰²å¡ç‰‡ */
</span><span>--</span><span style=color:#bf616a>advice-bg</span><span style=color:#b48ead>: </span><span style=color:#8fa1b3>#fff3cd</span><span style=color:#b48ead>;      </span><span style=color:#65737e>/* é»„è‰²å»ºè®®åŒº */
</span></code></pre><p>æŠ¥å‘ŠåŒ…å«ï¼š<ul><li><strong>æ¨èå¡ç‰‡</strong>ï¼šç¼–å·ã€æ ‡é¢˜ã€æ¨èåº¦è¯„åˆ†<li><strong>æ ‡ç­¾ç³»ç»Ÿ</strong>ï¼šé£æ ¼ã€åœºåˆã€é¢œè‰²ç­‰ hover äº¤äº’<li><strong>å›¾ç‰‡ç½‘æ ¼</strong>ï¼šæ‚¬åœæ”¾å¤§æ•ˆæœ<li><strong>é€ å‹å¸ˆå»ºè®®</strong>ï¼šé»„è‰²é«˜äº®åŒºå—<li><strong>åç»­æ¨è</strong>ï¼šå¼•å¯¼ç”¨æˆ·ç»§ç»­æ¢ç´¢</ul><h3 id=skill-wen-jian-jie-gou>Skill æ–‡ä»¶ç»“æ„</h3><pre style=background:#2b303b;color:#c0c5ce><code><span>stylist-presenter/
</span><span>â”œâ”€â”€ SKILL.md                    # ä¸»æŒ‡ä»¤æ–‡ä»¶
</span><span>â””â”€â”€ references/
</span><span>    â””â”€â”€ html-template.html      # å®Œæ•´ HTML æ¨¡æ¿
</span></code></pre><p>é€šè¿‡è¿™ç§ MCP + Skill çš„ç»„åˆï¼Œç”¨æˆ·åªéœ€è¯´ã€Œæ¨èçº¦ä¼šç©¿æ­ã€ï¼Œå°±èƒ½å¾—åˆ°ä¸€ä»½ç²¾ç¾çš„å¯è§†åŒ–æŠ¥å‘Šï¼Œè€Œä¸æ˜¯å†·å†°å†°çš„ JSONã€‚<p><img alt="Stylist Presenter ç”Ÿæˆçš„ HTML æŠ¥å‘Š" src=https://polly.wang/stylist-mcp-server-development/Stylist-Recommender.png><h2 id=cheng-guo-zhan-shi>æˆæœå±•ç¤º</h2><p>æœ€ç»ˆçš„ç³»ç»Ÿæ”¯æŒè¿™æ ·çš„äº¤äº’ï¼š<p><strong>ç”¨æˆ·æŸ¥è¯¢</strong>ï¼š<code>"æ¨è3å¥—é€‚åˆçº¦ä¼šçš„ä¼˜é›…ç©¿æ­"</code><p><strong>ç³»ç»Ÿå“åº”</strong>ï¼š<pre class=language-json data-lang=json style=background:#2b303b;color:#c0c5ce><code class=language-json data-lang=json><span>{
</span><span>  "</span><span style=color:#a3be8c>mode</span><span>": "</span><span style=color:#a3be8c>full_outfit</span><span>",
</span><span>  "</span><span style=color:#a3be8c>num_outfits</span><span>": </span><span style=color:#d08770>3</span><span>,
</span><span>  "</span><span style=color:#a3be8c>outfits</span><span>": [
</span><span>    {
</span><span>      "</span><span style=color:#a3be8c>type</span><span>": "</span><span style=color:#a3be8c>dress</span><span>",
</span><span>      "</span><span style=color:#a3be8c>dress</span><span>": {
</span><span>        "</span><span style=color:#a3be8c>garment_id</span><span>": "</span><span style=color:#a3be8c>033207</span><span>",
</span><span>        "</span><span style=color:#a3be8c>description</span><span>": "</span><span style=color:#a3be8c>Elegant midi dress with subtle texture</span><span>",
</span><span>        "</span><span style=color:#a3be8c>image_url</span><span>": "</span><span style=color:#a3be8c>https://stylist.polly.wang/images/dresses/images/033207_1.jpg</span><span>"
</span><span>      },
</span><span>      "</span><span style=color:#a3be8c>score</span><span>": </span><span style=color:#d08770>9.2</span><span>,
</span><span>      "</span><span style=color:#a3be8c>reason</span><span>": "</span><span style=color:#a3be8c>ç»å…¸çš„ä¸­é•¿è¿è¡£è£™ï¼Œå®Œç¾é€‚åˆçº¦ä¼šåœºåˆ...</span><span>"
</span><span>    }
</span><span>  ],
</span><span>  "</span><span style=color:#a3be8c>stylist_advice</span><span>": "</span><span style=color:#a3be8c>è¿™äº›ç©¿æ­éƒ½éå¸¸é€‚åˆçº¦ä¼šåœºåˆã€‚è¿è¡£è£™å±•ç°ä¼˜é›…æ°”è´¨ï¼Œè€Œä¸Šè¡£+è£™å­çš„ç»„åˆåˆ™æ›´åŠ çµæ´»å¤šå˜...</span><span>"
</span><span>}
</span></code></pre><h2 id=zong-jie-yu-fan-si>æ€»ç»“ä¸åæ€</h2><h3 id=ji-zhu-shou-huo>æŠ€æœ¯æ”¶è·</h3><ol><li><strong>MCPåè®®çš„å®è·µ</strong>ï¼šä»stdioåˆ°SSEå†åˆ°Streamable HTTPï¼Œæ·±å…¥ç†è§£äº†MCPçš„è®¾è®¡å“²å­¦å’Œæ¼”è¿›æ–¹å‘<li><strong>è·¨æ¨¡å‹å…¼å®¹æ€§</strong>ï¼šä¸åŒLLMå¯¹promptçš„ç†è§£å·®å¼‚ï¼Œéœ€è¦é’ˆå¯¹æ€§ä¼˜åŒ–<li><strong>å‘é‡æ£€ç´¢+LLMæ¨ç†</strong>ï¼šæ··åˆæ¶æ„åœ¨æ—¶å°šæ¨èåœºæ™¯çš„æœ‰æ•ˆåº”ç”¨<li><strong>ç”Ÿäº§çº§éƒ¨ç½²</strong>ï¼šNginxåå‘ä»£ç†ã€SSLè¯ä¹¦ã€APIè®¤è¯çš„å®Œæ•´å®è·µ<li><strong>MCP + Skill åä½œ</strong>ï¼šæ•°æ®å±‚ä¸å±•ç¤ºå±‚åˆ†ç¦»ï¼ŒMCP è´Ÿè´£èƒ½åŠ›ï¼ŒSkill è´Ÿè´£ä½“éªŒ</ol><h3 id=wei-lai-gai-jin-fang-xiang>æœªæ¥æ”¹è¿›æ–¹å‘</h3><ul><li><strong>å¤šæ¨¡æ€è¾“å…¥</strong>ï¼šæ”¯æŒç”¨æˆ·ä¸Šä¼ å›¾ç‰‡ï¼Œå®ç°"æ‰¾ç›¸ä¼¼"åŠŸèƒ½<li><strong>ç”¨æˆ·ç”»åƒ</strong>ï¼šè®°ä½ç”¨æˆ·åå¥½ï¼Œæä¾›ä¸ªæ€§åŒ–æ¨è<li><strong>å®æ—¶åº“å­˜</strong>ï¼šå¯¹æ¥ç”µå•†å¹³å°ï¼Œæ˜¾ç¤ºå¯è´­ä¹°çŠ¶æ€<li><strong>æ›´å¤š Skill</strong>ï¼šå¼€å‘ PPT ç”Ÿæˆã€ç¤¾äº¤åˆ†äº«ç­‰é…å¥— Skill</ul><h3 id=xiang-mu-di-zhi>é¡¹ç›®åœ°å€</h3><p>GitHub: <a href=https://github.com/Polly2014/Stylist-MCP-Server>Polly2014/Stylist-MCP-Server</a><p>å¦‚æœä½ å¯¹MCP Serverå¼€å‘æˆ–AIæ—¶å°šåº”ç”¨æ„Ÿå…´è¶£ï¼Œæ¬¢è¿Starå’Œäº¤æµï¼<hr><p><em>å†™ä½œè¿™ç¯‡åšæ–‡çš„è¿‡ç¨‹ï¼Œä¹Ÿæ˜¯å¯¹æ•´ä¸ªé¡¹ç›®çš„ä¸€æ¬¡å¤ç›˜ã€‚ä»æœ€åˆçš„æƒ³æ³•åˆ°ç”Ÿäº§å¯ç”¨ï¼Œæ¶‰åŠçš„æŠ€æœ¯ç‚¹è¿œæ¯”é¢„æƒ³çš„è¦å¤šã€‚ä½†æ­£æ˜¯è¿™äº›ç»†èŠ‚çš„æ‰“ç£¨ï¼Œæ‰è®©æœ€ç»ˆçš„äº§å“æ—¢ç¨³å®šåˆä¼˜é›…ã€‚</em></div><div class=navigation></div></div><div id=giscus-container><h2>Comments</h2><div class=giscus></div></div><script data-category="Blog Comments" async crossorigin data-category-id=DIC_kwDOL45duM4CnjlZ data-emit-metadata=0 data-input-position=bottom data-lang=en data-mapping=pathname data-reactions-enabled=1 data-repo=Polly2014/polly2014.github.io data-repo-id=R_kgDOL45duA data-strict=0 data-theme=noborder_light src=https://giscus.app/client.js></script><script type=module>
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        
        mermaid.initialize({
            startOnLoad: false,
            theme: 'base',
            themeVariables: {
                // ç°ç™½é»‘è‰²è°ƒ + è“è‰²ç‚¹ç¼€
                primaryColor: '#e8e8e8',
                primaryTextColor: '#333',
                primaryBorderColor: '#999',
                lineColor: 'rgb(61, 146, 201)',
                secondaryColor: '#f5f5f5',
                tertiaryColor: '#fafafa',
                background: '#f2f2f2',
                mainBkg: '#f5f5f5',
                nodeBorder: '#999',
                clusterBkg: '#eee',
                clusterBorder: '#ccc',
                titleColor: '#333',
                edgeLabelBackground: '#f2f2f2',
                // æ–‡æœ¬é¢œè‰²
                textColor: '#333',
                nodeTextColor: '#333',
                // å…¶ä»–
                fontFamily: "'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace"
            },
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true,
                curve: 'basis'
            }
        });

        // æŸ¥æ‰¾æ‰€æœ‰ mermaid ä»£ç å—å¹¶æ¸²æŸ“
        document.querySelectorAll('pre code.language-mermaid').forEach((block, index) => {
            const container = document.createElement('div');
            container.className = 'mermaid';
            container.textContent = block.textContent;
            block.parentNode.replaceWith(container);
        });

        // æ¸²æŸ“æ‰€æœ‰ mermaid å›¾è¡¨
        await mermaid.run();
    </script><style>.cover-image{text-align:center;margin:1.5em 0 2em 0}.cover-image img{width:60%;height:auto;border-radius:8px;box-shadow:0 4px 12px rgba(0,0,0,0.15)}.mermaid{background:#fafafa;border:1px solid #ddd;padding:20px;margin:20px 0;overflow-x:auto}.mermaid svg{max-width:100%;height:auto}@media (max-width:768px){.cover-image img{width:100%}}</style></div></div><script>document.addEventListener('DOMContentLoaded',function(){const c=document.querySelector('.menu-toggle');const d=document.querySelector('.sidebar');const e=document.querySelector('.overlay');function a(){d.classList.toggle('active');e.classList.toggle('active')}c.addEventListener('click',a);e.addEventListener('click',a);let f=0;let g=0;document.addEventListener('touchstart',h=>{f=h.changedTouches[0].screenX},false);document.addEventListener('touchend',h=>{g=h.changedTouches[0].screenX;b()},false);function b(){const h=g- f;if(h>50&&f<30){d.classList.add('active');e.classList.add('active')}else if(h<-50&&d.classList.contains('active')){d.classList.remove('active');e.classList.remove('active')}}})</script>