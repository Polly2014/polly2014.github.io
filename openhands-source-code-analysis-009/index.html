<!doctype html><html><head><title>OpenHands 源码解析系列（九）：从源码到实践</title><meta content="从源码到实践，帮助开发者快速上手 OpenHands 的开发与部署。" name=description><meta content="Polly, Blog, AI Blog, AI Assistant, Tutorials, Technology Blog, Baoli Wang" name=keywords><meta content="width=device-width,initial-scale=1" name=viewport><meta content="text/html; charset=utf-8" http-equiv=content-type><meta content=#333 name=theme-color><meta content=article property=og:type><meta content=https://polly.wang/openhands-source-code-analysis-009/ property=og:url><meta content="OpenHands 源码解析系列（九）：从源码到实践" property=og:title><meta content="从源码到实践，帮助开发者快速上手 OpenHands 的开发与部署。" property=og:description><meta content=https://polly.wang/images/polly.png property=og:image><meta content="Polly Blog" property=og:site_name><meta content=zh_CN property=og:locale><meta content=summary_large_image name=twitter:card><meta content=https://polly.wang/openhands-source-code-analysis-009/ name=twitter:url><meta content="OpenHands 源码解析系列（九）：从源码到实践" name=twitter:title><meta content="从源码到实践，帮助开发者快速上手 OpenHands 的开发与部署。" name=twitter:description><meta content=https://polly.wang/images/polly.png name=twitter:image><meta content=2025-02-24T00:00:00 property=article:published_time><meta content=Polly property=article:author><meta content=OpenHands property=article:tag><meta content=源码解析 property=article:tag><meta content=开发 property=article:tag><meta content=部署 property=article:tag><link rel="shortcut icon" href=https://polly.wang/images/polly.ico type=image/x-icon><link href=https://polly.wang/images/polly.ico rel=icon type=image/x-icon><link href=https://polly.wang/images/polly.ico rel=apple-touch-icon><link href=https://polly.wang/vendor/purecss/pure-min.css rel=stylesheet><link href=https://polly.wang/vendor/purecss/grids-responsive-min.css rel=stylesheet><link href=https://polly.wang/vendor/font-awesome/css/all.min.css rel=stylesheet><link href=https://polly.wang/css/style_new.css rel=stylesheet><script src="https://www.googletagmanager.com/gtag/js?id=G-8JD13N7PHS" async></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date());gtag('config','G-8JD13N7PHS')</script><body><div class=menu-toggle><img alt=Menu src=https://polly.wang/images/polly.png></div><div class=overlay></div><div class="pure-g container"><div class="sidebar pure-u-1 pure-u-md-1-5"><div class=title><a class=pure-menu-heading href=https://polly.wang> <img class="avatar pure-img-responsive" src=https://polly.wang/images/polly.png> </a><div class=introduction><p>Polly's Blog</div><div class=nav><ul class=nav-links><li><a href=https://polly.wang><i class="fas fa-home"></i>Home</a><li><a href=https://polly.wang/archive><i class="fas fa-archive"></i>Archive</a><li><a href=https://polly.wang/category><i class="fas fa-folder"></i>Category</a><li><a href=https://polly.wang/blog><i class="fas fa-file-alt"></i>Posts</a><li><a href=https://polly.wang/cfp><i class="fas fa-calendar-alt"></i>CFP</a><li><a href=https://polly.wang/publication><i class="fas fa-file-pdf"></i>Research</a><li><a href=https://polly.wang/changelog><i class="fas fa-history"></i>Change Log</a><li><a href=https://polly.wang/about><i class="fas fa-info-circle"></i>About Me</a></ul></div><div class=social><ul class=social-links><li><a href=mailto:26716201@qq.com><i class="fas fa-envelope"></i></a><li><a href=https://twitter.com/Polly__007><i class="fab fa-twitter"></i></a><li><a href=https://www.linkedin.com/in/baoliwang><i class="fab fa-linkedin-in"></i></a><li><a href=https://github.com/Polly2014><i class="fab fa-github"></i></a></ul></div></div></div><div class="content pure-u-1 pure-u-md-4-5"><div class=blog-post><h1>OpenHands 源码解析系列（九）：从源码到实践</h1><div class=content><p>在 OpenHands 的开发与部署过程中，理解源码结构和实践流程是关键。本文将从源码到实践，帮助开发者快速上手 OpenHands 的开发与部署。<hr><h2 id=yuan-ma-jie-gou-hui-gu>源码结构回顾</h2><p>在前几篇文章中，我们已经详细解析了 OpenHands 的源码结构。以下是对关键模块的快速回顾：<ol><li><p><strong>后端模块</strong>：</p> <ul><li><strong>Controller</strong>：解析用户意图并分配代理。<li><strong>AgentHub</strong>：管理不同类型的代理。<li><strong>LLM</strong>：与大语言模型交互。<li><strong>Events</strong>：处理事件流。<li><strong>Storage</strong>：管理数据存储。</ul><li><p><strong>前端模块</strong>：</p> <ul><li>使用 React 构建用户界面。<li>提供与后端交互的 API 模块。</ul><li><p><strong>配置与安全</strong>：</p> <ul><li><strong>Config</strong>：管理系统配置。<li><strong>Security</strong>：提供安全分析和运行时检查。</ul></ol><hr><h2 id=kai-fa-huan-jing-da-jian>开发环境搭建</h2><p>在开始开发之前，需要搭建 OpenHands 的开发环境。以下是详细步骤：<ol><li><p><strong>克隆代码仓库</strong>：</p> <pre class=language-bash data-lang=bash style=background:#2b303b;color:#c0c5ce><code class=language-bash data-lang=bash><span style=color:#bf616a>git</span><span> clone https://github.com/openhands/openhands.git
</span><span style=color:#96b5b4>cd</span><span> openhands
</span></code></pre><li><p><strong>安装依赖</strong>：</p> <ul><li><strong>后端依赖</strong>：<pre class=language-bash data-lang=bash style=background:#2b303b;color:#c0c5ce><code class=language-bash data-lang=bash><span style=color:#bf616a>poetry</span><span> install
</span></code></pre><li><strong>前端依赖</strong>：<pre class=language-bash data-lang=bash style=background:#2b303b;color:#c0c5ce><code class=language-bash data-lang=bash><span style=color:#96b5b4>cd</span><span> frontend
</span><span style=color:#bf616a>npm</span><span> install
</span></code></pre></ul><li><p><strong>配置环境变量</strong>：</p> <ul><li>创建 <code>.env</code> 文件，添加必要的环境变量：<pre class=language-env data-lang=env style=background:#2b303b;color:#c0c5ce><code class=language-env data-lang=env><span>GPT_API_KEY=your-api-key
</span><span>DATABASE_URL=sqlite:///openhands.db
</span></code></pre></ul><li><p><strong>启动服务</strong>：</p> <ul><li>启动后端服务：<pre class=language-bash data-lang=bash style=background:#2b303b;color:#c0c5ce><code class=language-bash data-lang=bash><span style=color:#bf616a>poetry</span><span> run python openhands/server/app.py
</span></code></pre><li>启动前端服务：<pre class=language-bash data-lang=bash style=background:#2b303b;color:#c0c5ce><code class=language-bash data-lang=bash><span style=color:#96b5b4>cd</span><span> frontend
</span><span style=color:#bf616a>npm</span><span> run dev
</span></code></pre></ul></ol><hr><h2 id=bu-shu-zhi-nan>部署指南</h2><p>以下是 OpenHands 的部署流程，适用于生产环境：<ol><li><p><strong>准备服务器</strong>：</p> <ul><li>选择云服务提供商（如 AWS、Azure）。<li>创建虚拟机，安装必要的软件（如 Docker、Docker Compose）。</ul><li><p><strong>配置生产环境</strong>：</p> <ul><li>创建生产环境的配置文件（如 <code>.env.production</code>）。<li>配置反向代理（如 Nginx）以处理 HTTPS 和负载均衡。</ul><li><p><strong>使用 Docker 部署</strong>：</p> <ul><li>构建 Docker 镜像：<pre class=language-bash data-lang=bash style=background:#2b303b;color:#c0c5ce><code class=language-bash data-lang=bash><span style=color:#bf616a>docker</span><span> build</span><span style=color:#bf616a> -t</span><span> openhands .
</span></code></pre><li>启动容器：<pre class=language-bash data-lang=bash style=background:#2b303b;color:#c0c5ce><code class=language-bash data-lang=bash><span style=color:#bf616a>docker-compose</span><span> up</span><span style=color:#bf616a> -d
</span></code></pre></ul><li><p><strong>监控与日志</strong>：</p> <ul><li>配置日志系统（如 ELK Stack）。<li>使用监控工具（如 Prometheus、Grafana）监控系统运行状态。</ul></ol><hr><h2 id=kai-fa-yu-diao-shi-ji-qiao>开发与调试技巧</h2><ol><li><p><strong>代码调试</strong>：</p> <ul><li>使用 VSCode 或 PyCharm 设置断点调试。<li>在前端使用浏览器开发者工具调试组件和网络请求。</ul><li><p><strong>测试驱动开发</strong>：</p> <ul><li>编写单元测试：<pre class=language-bash data-lang=bash style=background:#2b303b;color:#c0c5ce><code class=language-bash data-lang=bash><span style=color:#bf616a>poetry</span><span> run pytest tests/unit
</span></code></pre><li>编写端到端测试：<pre class=language-bash data-lang=bash style=background:#2b303b;color:#c0c5ce><code class=language-bash data-lang=bash><span style=color:#96b5b4>cd</span><span> frontend
</span><span style=color:#bf616a>npm</span><span> run test
</span></code></pre></ul><li><p><strong>性能优化</strong>：</p> <ul><li>使用 <code>cProfile</code> 分析后端性能瓶颈。<li>在前端使用 Lighthouse 工具优化页面加载速度。</ul></ol><hr><h2 id=shi-jian-an-li>实践案例</h2><p>以下是一个完整的实践案例，展示了如何使用 OpenHands 完成一个任务：<ol><li><p><strong>任务描述</strong>：</p> <ul><li>用户希望生成一段 Python 代码，实现文件的批量重命名。</ul><li><p><strong>操作流程</strong>：</p> <ul><li>用户在前端输入任务描述。<li>后端解析用户意图，分配 <code>CodeActAgent</code>。<li><code>CodeActAgent</code> 调用 LLM 模块生成代码。<li>前端显示生成的代码，并提供下载选项。</ul><li><p><strong>结果展示</strong>：</p> <ul><li>用户获得一段高质量的 Python 代码，满足其需求。</ul></ol><hr><p>通过以上分析，我们可以看到 OpenHands 的开发与部署流程清晰且易于实践。在下一篇文章中，我们将总结整个系列的内容，并展望 OpenHands 的未来发展方向。</div><div class=navigation></div></div><div id=giscus-container><h2>Comments</h2><div class=giscus></div></div><script data-category="Blog Comments" async crossorigin data-category-id=DIC_kwDOL45duM4CnjlZ data-emit-metadata=0 data-input-position=bottom data-lang=en data-mapping=pathname data-reactions-enabled=1 data-repo=Polly2014/polly2014.github.io data-repo-id=R_kgDOL45duA data-strict=0 data-theme=noborder_light src=https://giscus.app/client.js></script><script type=module>
        import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
        
        mermaid.initialize({
            startOnLoad: false,
            theme: 'base',
            themeVariables: {
                // 灰白黑色调 + 蓝色点缀
                primaryColor: '#e8e8e8',
                primaryTextColor: '#333',
                primaryBorderColor: '#999',
                lineColor: 'rgb(61, 146, 201)',
                secondaryColor: '#f5f5f5',
                tertiaryColor: '#fafafa',
                background: '#f2f2f2',
                mainBkg: '#f5f5f5',
                nodeBorder: '#999',
                clusterBkg: '#eee',
                clusterBorder: '#ccc',
                titleColor: '#333',
                edgeLabelBackground: '#f2f2f2',
                // 文本颜色
                textColor: '#333',
                nodeTextColor: '#333',
                // 其他
                fontFamily: "'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace"
            },
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true,
                curve: 'basis'
            }
        });

        // 查找所有 mermaid 代码块并渲染
        document.querySelectorAll('pre code.language-mermaid').forEach((block, index) => {
            const container = document.createElement('div');
            container.className = 'mermaid';
            container.textContent = block.textContent;
            block.parentNode.replaceWith(container);
        });

        // 渲染所有 mermaid 图表
        await mermaid.run();
    </script><style>.cover-image{text-align:center;margin:1.5em 0 2em 0}.cover-image img{width:60%;height:auto;border-radius:8px;box-shadow:0 4px 12px rgba(0,0,0,0.15)}.mermaid{background:#fafafa;border:1px solid #ddd;padding:20px;margin:20px 0;overflow-x:auto}.mermaid svg{max-width:100%;height:auto}@media (max-width:768px){.cover-image img{width:100%}}</style></div></div><script>document.addEventListener('DOMContentLoaded',function(){const c=document.querySelector('.menu-toggle');const d=document.querySelector('.sidebar');const e=document.querySelector('.overlay');function a(){d.classList.toggle('active');e.classList.toggle('active')}c.addEventListener('click',a);e.addEventListener('click',a);let f=0;let g=0;document.addEventListener('touchstart',h=>{f=h.changedTouches[0].screenX},false);document.addEventListener('touchend',h=>{g=h.changedTouches[0].screenX;b()},false);function b(){const h=g- f;if(h>50&&f<30){d.classList.add('active');e.classList.add('active')}else if(h<-50&&d.classList.contains('active')){d.classList.remove('active');e.classList.remove('active')}}})</script>